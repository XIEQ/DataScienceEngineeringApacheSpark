<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>CS110x_lab2_alternating_least_square(ALS)_predicting_movie_ratings_df - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html","displayName":"Databricks Guide","icon":"question"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/sample_applications/index.html","displayName":"Application Examples","icon":"code"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/courses/index.html","displayName":"Training","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","maxCustomTags":5,"enableInstanceProfilesUIInJobs":false,"nodeInfo":{"node_types":[{"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"memory_mb":6144,"category":"Community Edition","num_cores":0.88,"support_ebs_volumes":false}],"default_node_type_id":"dev-tier-node"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"enableTableHandler":true,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":false,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"clusters":true,"allowRunOnPendingClusters":true,"applications":false,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-35f30dcf90b59210c3f253a98dbb4d255fa4a1773385163b3cec143c1271e065","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-876320751f9b6e4318a1235c9d5f862196d02008ff478f483e2820c48c59d1fe","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"class-node":1,"r3.8xlarge":8,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":8,"memory-optimized":1,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"c3.4xlarge":2,"g2.2xlarge":2,"c4.8xlarge":4,"r3.xlarge":1,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":false,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.30","accountsLimit":3,"enableX509Authentication":false,"enableNotebookGitBranching":true,"local":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"disableLegacyDashboards":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"defaultSparkVersion":{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":true,"enableMountAclsConfig":false,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableClusterAclsByTier":false,"disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"useFixedStaticNotebookVersionForDevelopment":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAclService":true,"docsDomain":"https://docs.cloud.databricks.com/","enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"cf91ba6cb552f29d2f374bda4b46622075c9146a-dirty","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"showDevTierBetaVersion":true,"enableDebugUI":false,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSparkPackages":true,"dynamicSparkVersions":true,"enableNotebookHistoryUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/A%20Gentle%20Introduction%20to%20Apache%20Spark%20on%20Databricks.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/Quick%20Start%20DataFrames.html","displayName":"Quick Start DataFrames","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/GSW%20Passing%20Analysis%20(new).html","displayName":"GSW Passing Analysis (new)","icon":"img/home/Python_icon.svg"}],"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"enableTerminal":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"accounts":true,"useFramedStaticNotebooks":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showSqlProxyUI":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":36148146263635,"name":"CS110x_lab2_alternating_least_square(ALS)_predicting_movie_ratings_df","language":"python","commands":[{"version":"CommandV1","origId":36148146263637,"guid":"5d51a6a0-a81c-4d14-a87d-b141a5f11d36","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n<a rel=\"license\" href=\"http://creativecommons.org/licenses/by-nc-nd/4.0/\"> <img alt=\"Creative Commons License\" style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png\"/> </a> <br/> This work is licensed under a <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-nc-nd/4.0/\"> Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. </a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120737763E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"92759a33-c05a-4f2e-9669-c7a354668a70"},{"version":"CommandV1","origId":36148146263638,"guid":"2233915b-1e73-4a6a-b1eb-89f92fc4b58e","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n#![Spark Logo](http://spark-mooc.github.io/web-assets/images/ta_Spark-logo-small.png) + ![Python Logo](http://spark-mooc.github.io/web-assets/images/python-logo-master-v3-TM-flattened_small.png)\n\n<img src=\"http://spark-mooc.github.io/web-assets/images/cs110x/movie-camera.png\" style=\"float:right; height: 200px; margin: 10px; border: 1px solid #ddd; border-radius: 15px 15px 15px 15px; padding: 10px\"/>\n\n# Predicting Movie Ratings\n\nOne of the most common uses of big data is to predict what users want.  This allows Google to show you relevant ads, Amazon to recommend relevant products, and Netflix to recommend movies that you might like.  This lab will demonstrate how we can use Apache Spark to recommend movies to a user.  We will start with some basic techniques, and then use the [Spark ML][sparkml] library's Alternating Least Squares method to make more sophisticated predictions.\n\nFor this lab, we will use a subset dataset of 20 million ratings. This dataset is pre-mounted on Databricks and is from the [MovieLens stable benchmark rating dataset](http://grouplens.org/datasets/movielens/). However, the same code you write will also work on the full dataset (though running with the full dataset on Community Edition is likely to take quite a long time).\n\nIn this lab:\n* *Part 0*: Preliminaries\n* *Part 1*: Basic Recommendations\n* *Part 2*: Collaborative Filtering\n* *Part 3*: Predictions for Yourself\n\nAs mentioned during the first Learning Spark lab, think carefully before calling `collect()` on any datasets.  When you are using a small dataset, calling `collect()` and then using Python to get a sense for the data locally (in the driver program) will work fine, but this will not work when you are using a large dataset that doesn't fit in memory on one machine.  Solutions that call `collect()` and do local analysis that could have been done with Spark will likely fail in the autograder and not receive full credit.\n[sparkml]: https://spark.apache.org/docs/1.6.2/api/python/pyspark.ml.html","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120737783E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fee1730f-21bc-4e98-a158-3c0b18e09f26"},{"version":"CommandV1","origId":36148146263640,"guid":"d52ab4ad-585b-4ec6-b078-4ee1538eaf2d","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n## Code\n\nThis assignment can be completed using basic Python and pySpark DataFrame Transformations and Actions.  Libraries other than math are not necessary. With the exception of the ML functions that we introduce in this assignment, you should be able to complete all parts of this homework using only the Spark functions you have used in prior lab exercises (although you are welcome to use more features of Spark if you like!).\n\nWe'll be using motion picture data, the same data last year's CS100.1x used. However, in this course, we're using DataFrames, rather than RDDs.\n\nThe following cell defines the locations of the data files. If you want to run an exported version of this lab on your own machine (i.e., outside of Databricks), you'll need to download your own copy of the 20-million movie data set, and you'll need to adjust the paths, below.\n\n**To Do**: Run the following cell.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120737822E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f5c84182-a144-47d0-a077-fef235e1f399"},{"version":"CommandV1","origId":36148146263641,"guid":"a264d25f-e606-443d-b750-0c31874eff8e","subtype":"command","commandType":"auto","position":5.0,"command":"import os\nfrom databricks_test_helper import Test\n\ndbfs_dir = '/databricks-datasets/cs110x/ml-20m/data-001'\nratings_filename = dbfs_dir + '/ratings.csv'\nmovies_filename = dbfs_dir + '/movies.csv'\n\n# The following line is here to enable this notebook to be exported as source and\n# run on a local machine with a local copy of the files. Just change the dbfs_dir,\n# above.\nif os.path.sep != '/':\n  # Handle Windows.\n  ratings_filename = ratings_filename.replace('/', os.path.sep)\n  movie_filename = movie_filename.replace('/', os.path.sep)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.473120747465E12,"submitTime":1.473120737847E12,"finishTime":1.473120747545E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0f244a1f-66ff-4f61-8bc9-9f2867367b68"},{"version":"CommandV1","origId":36148146263642,"guid":"4db0d7d0-f20b-4a81-9847-022a646be620","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n## Part 0: Preliminaries\n\nWe read in each of the files and create a DataFrame consisting of parsed lines.\n\n### The 20-million movie sample\n\nThe 20-million movie sample consists of CSV files (with headers), so there's no need to parse the files manually, as Spark CSV can do the job.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120737864E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"73170783-8e36-42be-b690-47e981f8b6e4"},{"version":"CommandV1","origId":36148146263643,"guid":"10636de4-68e5-42cf-ae73-9a5feb4a5651","subtype":"command","commandType":"auto","position":7.0,"command":"%md\nFirst, let's take a look at the directory containing our files.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120737891E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c876fb55-f2d0-46e4-a245-d402addb0e4c"},{"version":"CommandV1","origId":36148146263644,"guid":"38f33761-2ab3-4b01-a659-4060c6659bf0","subtype":"command","commandType":"auto","position":8.0,"command":"display(dbutils.fs.ls(dbfs_dir))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/databricks-datasets/cs110x/ml-20m/data-001/README.txt","README.txt",8964.0],["dbfs:/databricks-datasets/cs110x/ml-20m/data-001/links.csv","links.csv",569517.0],["dbfs:/databricks-datasets/cs110x/ml-20m/data-001/links.csv.gz","links.csv.gz",245973.0],["dbfs:/databricks-datasets/cs110x/ml-20m/data-001/movies.csv","movies.csv",1397542.0],["dbfs:/databricks-datasets/cs110x/ml-20m/data-001/movies.csv.gz","movies.csv.gz",498839.0],["dbfs:/databricks-datasets/cs110x/ml-20m/data-001/ratings.csv","ratings.csv",5.33444411E8],["dbfs:/databricks-datasets/cs110x/ml-20m/data-001/ratings.csv.gz","ratings.csv.gz",1.32656084E8],["dbfs:/databricks-datasets/cs110x/ml-20m/data-001/tags.csv","tags.csv",1.6603996E7],["dbfs:/databricks-datasets/cs110x/ml-20m/data-001/tags.csv.gz","tags.csv.gz",4787917.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\""},{"name":"name","type":"\"string\""},{"name":"size","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.473120747574E12,"submitTime":1.473120738006E12,"finishTime":1.473120750903E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"69207508-76c8-4c34-83b4-c4c4eacb9264"},{"version":"CommandV1","origId":36148146263645,"guid":"dbfaf86b-e489-451f-a115-39c154d1532d","subtype":"command","commandType":"auto","position":9.0,"command":"%md\n### CPU vs I/O tradeoff\n\nNote that we have both compressed files (ending in `.gz`) and uncompressed files. We have a CPU vs. I/O tradeoff here. If I/O is the bottleneck, then we want to process the compressed files and pay the extra CPU overhead. If CPU is the bottleneck, then it makes more sense to process the uncompressed files.\n\nWe've done some experiments, and we've determined that CPU is more of a bottleneck than I/O, on Community Edition. So, we're going to process the uncompressed data. In addition, we're going to speed things up further by specifying the DataFrame schema explicitly. (When the Spark CSV adapter infers the schema from a CSV file, it has to make an extra pass over the file. That'll slow things down here, and it isn't really necessary.)\n\n**To Do**: Run the following cell, which will define the schemas.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738176E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a29b7235-52e1-455e-ace4-f71861b1d8fb"},{"version":"CommandV1","origId":36148146263646,"guid":"e16ef1cc-f9e0-450d-ba77-1aa4d2ae9201","subtype":"command","commandType":"auto","position":10.0,"command":"from pyspark.sql.types import *\n\nratings_df_schema = StructType(\n  [StructField('userId', IntegerType()),\n   StructField('movieId', IntegerType()),\n   StructField('rating', DoubleType())]\n)\nmovies_df_schema = StructType(\n  [StructField('ID', IntegerType()),\n   StructField('title', StringType())]\n)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.473120751057E12,"submitTime":1.4731207382E12,"finishTime":1.473120751137E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f4c8e3a1-26f3-4779-9a8b-5067be614a4e"},{"version":"CommandV1","origId":36148146263647,"guid":"80a7ca10-6686-4858-9a8c-ab8479308075","subtype":"command","commandType":"auto","position":11.0,"command":"%md\n### Load and Cache\n\nThe Databricks File System (DBFS) sits on top of S3. We're going to be accessing this data a lot. Rather than read it over and over again from S3, we'll cache both\nthe movies DataFrame and the ratings DataFrame in memory.\n\n**To Do**: Run the following cell to load and cache the data. Please be patient: The code takes about 30 seconds to run.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738218E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c8428ac0-b22e-4978-b4c3-e1fd26c95b45"},{"version":"CommandV1","origId":36148146263648,"guid":"8961f513-6ca5-470d-ba69-d0ba885e41c6","subtype":"command","commandType":"auto","position":12.0,"command":"from pyspark.sql.functions import regexp_extract\nfrom pyspark.sql.types import *\n\nraw_ratings_df = (sqlContext.read\n                  .format('com.databricks.spark.csv')\n                  .options(header=True, inferSchema=False)\n                  .schema(ratings_df_schema)\n                  .load(ratings_filename))\nratings_df = raw_ratings_df.drop('Timestamp')\n\nraw_movies_df = (sqlContext.read\n                 .format('com.databricks.spark.csv')\n                 .options(header=True, inferSchema=False)\n                 .schema(movies_df_schema)\n                 .load(movies_filename))\nmovies_df = raw_movies_df.drop('Genres').withColumnRenamed('movieId', 'ID')\n\nratings_df.cache()\nmovies_df.cache()\n\nassert ratings_df.is_cached\nassert movies_df.is_cached\n\nraw_ratings_count = raw_ratings_df.count()\nratings_count = ratings_df.count()\nraw_movies_count = raw_movies_df.count()\nmovies_count = movies_df.count()\n\nprint 'There are %s ratings and %s movies in the datasets' % (ratings_count, movies_count)\nprint 'Ratings:'\nratings_df.show(3)\nprint 'Movies:'\nmovies_df.show(3, truncate=False)\n\nassert raw_ratings_count == ratings_count\nassert raw_movies_count == movies_count","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">There are 20000263 ratings and 27278 movies in the datasets\nRatings:\n+------+-------+------+\n|userId|movieId|rating|\n+------+-------+------+\n|     1|      2|   3.5|\n|     1|     29|   3.5|\n|     1|     32|   3.5|\n+------+-------+------+\nonly showing top 3 rows\n\nMovies:\n+---+-----------------------+\n|ID |title                  |\n+---+-----------------------+\n|1  |Toy Story (1995)       |\n|2  |Jumanji (1995)         |\n|3  |Grumpier Old Men (1995)|\n+---+-----------------------+\nonly showing top 3 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.473120751148E12,"submitTime":1.473120738247E12,"finishTime":1.47312079057E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dd1c9911-d4bc-4ef9-8e95-38e42189a2b5"},{"version":"CommandV1","origId":36148146263649,"guid":"99d2d88b-5100-46cc-8210-bb64a85c9448","subtype":"command","commandType":"auto","position":13.0,"command":"%md\nNext, let's do a quick verification of the data.\n\n**To do**: Run the following cell. It should run without errors.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738264E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7c79b0a0-185e-483b-95ea-b13c856cce9e"},{"version":"CommandV1","origId":36148146263650,"guid":"5a37e9e4-4da3-4f4d-8bad-4ff1041a19dd","subtype":"command","commandType":"auto","position":14.0,"command":"assert ratings_count == 20000263\nassert movies_count == 27278\nassert movies_df.filter(movies_df.title == 'Toy Story (1995)').count() == 1\nassert ratings_df.filter((ratings_df.userId == 6) & (ratings_df.movieId == 1) & (ratings_df.rating == 5.0)).count() == 1","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.473120790582E12,"submitTime":1.473120738291E12,"finishTime":1.473120791361E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"661a086a-3044-4075-a223-caf5c79a00c3"},{"version":"CommandV1","origId":36148146263651,"guid":"8cf2b13b-0a1a-4692-be0e-f698f9554718","subtype":"command","commandType":"auto","position":15.0,"command":"%md\nLet's take a quick look at some of the data in the two DataFrames.\n\n**To Do**: Run the following two cells.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738307E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"30703d0a-280a-4270-ba59-12ff8d6587cf"},{"version":"CommandV1","origId":36148146263652,"guid":"a6b691a0-965e-4e41-914a-761c14426f36","subtype":"command","commandType":"auto","position":16.0,"command":"display(movies_df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1.0,"Toy Story (1995)"],[2.0,"Jumanji (1995)"],[3.0,"Grumpier Old Men (1995)"],[4.0,"Waiting to Exhale (1995)"],[5.0,"Father of the Bride Part II (1995)"],[6.0,"Heat (1995)"],[7.0,"Sabrina (1995)"],[8.0,"Tom and Huck (1995)"],[9.0,"Sudden Death (1995)"],[10.0,"GoldenEye (1995)"],[11.0,"American President, The (1995)"],[12.0,"Dracula: Dead and Loving It (1995)"],[13.0,"Balto (1995)"],[14.0,"Nixon (1995)"],[15.0,"Cutthroat Island (1995)"],[16.0,"Casino (1995)"],[17.0,"Sense and Sensibility (1995)"],[18.0,"Four Rooms (1995)"],[19.0,"Ace Ventura: When Nature Calls (1995)"],[20.0,"Money Train (1995)"],[21.0,"Get Shorty (1995)"],[22.0,"Copycat (1995)"],[23.0,"Assassins (1995)"],[24.0,"Powder (1995)"],[25.0,"Leaving Las Vegas (1995)"],[26.0,"Othello (1995)"],[27.0,"Now and Then (1995)"],[28.0,"Persuasion (1995)"],[29.0,"City of Lost Children, The (Cité des enfants perdus, La) (1995)"],[30.0,"Shanghai Triad (Yao a yao yao dao waipo qiao) (1995)"],[31.0,"Dangerous Minds (1995)"],[32.0,"Twelve Monkeys (a.k.a. 12 Monkeys) (1995)"],[33.0,"Wings of Courage (1995)"],[34.0,"Babe (1995)"],[35.0,"Carrington (1995)"],[36.0,"Dead Man Walking (1995)"],[37.0,"Across the Sea of Time (1995)"],[38.0,"It Takes Two (1995)"],[39.0,"Clueless (1995)"],[40.0,"Cry, the Beloved Country (1995)"],[41.0,"Richard III (1995)"],[42.0,"Dead Presidents (1995)"],[43.0,"Restoration (1995)"],[44.0,"Mortal Kombat (1995)"],[45.0,"To Die For (1995)"],[46.0,"How to Make an American Quilt (1995)"],[47.0,"Seven (a.k.a. Se7en) (1995)"],[48.0,"Pocahontas (1995)"],[49.0,"When Night Is Falling (1995)"],[50.0,"Usual Suspects, The (1995)"],[51.0,"Guardian Angel (1994)"],[52.0,"Mighty Aphrodite (1995)"],[53.0,"Lamerica (1994)"],[54.0,"Big Green, The (1995)"],[55.0,"Georgia (1995)"],[56.0,"Kids of the Round Table (1995)"],[57.0,"Home for the Holidays (1995)"],[58.0,"Postman, The (Postino, Il) (1994)"],[59.0,"Confessional, The (Confessionnal, Le) (1995)"],[60.0,"Indian in the Cupboard, The (1995)"],[61.0,"Eye for an Eye (1996)"],[62.0,"Mr. Holland's Opus (1995)"],[63.0,"Don't Be a Menace to South Central While Drinking Your Juice in the Hood (1996)"],[64.0,"Two if by Sea (1996)"],[65.0,"Bio-Dome (1996)"],[66.0,"Lawnmower Man 2: Beyond Cyberspace (1996)"],[67.0,"Two Bits (1995)"],[68.0,"French Twist (Gazon maudit) (1995)"],[69.0,"Friday (1995)"],[70.0,"From Dusk Till Dawn (1996)"],[71.0,"Fair Game (1995)"],[72.0,"Kicking and Screaming (1995)"],[73.0,"Misérables, Les (1995)"],[74.0,"Bed of Roses (1996)"],[75.0,"Big Bully (1996)"],[76.0,"Screamers (1995)"],[77.0,"Nico Icon (1995)"],[78.0,"Crossing Guard, The (1995)"],[79.0,"Juror, The (1996)"],[80.0,"White Balloon, The (Badkonake sefid) (1995)"],[81.0,"Things to Do in Denver When You're Dead (1995)"],[82.0,"Antonia's Line (Antonia) (1995)"],[83.0,"Once Upon a Time... When We Were Colored (1995)"],[84.0,"Last Summer in the Hamptons (1995)"],[85.0,"Angels and Insects (1995)"],[86.0,"White Squall (1996)"],[87.0,"Dunston Checks In (1996)"],[88.0,"Black Sheep (1996)"],[89.0,"Nick of Time (1995)"],[90.0,"Journey of August King, The (1995)"],[92.0,"Mary Reilly (1996)"],[93.0,"Vampire in Brooklyn (1995)"],[94.0,"Beautiful Girls (1996)"],[95.0,"Broken Arrow (1996)"],[96.0,"In the Bleak Midwinter (1995)"],[97.0,"Hate (Haine, La) (1995)"],[98.0,"Shopping (1994)"],[99.0,"Heidi Fleiss: Hollywood Madam (1995)"],[100.0,"City Hall (1996)"],[101.0,"Bottle Rocket (1996)"],[102.0,"Mr. Wrong (1996)"],[103.0,"Unforgettable (1996)"],[104.0,"Happy Gilmore (1996)"],[105.0,"Bridges of Madison County, The (1995)"],[106.0,"Nobody Loves Me (Keiner liebt mich) (1994)"],[107.0,"Muppet Treasure Island (1996)"],[108.0,"Catwalk (1996)"],[109.0,"Headless Body in Topless Bar (1995)"],[110.0,"Braveheart (1995)"],[111.0,"Taxi Driver (1976)"],[112.0,"Rumble in the Bronx (Hont faan kui) (1995)"],[113.0,"Before and After (1996)"],[114.0,"Margaret's Museum (1995)"],[115.0,"Happiness Is in the Field (Bonheur est dans le pré, Le) (1995)"],[116.0,"Anne Frank Remembered (1995)"],[117.0,"Young Poisoner's Handbook, The (1995)"],[118.0,"If Lucy Fell (1996)"],[119.0,"Steal Big, Steal Little (1995)"],[120.0,"Race the Sun (1996)"],[121.0,"Boys of St. Vincent, The (1992)"],[122.0,"Boomerang (1992)"],[123.0,"Chungking Express (Chung Hing sam lam) (1994)"],[124.0,"Star Maker, The (Uomo delle stelle, L') (1995)"],[125.0,"Flirting With Disaster (1996)"],[126.0,"NeverEnding Story III, The (1994)"],[127.0,"Silences of the Palace, The (Saimt el Qusur) (1994)"],[128.0,"Jupiter's Wife (1994)"],[129.0,"Pie in the Sky (1996)"],[130.0,"Angela (1995)"],[131.0,"Frankie Starlight (1995)"],[132.0,"Jade (1995)"],[133.0,"Nueba Yol (1995)"],[134.0,"Sonic Outlaws (1995)"],[135.0,"Down Periscope (1996)"],[136.0,"From the Journals of Jean Seberg (1995)"],[137.0,"Man of the Year (1995)"],[138.0,"Neon Bible, The (1995)"],[139.0,"Target (1995)"],[140.0,"Up Close and Personal (1996)"],[141.0,"Birdcage, The (1996)"],[142.0,"Shadows (Cienie) (1988)"],[143.0,"Gospa (1995)"],[144.0,"Brothers McMullen, The (1995)"],[145.0,"Bad Boys (1995)"],[146.0,"Amazing Panda Adventure, The (1995)"],[147.0,"Basketball Diaries, The (1995)"],[148.0,"Awfully Big Adventure, An (1995)"],[149.0,"Amateur (1994)"],[150.0,"Apollo 13 (1995)"],[151.0,"Rob Roy (1995)"],[152.0,"Addiction, The (1995)"],[153.0,"Batman Forever (1995)"],[154.0,"Beauty of the Day (Belle de jour) (1967)"],[155.0,"Beyond Rangoon (1995)"],[156.0,"Blue in the Face (1995)"],[157.0,"Canadian Bacon (1995)"],[158.0,"Casper (1995)"],[159.0,"Clockers (1995)"],[160.0,"Congo (1995)"],[161.0,"Crimson Tide (1995)"],[162.0,"Crumb (1994)"],[163.0,"Desperado (1995)"],[164.0,"Devil in a Blue Dress (1995)"],[165.0,"Die Hard: With a Vengeance (1995)"],[166.0,"Doom Generation, The (1995)"],[167.0,"Feast of July (1995)"],[168.0,"First Knight (1995)"],[169.0,"Free Willy 2: The Adventure Home (1995)"],[170.0,"Hackers (1995)"],[171.0,"Jeffrey (1995)"],[172.0,"Johnny Mnemonic (1995)"],[173.0,"Judge Dredd (1995)"],[174.0,"Jury Duty (1995)"],[175.0,"Kids (1995)"],[176.0,"Living in Oblivion (1995)"],[177.0,"Lord of Illusions (1995)"],[178.0,"Love & Human Remains (1993)"],[179.0,"Mad Love (1995)"],[180.0,"Mallrats (1995)"],[181.0,"Mighty Morphin Power Rangers: The Movie (1995)"],[182.0,"Moonlight and Valentino (1995)"],[183.0,"Mute Witness (1994)"],[184.0,"Nadja (1994)"],[185.0,"Net, The (1995)"],[186.0,"Nine Months (1995)"],[187.0,"Party Girl (1995)"],[188.0,"Prophecy, The (1995)"],[189.0,"Reckless (1995)"],[190.0,"Safe (1995)"],[191.0,"Scarlet Letter, The (1995)"],[192.0,"Show, The (1995)"],[193.0,"Showgirls (1995)"],[194.0,"Smoke (1995)"],[195.0,"Something to Talk About (1995)"],[196.0,"Species (1995)"],[197.0,"Stars Fell on Henrietta, The (1995)"],[198.0,"Strange Days (1995)"],[199.0,"Umbrellas of Cherbourg, The (Parapluies de Cherbourg, Les) (1964)"],[200.0,"Tie That Binds, The (1995)"],[201.0,"Three Wishes (1995)"],[202.0,"Total Eclipse (1995)"],[203.0,"To Wong Foo, Thanks for Everything! Julie Newmar (1995)"],[204.0,"Under Siege 2: Dark Territory (1995)"],[205.0,"Unstrung Heroes (1995)"],[206.0,"Unzipped (1995)"],[207.0,"Walk in the Clouds, A (1995)"],[208.0,"Waterworld (1995)"],[209.0,"White Man's Burden (1995)"],[210.0,"Wild Bill (1995)"],[211.0,"Browning Version, The (1994)"],[212.0,"Bushwhacked (1995)"],[213.0,"Burnt by the Sun (Utomlyonnye solntsem) (1994)"],[214.0,"Before the Rain (Pred dozhdot) (1994)"],[215.0,"Before Sunrise (1995)"],[216.0,"Billy Madison (1995)"],[217.0,"Babysitter, The (1995)"],[218.0,"Boys on the Side (1995)"],[219.0,"Cure, The (1995)"],[220.0,"Castle Freak (1995)"],[222.0,"Circle of Friends (1995)"],[223.0,"Clerks (1994)"],[224.0,"Don Juan DeMarco (1995)"],[225.0,"Disclosure (1994)"],[226.0,"Dream Man (1995)"],[227.0,"Drop Zone (1994)"],[228.0,"Destiny Turns on the Radio (1995)"],[229.0,"Death and the Maiden (1994)"],[230.0,"Dolores Claiborne (1995)"],[231.0,"Dumb & Dumber (Dumb and Dumber) (1994)"],[232.0,"Eat Drink Man Woman (Yin shi nan nu) (1994)"],[233.0,"Exotica (1994)"],[234.0,"Exit to Eden (1994)"],[235.0,"Ed Wood (1994)"],[236.0,"French Kiss (1995)"],[237.0,"Forget Paris (1995)"],[238.0,"Far From Home: The Adventures of Yellow Dog (1995)"],[239.0,"Goofy Movie, A (1995)"],[240.0,"Hideaway (1995)"],[241.0,"Fluke (1995)"],[242.0,"Farinelli: il castrato (1994)"],[243.0,"Gordy (1995)"],[244.0,"Gumby: The Movie (1995)"],[245.0,"Glass Shield, The (1994)"],[246.0,"Hoop Dreams (1994)"],[247.0,"Heavenly Creatures (1994)"],[248.0,"Houseguest (1994)"],[249.0,"Immortal Beloved (1994)"],[250.0,"Heavyweights (Heavy Weights) (1995)"],[251.0,"Hunted, The (1995)"],[252.0,"I.Q. (1994)"],[253.0,"Interview with the Vampire: The Vampire Chronicles (1994)"],[254.0,"Jefferson in Paris (1995)"],[255.0,"Jerky Boys, The (1995)"],[256.0,"Junior (1994)"],[257.0,"Just Cause (1995)"],[258.0,"Kid in King Arthur's Court, A (1995)"],[259.0,"Kiss of Death (1995)"],[260.0,"Star Wars: Episode IV - A New Hope (1977)"],[261.0,"Little Women (1994)"],[262.0,"Little Princess, A (1995)"],[263.0,"Ladybird Ladybird (1994)"],[264.0,"Enfer, L' (1994)"],[265.0,"Like Water for Chocolate (Como agua para chocolate) (1992)"],[266.0,"Legends of the Fall (1994)"],[267.0,"Major Payne (1995)"],[268.0,"Little Odessa (1994)"],[269.0,"My Crazy Life (Mi vida loca) (1993)"],[270.0,"Love Affair (1994)"],[271.0,"Losing Isaiah (1995)"],[272.0,"Madness of King George, The (1994)"],[273.0,"Mary Shelley's Frankenstein (Frankenstein) (1994)"],[274.0,"Man of the House (1995)"],[275.0,"Mixed Nuts (1994)"],[276.0,"Milk Money (1994)"],[277.0,"Miracle on 34th Street (1994)"],[278.0,"Miami Rhapsody (1995)"],[279.0,"My Family (1995)"],[280.0,"Murder in the First (1995)"],[281.0,"Nobody's Fool (1994)"],[282.0,"Nell (1994)"],[283.0,"New Jersey Drive (1995)"],[284.0,"New York Cop (Nyû Yôku no koppu) (1993)"],[285.0,"Beyond Bedlam (1993)"],[286.0,"Nemesis 2: Nebula (1995)"],[287.0,"Nina Takes a Lover (1994)"],[288.0,"Natural Born Killers (1994)"],[289.0,"Only You (1994)"],[290.0,"Once Were Warriors (1994)"],[291.0,"Poison Ivy II (1996)"],[292.0,"Outbreak (1995)"],[293.0,"Léon: The Professional (a.k.a. The Professional) (Léon) (1994)"],[294.0,"Perez Family, The (1995)"],[295.0,"Pyromaniac's Love Story, A (1995)"],[296.0,"Pulp Fiction (1994)"],[297.0,"Panther (1995)"],[298.0,"Pushing Hands (Tui shou) (1992)"],[299.0,"Priest (1994)"],[300.0,"Quiz Show (1994)"],[301.0,"Picture Bride (Bijo photo) (1994)"],[302.0,"Queen Margot (Reine Margot, La) (1994)"],[303.0,"Quick and the Dead, The (1995)"],[304.0,"Roommates (1995)"],[305.0,"Ready to Wear (Pret-A-Porter) (1994)"],[306.0,"Three Colors: Red (Trois couleurs: Rouge) (1994)"],[307.0,"Three Colors: Blue (Trois couleurs: Bleu) (1993)"],[308.0,"Three Colors: White (Trzy kolory: Bialy) (1994)"],[309.0,"Red Firecracker, Green Firecracker (Pao Da Shuang Deng) (1994)"],[310.0,"Rent-a-Kid (1995)"],[311.0,"Relative Fear (1994)"],[312.0,"Stuart Saves His Family (1995)"],[313.0,"Swan Princess, The (1994)"],[314.0,"Secret of Roan Inish, The (1994)"],[315.0,"Specialist, The (1994)"],[316.0,"Stargate (1994)"],[317.0,"Santa Clause, The (1994)"],[318.0,"Shawshank Redemption, The (1994)"],[319.0,"Shallow Grave (1994)"],[320.0,"Suture (1993)"],[321.0,"Strawberry and Chocolate (Fresa y chocolate) (1993)"],[322.0,"Swimming with Sharks (1995)"],[324.0,"Sum of Us, The (1994)"],[325.0,"National Lampoon's Senior Trip (1995)"],[326.0,"To Live (Huozhe) (1994)"],[327.0,"Tank Girl (1995)"],[328.0,"Tales from the Crypt Presents: Demon Knight (1995)"],[329.0,"Star Trek: Generations (1994)"],[330.0,"Tales from the Hood (1995)"],[331.0,"Tom & Viv (1994)"],[332.0,"Village of the Damned (1995)"],[333.0,"Tommy Boy (1995)"],[334.0,"Vanya on 42nd Street (1994)"],[335.0,"Underneath (1995)"],[336.0,"Walking Dead, The (1995)"],[337.0,"What's Eating Gilbert Grape (1993)"],[338.0,"Virtuosity (1995)"],[339.0,"While You Were Sleeping (1995)"],[340.0,"War, The (1994)"],[341.0,"Double Happiness (1994)"],[342.0,"Muriel's Wedding (1994)"],[343.0,"Baby-Sitters Club, The (1995)"],[344.0,"Ace Ventura: Pet Detective (1994)"],[345.0,"Adventures of Priscilla, Queen of the Desert, The (1994)"],[346.0,"Backbeat (1993)"],[347.0,"Bitter Moon (1992)"],[348.0,"Bullets Over Broadway (1994)"],[349.0,"Clear and Present Danger (1994)"],[350.0,"Client, The (1994)"],[351.0,"Corrina, Corrina (1994)"],[352.0,"Crooklyn (1994)"],[353.0,"Crow, The (1994)"],[354.0,"Cobb (1994)"],[355.0,"Flintstones, The (1994)"],[356.0,"Forrest Gump (1994)"],[357.0,"Four Weddings and a Funeral (1994)"],[358.0,"Higher Learning (1995)"],[359.0,"I Like It Like That (1994)"],[360.0,"I Love Trouble (1994)"],[361.0,"It Could Happen to You (1994)"],[362.0,"Jungle Book, The (1994)"],[363.0,"Wonderful, Horrible Life of Leni Riefenstahl, The (Macht der Bilder: Leni Riefenstahl, Die) (1993)"],[364.0,"Lion King, The (1994)"],[365.0,"Little Buddha (1993)"],[366.0,"Wes Craven's New Nightmare (Nightmare on Elm Street Part 7: Freddy's Finale, A) (1994)"],[367.0,"Mask, The (1994)"],[368.0,"Maverick (1994)"],[369.0,"Mrs. Parker and the Vicious Circle (1994)"],[370.0,"Naked Gun 33 1/3: The Final Insult (1994)"],[371.0,"Paper, The (1994)"],[372.0,"Reality Bites (1994)"],[373.0,"Red Rock West (1992)"],[374.0,"Richie Rich (1994)"],[375.0,"Safe Passage (1994)"],[376.0,"River Wild, The (1994)"],[377.0,"Speed (1994)"],[378.0,"Speechless (1994)"],[379.0,"Timecop (1994)"],[380.0,"True Lies (1994)"],[381.0,"When a Man Loves a Woman (1994)"],[382.0,"Wolf (1994)"],[383.0,"Wyatt Earp (1994)"],[384.0,"Bad Company (1995)"],[385.0,"Man of No Importance, A (1994)"],[386.0,"S.F.W. (1994)"],[387.0,"Low Down Dirty Shame, A (1994)"],[388.0,"Boys Life (1995)"],[389.0,"Colonel Chabert, Le (1994)"],[390.0,"Faster Pussycat! Kill! Kill! (1965)"],[391.0,"Jason's Lyric (1994)"],[392.0,"Secret Adventures of Tom Thumb, The (1993)"],[393.0,"Street Fighter (1994)"],[394.0,"Coldblooded (1995)"],[395.0,"Desert Winds (1995)"],[396.0,"Fall Time (1995)"],[397.0,"Fear, The (1995)"],[398.0,"Frank and Ollie (1995)"],[399.0,"Girl in the Cadillac (1995)"],[400.0,"Homage (1995)"],[401.0,"Mirage (1995)"],[402.0,"Open Season (1996)"],[403.0,"Two Crimes (Dos crímenes) (1995)"],[404.0,"Brother Minister: The Assassination of Malcolm X (1994)"],[405.0,"Highlander III: The Sorcerer (a.k.a. Highlander: The Final Dimension) (1994)"],[406.0,"Federal Hill (1994)"],[407.0,"In the Mouth of Madness (1995)"],[408.0,"8 Seconds (1994)"],[409.0,"Above the Rim (1994)"],[410.0,"Addams Family Values (1993)"],[411.0,"Martin Lawrence: You So Crazy (1994)"],[412.0,"Age of Innocence, The (1993)"],[413.0,"Airheads (1994)"],[414.0,"Air Up There, The (1994)"],[415.0,"Another Stakeout (1993)"],[416.0,"Bad Girls (1994)"],[417.0,"Barcelona (1994)"],[418.0,"Being Human (1993)"],[419.0,"Beverly Hillbillies, The (1993)"],[420.0,"Beverly Hills Cop III (1994)"],[421.0,"Black Beauty (1994)"],[422.0,"Blink (1994)"],[423.0,"Blown Away (1994)"],[424.0,"Blue Chips (1994)"],[425.0,"Blue Sky (1994)"],[426.0,"Body Snatchers (1993)"],[427.0,"Boxing Helena (1993)"],[428.0,"Bronx Tale, A (1993)"],[429.0,"Cabin Boy (1994)"],[430.0,"Calendar Girl (1993)"],[431.0,"Carlito's Way (1993)"],[432.0,"City Slickers II: The Legend of Curly's Gold (1994)"],[433.0,"Clean Slate (1994)"],[434.0,"Cliffhanger (1993)"],[435.0,"Coneheads (1993)"],[436.0,"Color of Night (1994)"],[437.0,"Cops and Robbersons (1994)"],[438.0,"Cowboy Way, The (1994)"],[439.0,"Dangerous Game (1993)"],[440.0,"Dave (1993)"],[441.0,"Dazed and Confused (1993)"],[442.0,"Demolition Man (1993)"],[443.0,"Endless Summer 2, The (1994)"],[444.0,"Even Cowgirls Get the Blues (1993)"],[445.0,"Fatal Instinct (1993)"],[446.0,"Farewell My Concubine (Ba wang bie ji) (1993)"],[447.0,"Favor, The (1994)"],[448.0,"Fearless (1993)"],[449.0,"Fear of a Black Hat (1994)"],[450.0,"With Honors (1994)"],[451.0,"Flesh and Bone (1993)"],[452.0,"Widows' Peak (1994)"],[453.0,"For Love or Money (1993)"],[454.0,"Firm, The (1993)"],[455.0,"Free Willy (1993)"],[456.0,"Fresh (1994)"],[457.0,"Fugitive, The (1993)"],[458.0,"Geronimo: An American Legend (1993)"],[459.0,"Getaway, The (1994)"],[460.0,"Getting Even with Dad (1994)"],[461.0,"Go Fish (1994)"],[462.0,"Good Man in Africa, A (1994)"],[463.0,"Guilty as Sin (1993)"],[464.0,"Hard Target (1993)"],[465.0,"Heaven & Earth (1993)"],[466.0,"Hot Shots! Part Deux (1993)"],[467.0,"Live Nude Girls (1995)"],[468.0,"Englishman Who Went Up a Hill But Came Down a Mountain, The (1995)"],[469.0,"House of the Spirits, The (1993)"],[470.0,"House Party 3 (1994)"],[471.0,"Hudsucker Proxy, The (1994)"],[472.0,"I'll Do Anything (1994)"],[473.0,"In the Army Now (1994)"],[474.0,"In the Line of Fire (1993)"],[475.0,"In the Name of the Father (1993)"],[476.0,"Inkwell, The (1994)"],[477.0,"What's Love Got to Do with It? (1993)"],[478.0,"Jimmy Hollywood (1994)"],[479.0,"Judgment Night (1993)"],[480.0,"Jurassic Park (1993)"],[481.0,"Kalifornia (1993)"],[482.0,"Killing Zoe (1994)"],[483.0,"King of the Hill (1993)"],[484.0,"Lassie (1994)"],[485.0,"Last Action Hero (1993)"],[486.0,"Life with Mikey (1993)"],[487.0,"Lightning Jack (1994)"],[488.0,"M. Butterfly (1993)"],[489.0,"Made in America (1993)"],[490.0,"Malice (1993)"],[491.0,"Man Without a Face, The (1993)"],[492.0,"Manhattan Murder Mystery (1993)"],[493.0,"Menace II Society (1993)"],[494.0,"Executive Decision (1996)"],[495.0,"In the Realm of the Senses (Ai no corrida) (1976)"],[496.0,"What Happened Was... (1994)"],[497.0,"Much Ado About Nothing (1993)"],[498.0,"Mr. Jones (1993)"],[499.0,"Mr. Wonderful (1993)"],[500.0,"Mrs. Doubtfire (1993)"],[501.0,"Naked (1993)"],[502.0,"Next Karate Kid, The (1994)"],[503.0,"New Age, The (1994)"],[504.0,"No Escape (1994)"],[505.0,"North (1994)"],[506.0,"Orlando (1992)"],[507.0,"Perfect World, A (1993)"],[508.0,"Philadelphia (1993)"],[509.0,"Piano, The (1993)"],[510.0,"Poetic Justice (1993)"],[511.0,"Program, The (1993)"],[512.0,"Puppet Masters, The (1994)"],[513.0,"Radioland Murders (1994)"],[514.0,"Ref, The (1994)"],[515.0,"Remains of the Day, The (1993)"],[516.0,"Renaissance Man (1994)"],[517.0,"Rising Sun (1993)"],[518.0,"Road to Wellville, The (1994)"],[519.0,"RoboCop 3 (1993)"],[520.0,"Robin Hood: Men in Tights (1993)"],[521.0,"Romeo Is Bleeding (1993)"],[522.0,"Romper Stomper (1992)"],[523.0,"Ruby in Paradise (1993)"],[524.0,"Rudy (1993)"],[525.0,"Saint of Fort Washington, The (1993)"],[526.0,"Savage Nights (Nuits fauves, Les) (1992)"],[527.0,"Schindler's List (1993)"],[528.0,"Scout, The (1994)"],[529.0,"Searching for Bobby Fischer (1993)"],[530.0,"Second Best (1994)"],[531.0,"Secret Garden, The (1993)"],[532.0,"Serial Mom (1994)"],[533.0,"Shadow, The (1994)"],[534.0,"Shadowlands (1993)"],[535.0,"Short Cuts (1993)"],[536.0,"Simple Twist of Fate, A (1994)"],[537.0,"Sirens (1994)"],[538.0,"Six Degrees of Separation (1993)"],[539.0,"Sleepless in Seattle (1993)"],[540.0,"Sliver (1993)"],[541.0,"Blade Runner (1982)"],[542.0,"Son in Law (1993)"],[543.0,"So I Married an Axe Murderer (1993)"],[544.0,"Striking Distance (1993)"],[545.0,"Harem (1985)"],[546.0,"Super Mario Bros. (1993)"],[547.0,"Surviving the Game (1994)"],[548.0,"Terminal Velocity (1994)"],[549.0,"Thirty-Two Short Films About Glenn Gould (1993)"],[550.0,"Threesome (1994)"],[551.0,"Nightmare Before Christmas, The (1993)"],[552.0,"Three Musketeers, The (1993)"],[553.0,"Tombstone (1993)"],[554.0,"Trial by Jury (1994)"],[555.0,"True Romance (1993)"],[556.0,"War Room, The (1993)"],[558.0,"Pagemaster, The (1994)"],[559.0,"Paris, France (1993)"],[560.0,"Beans of Egypt, Maine, The (1994)"],[561.0,"Killer (Bulletproof Heart) (1994)"],[562.0,"Welcome to the Dollhouse (1995)"],[563.0,"Germinal (1993)"],[564.0,"Chasers (1994)"],[565.0,"Cronos (1993)"],[566.0,"Naked in New York (1994)"],[567.0,"Kika (1993)"],[568.0,"Bhaji on the Beach (1993)"],[569.0,"Little Big League (1994)"],[570.0,"Slingshot, The (Kådisbellan) (1993)"],[571.0,"Wedding Gift, The (1994)"],[572.0,"Foreign Student (1994)"],[573.0,"Ciao, Professore! (Io speriamo che me la cavo) (1992)"],[574.0,"Spanking the Monkey (1994)"],[575.0,"Little Rascals, The (1994)"],[576.0,"Fausto (1993)"],[577.0,"Andre (1994)"],[579.0,"Escort, The (Scorta, La) (1993)"],[580.0,"Princess Caraboo (1994)"],[581.0,"Celluloid Closet, The (1995)"],[582.0,"Métisse (Café au Lait) (1993)"],[583.0,"Dear Diary (Caro Diario) (1994)"],[584.0,"I Don't Want to Talk About It (De eso no se habla) (1993)"],[585.0,"Brady Bunch Movie, The (1995)"],[586.0,"Home Alone (1990)"],[587.0,"Ghost (1990)"],[588.0,"Aladdin (1992)"],[589.0,"Terminator 2: Judgment Day (1991)"],[590.0,"Dances with Wolves (1990)"],[591.0,"Tough and Deadly (1995)"],[592.0,"Batman (1989)"],[593.0,"Silence of the Lambs, The (1991)"],[594.0,"Snow White and the Seven Dwarfs (1937)"],[595.0,"Beauty and the Beast (1991)"],[596.0,"Pinocchio (1940)"],[597.0,"Pretty Woman (1990)"],[598.0,"Window to Paris (Okno v Parizh) (1994)"],[599.0,"Wild Bunch, The (1969)"],[600.0,"Love and a .45 (1994)"],[601.0,"Wooden Man's Bride, The (Yan shen) (1994)"],[602.0,"Great Day in Harlem, A (1994)"],[603.0,"Bye Bye, Love (1995)"],[604.0,"Criminals (1996)"],[605.0,"One Fine Day (1996)"],[606.0,"Candyman: Farewell to the Flesh (1995)"],[607.0,"Century (1993)"],[608.0,"Fargo (1996)"],[609.0,"Homeward Bound II: Lost in San Francisco (1996)"],[610.0,"Heavy Metal (1981)"],[611.0,"Hellraiser: Bloodline (1996)"],[612.0,"Pallbearer, The (1996)"],[613.0,"Jane Eyre (1996)"],[614.0,"Loaded (1994)"],[615.0,"Bread and Chocolate (Pane e cioccolata) (1973)"],[616.0,"Aristocats, The (1970)"],[617.0,"Flower of My Secret, The (La flor de mi secreto) (1995)"],[618.0,"Two Much (1995)"],[619.0,"Ed (1996)"],[620.0,"Scream of Stone (Cerro Torre: Schrei aus Stein) (1991)"],[621.0,"My Favorite Season (1993)"],[623.0,"Modern Affair, A (1995)"],[624.0,"Condition Red (Beyond the Law) (1995)"],[625.0,"Asfour Stah (1990)"],[626.0,"Thin Line Between Love and Hate, A (1996)"],[627.0,"Last Supper, The (1995)"],[628.0,"Primal Fear (1996)"],[629.0,"Rude (1995)"],[630.0,"Carried Away (1996)"],[631.0,"All Dogs Go to Heaven 2 (1996)"],[632.0,"Land and Freedom (Tierra y libertad) (1995)"],[633.0,"Denise Calls Up (1995)"],[634.0,"Theodore Rex (1995)"],[635.0,"Family Thing, A (1996)"],[636.0,"Frisk (1995)"],[637.0,"Sgt. Bilko (1996)"],[638.0,"Jack and Sarah (1995)"],[639.0,"Girl 6 (1996)"],[640.0,"Diabolique (1996)"],[641.0,"Little Indian, Big City (Un indien dans la ville) (1994)"],[642.0,"Roula (1995)"],[643.0,"Peanuts - Die Bank zahlt alles (1996)"],[644.0,"Happy Weekend (1996)"],[645.0,"Nelly & Monsieur Arnaud (1995)"],[647.0,"Courage Under Fire (1996)"],[648.0,"Mission: Impossible (1996)"],[649.0,"Cold Fever (Á köldum klaka) (1995)"],[650.0,"Moll Flanders (1996)"],[651.0,"Superweib, Das (1996)"],[652.0,"301, 302 (301/302) (1995)"],[653.0,"Dragonheart (1996)"],[654.0,"And Nobody Weeps for Me (Und keiner weint mir nach) (1996)"],[655.0,"My Mother's Courage (Mutters Courage) (1995)"],[656.0,"Eddie (1996)"],[657.0,"Yankee Zulu (1994)"],[658.0,"Billy's Holiday (1995)"],[659.0,"Purple Noon (Plein soleil) (1960)"],[660.0,"August (1996)"],[661.0,"James and the Giant Peach (1996)"],[662.0,"Fear (1996)"],[663.0,"Kids in the Hall: Brain Candy (1996)"],[664.0,"Faithful (1996)"],[665.0,"Underground (1995)"],[666.0,"All Things Fair (Lust och fägring stor) (1995)"],[667.0,"Bloodsport 2 (a.k.a. Bloodsport II: The Next Kumite) (1996)"],[668.0,"Song of the Little Road (Pather Panchali) (1955)"],[670.0,"World of Apu, The (Apur Sansar) (1959)"],[671.0,"Mystery Science Theater 3000: The Movie (1996)"],[672.0,"Tarantella (1995)"],[673.0,"Space Jam (1996)"],[674.0,"Barbarella (1968)"],[675.0,"Hostile Intentions (1994)"],[676.0,"They Bite (1996)"],[678.0,"Some Folks Call It a Sling Blade (1993)"],[679.0,"Run of the Country, The (1995)"],[680.0,"Alphaville (Alphaville, une étrange aventure de Lemmy Caution) (1965)"],[681.0,"Coup de torchon (Clean Slate) (1981)"],[682.0,"Tigrero: A Film That Was Never Made (1994)"],[683.0,"Eye of Vichy, The (Oeil de Vichy, L') (1993)"],[684.0,"Windows (1980)"],[685.0,"It's My Party (1996)"],[687.0,"Country Life (1994)"],[688.0,"Operation Dumbo Drop (1995)"],[690.0,"Promise, The (Versprechen, Das) (1995)"],[691.0,"Mrs. Winterbourne (1996)"],[692.0,"Solo (1996)"],[693.0,"Under the Domim Tree (Etz Hadomim Tafus) (1994)"],[694.0,"Substitute, The (1996)"],[695.0,"True Crime (1996)"],[696.0,"Butterfly Kiss (1995)"],[697.0,"Feeling Minnesota (1996)"],[698.0,"Delta of Venus (1995)"],[699.0,"To Cross the Rubicon (1991)"],[700.0,"Angus (1995)"],[701.0,"Daens (1992)"],[702.0,"Faces (1968)"],[703.0,"Boys (1996)"],[704.0,"Quest, The (1996)"],[705.0,"Cosi (1996)"],[706.0,"Sunset Park (1996)"],[707.0,"Mulholland Falls (1996)"],[708.0,"Truth About Cats & Dogs, The (1996)"],[709.0,"Oliver & Company (1988)"],[710.0,"Celtic Pride (1996)"],[711.0,"Flipper (1996)"],[712.0,"Captives (1994)"],[713.0,"Of Love and Shadows (1994)"],[714.0,"Dead Man (1995)"],[715.0,"Horseman on the Roof, The (Hussard sur le toit, Le) (1995)"],[716.0,"Switchblade Sisters (1975)"],[717.0,"Mouth to Mouth (Boca a boca) (1995)"],[718.0,"Visitors, The (Visiteurs, Les) (1993)"],[719.0,"Multiplicity (1996)"],[720.0,"Wallace & Gromit: The Best of Aardman Animation (1996)"],[721.0,"Halfmoon (Paul Bowles - Halbmond) (1995)"],[722.0,"Haunted World of Edward D. Wood Jr., The (1996)"],[723.0,"Two Friends (1986)"],[724.0,"Craft, The (1996)"],[725.0,"Great White Hype, The (1996)"],[726.0,"Last Dance (1996)"],[727.0,"War Stories (1995)"],[728.0,"Cold Comfort Farm (1995)"],[729.0,"Institute Benjamenta, or This Dream People Call Human Life (1995)"],[730.0,"Low Life (1994)"],[731.0,"Heaven's Prisoners (1996)"],[732.0,"Original Gangstas (1996)"],[733.0,"Rock, The (1996)"],[734.0,"Getting Away With Murder (1996)"],[735.0,"Cemetery Man (Dellamorte Dellamore) (1994)"],[736.0,"Twister (1996)"],[737.0,"Barb Wire (1996)"],[738.0,"Garçu, Le (1995)"],[739.0,"Honey Moon (Honigmond) (1996)"],[741.0,"Ghost in the Shell (Kôkaku kidôtai) (1995)"],[742.0,"Thinner (1996)"],[743.0,"Spy Hard (1996)"],[744.0,"Brothers in Trouble (1995)"],[745.0,"Wallace & Gromit: A Close Shave (1995)"],[746.0,"Force of Evil (1948)"],[747.0,"Stupids, The (1996)"],[748.0,"Arrival, The (1996)"],[749.0,"Man from Down Under, The (1943)"],[750.0,"Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb (1964)"],[751.0,"Careful (1992)"],[752.0,"Vermont Is For Lovers (1992)"],[753.0,"Month by the Lake, A (1995)"],[754.0,"Gold Diggers: The Secret of Bear Mountain (1995)"],[755.0,"Kim (1950)"],[756.0,"Carmen Miranda: Bananas Is My Business (1994)"],[757.0,"Ashes of Time (Dung che sai duk) (1994)"],[758.0,"Jar, The (Khomreh) (1992)"],[759.0,"Maya Lin: A Strong Clear Vision (1994)"],[760.0,"Stalingrad (1993)"],[761.0,"Phantom, The (1996)"],[762.0,"Striptease (1996)"],[763.0,"Last of the High Kings, The (a.k.a. Summer Fling) (1996)"],[764.0,"Heavy (1995)"],[765.0,"Jack (1996)"],[766.0,"I Shot Andy Warhol (1996)"],[767.0,"Grass Harp, The (1995)"],[768.0,"Someone Else's America (1995)"],[769.0,"Marlene Dietrich: Shadow and Light (1996)"],[770.0,"Costa Brava (1946)"],[771.0,"Life Is Rosy (a.k.a. Life Is Beautiful) (Vie est belle, La) (1987)"],[772.0,"Quartier Mozart (1992)"],[773.0,"Touki Bouki (1973)"],[774.0,"Wend Kuuni (a.k.a. God's Gift) (1982)"],[775.0,"Spirits of the Dead (1968)"],[776.0,"Babyfever (1994)"],[777.0,"Pharaoh's Army (1995)"],[778.0,"Trainspotting (1996)"],[779.0,"'Til There Was You (1997)"],[780.0,"Independence Day (a.k.a. ID4) (1996)"],[781.0,"Stealing Beauty (1996)"],[782.0,"Fan, The (1996)"],[783.0,"Hunchback of Notre Dame, The (1996)"],[784.0,"Cable Guy, The (1996)"],[785.0,"Kingpin (1996)"],[786.0,"Eraser (1996)"],[787.0,"Gate of Heavenly Peace, The (1995)"],[788.0,"Nutty Professor, The (1996)"],[789.0,"I, the Worst of All (Yo, la peor de todas) (1990)"],[790.0,"Unforgettable Summer, An (Un été inoubliable) (1994)"],[791.0,"Last Klezmer: Leopold Kozlowski, His Life and Music, The (1994)"],[792.0,"Hungarian Fairy Tale, A (Hol volt, hol nem volt) (1987)"],[793.0,"My Life and Times With Antonin Artaud (En compagnie d'Antonin Artaud) (1993)"],[794.0,"Midnight Dancers (Sibak) (1994)"],[795.0,"Somebody to Love (1994)"],[796.0,"Very Natural Thing, A (1974)"],[797.0,"Old Lady Who Walked in the Sea, The (Vieille qui marchait dans la mer, La) (1991)"],[798.0,"Daylight (1996)"],[799.0,"Frighteners, The (1996)"],[800.0,"Lone Star (1996)"],[801.0,"Harriet the Spy (1996)"],[802.0,"Phenomenon (1996)"],[803.0,"Walking and Talking (1996)"],[804.0,"She's the One (1996)"],[805.0,"Time to Kill, A (1996)"],[806.0,"American Buffalo (1996)"],[807.0,"Rendezvous in Paris (Rendez-vous de Paris, Les) (1995)"],[808.0,"Alaska (1996)"],[809.0,"Fled (1996)"],[810.0,"Kazaam (1996)"],[812.0,"Magic Hunter (Büvös vadász) (1994)"],[813.0,"Larger Than Life (1996)"],[814.0,"Boy Called Hate, A (1995)"],[815.0,"Power 98 (1996)"],[816.0,"Two Deaths (1995)"],[818.0,"Very Brady Sequel, A (1996)"],[819.0,"Stefano Quantestorie (1993)"],[820.0,"Death in the Garden (Mort en ce jardin, La) (1956)"],[821.0,"Crude Oasis, The (1995)"],[822.0,"Hedd Wyn (1992)"],[823.0,"Collector, The (La collectionneuse) (1967)"],[824.0,"Kaspar Hauser (1993)"],[825.0,"Regular Guys (Echte Kerle) (1996)"],[826.0,"Women Robbers (Diebinnen) (1995)"],[827.0,"Convent, The (O Convento) (1995)"],[828.0,"Adventures of Pinocchio, The (1996)"],[829.0,"Joe's Apartment (1996)"],[830.0,"First Wives Club, The (1996)"],[831.0,"Stonewall (1995)"],[832.0,"Ransom (1996)"],[833.0,"High School High (1996)"],[834.0,"Phat Beach (1996)"],[835.0,"Foxfire (1996)"],[836.0,"Chain Reaction (1996)"],[837.0,"Matilda (1996)"],[838.0,"Emma (1996)"],[839.0,"Crow: City of Angels, The (1996)"],[840.0,"House Arrest (1996)"],[841.0,"Eyes Without a Face (Yeux sans visage, Les) (1959)"],[842.0,"Tales from the Crypt Presents: Bordello of Blood (1996)"],[843.0,"Lotto Land (1995)"],[844.0,"Story of Xinghua, The (Xinghua san yue tian) (1994)"],[845.0,"Day the Sun Turned Cold, The (Tianguo niezi) (1994)"],[846.0,"Flirt (1995)"],[847.0,"Big Squeeze, The (1996)"],[848.0,"Spitfire Grill, The (1996)"],[849.0,"Escape from L.A. (1996)"],[850.0,"Cyclo (Xich lo) (1995)"],[851.0,"Basquiat (1996)"],[852.0,"Tin Cup (1996)"],[853.0,"Dingo (1991)"],[854.0,"Ballad of Narayama, The (Narayama Bushiko) (1958)"],[855.0,"Every Other Weekend (Un week-end sur deux) (1990)"],[856.0,"Mille bolle blu (1993)"],[857.0,"Crows and Sparrows (Wuya yu maque) (1949)"],[858.0,"Godfather, The (1972)"],[859.0,"Hippie Revolution, The (1996)"],[860.0,"Maybe, Maybe Not (Bewegte Mann, Der) (1994)"],[861.0,"Supercop (Police Story 3: Supercop) (Jing cha gu shi III: Chao ji jing cha) (1992)"],[862.0,"Manny & Lo (1996)"],[864.0,"Wife, The (1995)"],[865.0,"Small Faces (1996)"],[866.0,"Bound (1996)"],[867.0,"Carpool (1996)"],[868.0,"Death in Brunswick (1991)"],[869.0,"Kansas City (1996)"],[870.0,"Gone Fishin' (1997)"],[871.0,"Lover's Knot (1996)"],[872.0,"Vive L'Amour (Ai qing wan sui) (1994)"],[873.0,"Shadow of Angels (Schatten der Engel) (1976)"],[874.0,"Killer: A Journal of Murder (1995)"],[875.0,"Nothing to Lose (1994)"],[876.0,"Supercop 2 (Project S) (Chao ji ji hua) (1993)"],[877.0,"Girls Town (1996)"],[878.0,"Bye-Bye (1995)"],[879.0,"Relic, The (1997)"],[880.0,"Island of Dr. Moreau, The (1996)"],[881.0,"First Kid (1996)"],[882.0,"Trigger Effect, The (1996)"],[884.0,"Sweet Nothing (1996)"],[885.0,"Bogus (1996)"],[886.0,"Bulletproof (1996)"],[887.0,"Talk of Angels (1998)"],[888.0,"Land Before Time III: The Time of the Great Giving (1995)"],[889.0,"1-900 (06) (1994)"],[890.0,"Baton Rouge (Bâton rouge) (1988)"],[891.0,"Halloween: The Curse of Michael Myers (Halloween 6: The Curse of Michael Myers) (1995)"],[892.0,"Twelfth Night (1996)"],[893.0,"Mother Night (1996)"],[894.0,"Liebelei (1933)"],[895.0,"Venice/Venice (1992)"],[896.0,"Wild Reeds (Les roseaux sauvages) (1994)"],[897.0,"For Whom the Bell Tolls (1943)"],[898.0,"Philadelphia Story, The (1940)"],[899.0,"Singin' in the Rain (1952)"],[900.0,"American in Paris, An (1951)"],[901.0,"Funny Face (1957)"],[902.0,"Breakfast at Tiffany's (1961)"],[903.0,"Vertigo (1958)"],[904.0,"Rear Window (1954)"],[905.0,"It Happened One Night (1934)"],[906.0,"Gaslight (1944)"],[907.0,"Gay Divorcee, The (1934)"],[908.0,"North by Northwest (1959)"],[909.0,"Apartment, The (1960)"],[910.0,"Some Like It Hot (1959)"],[911.0,"Charade (1963)"],[912.0,"Casablanca (1942)"],[913.0,"Maltese Falcon, The (1941)"],[914.0,"My Fair Lady (1964)"],[915.0,"Sabrina (1954)"],[916.0,"Roman Holiday (1953)"],[917.0,"Little Princess, The (1939)"],[918.0,"Meet Me in St. Louis (1944)"],[919.0,"Wizard of Oz, The (1939)"],[920.0,"Gone with the Wind (1939)"],[921.0,"My Favorite Year (1982)"],[922.0,"Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)"],[923.0,"Citizen Kane (1941)"],[924.0,"2001: A Space Odyssey (1968)"],[925.0,"Golden Earrings (1947)"],[926.0,"All About Eve (1950)"],[927.0,"Women, The (1939)"],[928.0,"Rebecca (1940)"],[929.0,"Foreign Correspondent (1940)"],[930.0,"Notorious (1946)"],[931.0,"Spellbound (1945)"],[932.0,"Affair to Remember, An (1957)"],[933.0,"To Catch a Thief (1955)"],[934.0,"Father of the Bride (1950)"],[935.0,"Band Wagon, The (1953)"],[936.0,"Ninotchka (1939)"],[937.0,"Love in the Afternoon (1957)"],[938.0,"Gigi (1958)"],[939.0,"Reluctant Debutante, The (1958)"],[940.0,"Adventures of Robin Hood, The (1938)"],[941.0,"Mark of Zorro, The (1940)"],[942.0,"Laura (1944)"],[943.0,"Ghost and Mrs. Muir, The (1947)"],[944.0,"Lost Horizon (1937)"],[945.0,"Top Hat (1935)"],[946.0,"To Be or Not to Be (1942)"],[947.0,"My Man Godfrey (1936)"],[948.0,"Giant (1956)"],[949.0,"East of Eden (1955)"],[950.0,"Thin Man, The (1934)"],[951.0,"His Girl Friday (1940)"],[952.0,"Around the World in 80 Days (1956)"],[953.0,"It's a Wonderful Life (1946)"],[954.0,"Mr. Smith Goes to Washington (1939)"],[955.0,"Bringing Up Baby (1938)"],[956.0,"Penny Serenade (1941)"],[957.0,"Scarlet Letter, The (1926)"],[958.0,"Lady of Burlesque (1943)"],[959.0,"Of Human Bondage (1934)"],[960.0,"Angel on My Shoulder (1946)"],[961.0,"Little Lord Fauntleroy (1936)"],[962.0,"They Made Me a Criminal (I Became a Criminal) (They Made Me a Fugitive) (1939)"],[963.0,"Inspector General, The (1949)"],[964.0,"Angel and the Badman (1947)"],[965.0,"39 Steps, The (1935)"],[966.0,"Walk in the Sun, A (1945)"],[967.0,"Outlaw, The (1943)"],[968.0,"Night of the Living Dead (1968)"],[969.0,"African Queen, The (1951)"],[970.0,"Beat the Devil (1953)"],[971.0,"Cat on a Hot Tin Roof (1958)"],[972.0,"Last Time I Saw Paris, The (1954)"],[973.0,"Meet John Doe (1941)"],[974.0,"Algiers (1938)"],[975.0,"Something to Sing About (1937)"],[976.0,"Farewell to Arms, A (1932)"],[977.0,"Moonlight Murder (1936)"],[979.0,"Nothing Personal (1995)"],[980.0,"Yes, Madam (a.k.a. Police Assassins) (a.k.a. In the Line of Duty 2) (Huang gu shi jie) (1985)"],[981.0,"Dangerous Ground (1997)"],[982.0,"Picnic (1955)"],[983.0,"Madagascar Skin (1995)"],[984.0,"Pompatus of Love, The (1996)"],[985.0,"Small Wonders (1995)"],[986.0,"Fly Away Home (1996)"],[987.0,"Bliss (1997)"],[988.0,"Grace of My Heart (1996)"],[989.0,"Brother of Sleep (Schlafes Bruder) (1995)"],[990.0,"Maximum Risk (1996)"],[991.0,"Michael Collins (1996)"],[992.0,"Rich Man's Wife, The (1996)"],[993.0,"Infinity (1996)"],[994.0,"Big Night (1996)"],[996.0,"Last Man Standing (1996)"],[997.0,"Caught (1996)"],[998.0,"Set It Off (1996)"],[999.0,"2 Days in the Valley (1996)"],[1000.0,"Curdled (1996)"],[1001.0,"Associate, The (Associé, L') (1979)"],[1002.0,"Ed's Next Move (1996)"],[1003.0,"Extreme Measures (1996)"],[1004.0,"Glimmer Man, The (1996)"],[1005.0,"D3: The Mighty Ducks (1996)"],[1006.0,"Chamber, The (1996)"],[1007.0,"Apple Dumpling Gang, The (1975)"],[1008.0,"Davy Crockett, King of the Wild Frontier (1955)"],[1009.0,"Escape to Witch Mountain (1975)"],[1010.0,"Love Bug, The (1969)"],[1011.0,"Herbie Rides Again (1974)"],[1012.0,"Old Yeller (1957)"],[1013.0,"Parent Trap, The (1961)"],[1014.0,"Pollyanna (1960)"],[1015.0,"Homeward Bound: The Incredible Journey (1993)"],[1016.0,"Shaggy Dog, The (1959)"],[1017.0,"Swiss Family Robinson (1960)"],[1018.0,"That Darn Cat! (1965)"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"ID","type":"\"integer\""},{"name":"title","type":"\"string\""}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47312079137E12,"submitTime":1.473120738332E12,"finishTime":1.473120791472E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6c9358cf-99ad-49fd-8abf-f4f2577dad76"},{"version":"CommandV1","origId":36148146263653,"guid":"0f1ef5c2-759e-41dd-b574-c69dfe797c13","subtype":"command","commandType":"auto","position":17.0,"command":"display(ratings_df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1.0,2.0,3.5],[1.0,29.0,3.5],[1.0,32.0,3.5],[1.0,47.0,3.5],[1.0,50.0,3.5],[1.0,112.0,3.5],[1.0,151.0,4.0],[1.0,223.0,4.0],[1.0,253.0,4.0],[1.0,260.0,4.0],[1.0,293.0,4.0],[1.0,296.0,4.0],[1.0,318.0,4.0],[1.0,337.0,3.5],[1.0,367.0,3.5],[1.0,541.0,4.0],[1.0,589.0,3.5],[1.0,593.0,3.5],[1.0,653.0,3.0],[1.0,919.0,3.5],[1.0,924.0,3.5],[1.0,1009.0,3.5],[1.0,1036.0,4.0],[1.0,1079.0,4.0],[1.0,1080.0,3.5],[1.0,1089.0,3.5],[1.0,1090.0,4.0],[1.0,1097.0,4.0],[1.0,1136.0,3.5],[1.0,1193.0,3.5],[1.0,1196.0,4.5],[1.0,1198.0,4.5],[1.0,1200.0,4.0],[1.0,1201.0,3.0],[1.0,1208.0,3.5],[1.0,1214.0,4.0],[1.0,1215.0,4.0],[1.0,1217.0,3.5],[1.0,1219.0,4.0],[1.0,1222.0,3.5],[1.0,1240.0,4.0],[1.0,1243.0,3.0],[1.0,1246.0,3.5],[1.0,1249.0,4.0],[1.0,1258.0,4.0],[1.0,1259.0,4.0],[1.0,1261.0,3.5],[1.0,1262.0,3.5],[1.0,1266.0,4.0],[1.0,1278.0,4.0],[1.0,1291.0,3.5],[1.0,1304.0,3.0],[1.0,1321.0,4.0],[1.0,1333.0,4.0],[1.0,1348.0,3.5],[1.0,1350.0,3.5],[1.0,1358.0,4.0],[1.0,1370.0,3.0],[1.0,1374.0,4.0],[1.0,1387.0,4.0],[1.0,1525.0,3.0],[1.0,1584.0,3.5],[1.0,1750.0,3.5],[1.0,1848.0,3.5],[1.0,1920.0,3.5],[1.0,1967.0,4.0],[1.0,1994.0,3.5],[1.0,1997.0,3.5],[1.0,2021.0,4.0],[1.0,2100.0,4.0],[1.0,2118.0,4.0],[1.0,2138.0,4.0],[1.0,2140.0,4.0],[1.0,2143.0,4.0],[1.0,2173.0,4.0],[1.0,2174.0,4.0],[1.0,2193.0,4.0],[1.0,2194.0,3.5],[1.0,2253.0,3.5],[1.0,2288.0,4.0],[1.0,2291.0,4.0],[1.0,2542.0,4.0],[1.0,2628.0,4.0],[1.0,2644.0,3.5],[1.0,2648.0,3.5],[1.0,2664.0,3.5],[1.0,2683.0,3.5],[1.0,2692.0,3.5],[1.0,2716.0,3.5],[1.0,2761.0,3.0],[1.0,2762.0,4.0],[1.0,2804.0,3.5],[1.0,2872.0,4.0],[1.0,2918.0,3.5],[1.0,2944.0,4.0],[1.0,2947.0,3.5],[1.0,2959.0,4.0],[1.0,2968.0,4.0],[1.0,3000.0,3.5],[1.0,3030.0,3.0],[1.0,3037.0,3.5],[1.0,3081.0,4.0],[1.0,3153.0,4.0],[1.0,3265.0,3.5],[1.0,3438.0,3.5],[1.0,3476.0,3.5],[1.0,3479.0,4.0],[1.0,3489.0,4.0],[1.0,3499.0,4.0],[1.0,3889.0,4.0],[1.0,3932.0,3.0],[1.0,3996.0,4.0],[1.0,3997.0,3.5],[1.0,4011.0,4.0],[1.0,4027.0,4.0],[1.0,4105.0,3.5],[1.0,4128.0,4.0],[1.0,4133.0,3.0],[1.0,4226.0,3.5],[1.0,4306.0,4.0],[1.0,4446.0,3.5],[1.0,4467.0,4.0],[1.0,4571.0,4.0],[1.0,4720.0,3.5],[1.0,4754.0,4.0],[1.0,4878.0,3.5],[1.0,4896.0,4.0],[1.0,4911.0,4.0],[1.0,4915.0,3.0],[1.0,4941.0,3.5],[1.0,4980.0,3.5],[1.0,4993.0,5.0],[1.0,5026.0,4.0],[1.0,5039.0,4.0],[1.0,5040.0,3.0],[1.0,5146.0,3.5],[1.0,5171.0,4.0],[1.0,5540.0,4.0],[1.0,5679.0,3.5],[1.0,5797.0,4.0],[1.0,5816.0,4.0],[1.0,5898.0,3.5],[1.0,5952.0,5.0],[1.0,5999.0,3.5],[1.0,6093.0,4.0],[1.0,6242.0,3.5],[1.0,6333.0,4.0],[1.0,6502.0,3.5],[1.0,6539.0,4.0],[1.0,6754.0,4.0],[1.0,6755.0,3.5],[1.0,6774.0,4.0],[1.0,6807.0,3.5],[1.0,6834.0,3.5],[1.0,6888.0,3.0],[1.0,7001.0,3.5],[1.0,7045.0,3.5],[1.0,7046.0,4.0],[1.0,7153.0,5.0],[1.0,7164.0,3.5],[1.0,7247.0,3.5],[1.0,7387.0,3.5],[1.0,7389.0,4.0],[1.0,7438.0,4.0],[1.0,7449.0,3.5],[1.0,7454.0,4.0],[1.0,7482.0,3.0],[1.0,7757.0,4.0],[1.0,8368.0,4.0],[1.0,8482.0,3.5],[1.0,8507.0,5.0],[1.0,8636.0,4.5],[1.0,8690.0,3.5],[1.0,8961.0,4.0],[1.0,31696.0,4.0],[2.0,3.0,4.0],[2.0,62.0,5.0],[2.0,70.0,5.0],[2.0,110.0,4.0],[2.0,242.0,3.0],[2.0,260.0,5.0],[2.0,266.0,5.0],[2.0,469.0,3.0],[2.0,480.0,5.0],[2.0,541.0,5.0],[2.0,589.0,5.0],[2.0,891.0,2.0],[2.0,908.0,4.0],[2.0,924.0,5.0],[2.0,1121.0,3.0],[2.0,1196.0,5.0],[2.0,1210.0,5.0],[2.0,1214.0,5.0],[2.0,1249.0,5.0],[2.0,1259.0,5.0],[2.0,1270.0,5.0],[2.0,1327.0,5.0],[2.0,1356.0,5.0],[2.0,1544.0,5.0],[2.0,1580.0,4.0],[2.0,1673.0,4.0],[2.0,1748.0,5.0],[2.0,1965.0,3.0],[2.0,1969.0,2.0],[2.0,1970.0,2.0],[2.0,1971.0,2.0],[2.0,1972.0,2.0],[2.0,1973.0,3.0],[2.0,1974.0,5.0],[2.0,1986.0,2.0],[2.0,2291.0,2.0],[2.0,2454.0,4.0],[2.0,2455.0,4.0],[2.0,2791.0,2.0],[2.0,2858.0,3.0],[2.0,2948.0,5.0],[2.0,2951.0,4.0],[2.0,3150.0,4.0],[2.0,3159.0,3.0],[2.0,3173.0,4.0],[2.0,3450.0,5.0],[2.0,3513.0,5.0],[2.0,3534.0,3.0],[2.0,3555.0,4.0],[2.0,3565.0,3.0],[2.0,3703.0,4.0],[2.0,3753.0,4.0],[2.0,3917.0,4.0],[2.0,3918.0,3.0],[2.0,3923.0,4.0],[2.0,3926.0,4.0],[2.0,3927.0,5.0],[2.0,3928.0,5.0],[2.0,3930.0,5.0],[2.0,3937.0,4.0],[2.0,3959.0,5.0],[3.0,1.0,4.0],[3.0,24.0,3.0],[3.0,32.0,4.0],[3.0,50.0,5.0],[3.0,160.0,3.0],[3.0,173.0,2.0],[3.0,175.0,5.0],[3.0,196.0,3.0],[3.0,223.0,5.0],[3.0,260.0,5.0],[3.0,316.0,5.0],[3.0,318.0,5.0],[3.0,329.0,5.0],[3.0,337.0,3.0],[3.0,440.0,3.0],[3.0,442.0,3.0],[3.0,457.0,5.0],[3.0,480.0,5.0],[3.0,490.0,5.0],[3.0,512.0,2.0],[3.0,541.0,5.0],[3.0,589.0,4.0],[3.0,593.0,5.0],[3.0,610.0,4.0],[3.0,718.0,3.0],[3.0,780.0,3.0],[3.0,788.0,4.0],[3.0,858.0,5.0],[3.0,904.0,5.0],[3.0,905.0,3.0],[3.0,919.0,4.0],[3.0,924.0,5.0],[3.0,953.0,5.0],[3.0,968.0,3.0],[3.0,1037.0,3.0],[3.0,1060.0,5.0],[3.0,1073.0,5.0],[3.0,1077.0,4.0],[3.0,1079.0,4.0],[3.0,1084.0,5.0],[3.0,1089.0,5.0],[3.0,1094.0,4.0],[3.0,1097.0,5.0],[3.0,1103.0,4.0],[3.0,1125.0,4.0],[3.0,1127.0,3.0],[3.0,1129.0,5.0],[3.0,1179.0,3.0],[3.0,1188.0,2.0],[3.0,1193.0,4.0],[3.0,1196.0,5.0],[3.0,1197.0,5.0],[3.0,1198.0,5.0],[3.0,1199.0,4.0],[3.0,1200.0,4.0],[3.0,1206.0,5.0],[3.0,1208.0,5.0],[3.0,1210.0,5.0],[3.0,1213.0,5.0],[3.0,1214.0,5.0],[3.0,1215.0,4.0],[3.0,1219.0,4.0],[3.0,1220.0,5.0],[3.0,1221.0,5.0],[3.0,1222.0,5.0],[3.0,1225.0,3.0],[3.0,1228.0,3.0],[3.0,1230.0,5.0],[3.0,1240.0,5.0],[3.0,1242.0,5.0],[3.0,1247.0,5.0],[3.0,1257.0,5.0],[3.0,1258.0,5.0],[3.0,1259.0,5.0],[3.0,1261.0,5.0],[3.0,1266.0,5.0],[3.0,1270.0,5.0],[3.0,1272.0,4.0],[3.0,1276.0,5.0],[3.0,1278.0,5.0],[3.0,1288.0,2.0],[3.0,1304.0,5.0],[3.0,1307.0,4.0],[3.0,1321.0,5.0],[3.0,1330.0,3.0],[3.0,1333.0,4.0],[3.0,1345.0,4.0],[3.0,1356.0,5.0],[3.0,1372.0,3.0],[3.0,1373.0,4.0],[3.0,1374.0,5.0],[3.0,1375.0,5.0],[3.0,1376.0,4.0],[3.0,1396.0,3.0],[3.0,1544.0,4.0],[3.0,1584.0,4.0],[3.0,1603.0,4.0],[3.0,1653.0,4.0],[3.0,1674.0,4.0],[3.0,1676.0,5.0],[3.0,1721.0,4.0],[3.0,1762.0,4.0],[3.0,1779.0,3.0],[3.0,1810.0,3.0],[3.0,1831.0,5.0],[3.0,1876.0,4.0],[3.0,1882.0,4.0],[3.0,1909.0,5.0],[3.0,1917.0,4.0],[3.0,1921.0,4.0],[3.0,2009.0,5.0],[3.0,2011.0,3.0],[3.0,2012.0,3.0],[3.0,2018.0,4.0],[3.0,2028.0,4.0],[3.0,2034.0,4.0],[3.0,2046.0,5.0],[3.0,2053.0,3.0],[3.0,2054.0,4.0],[3.0,2076.0,5.0],[3.0,2093.0,5.0],[3.0,2105.0,4.0],[3.0,2117.0,5.0],[3.0,2118.0,5.0],[3.0,2140.0,4.0],[3.0,2150.0,5.0],[3.0,2236.0,4.0],[3.0,2288.0,5.0],[3.0,2311.0,4.0],[3.0,2329.0,4.0],[3.0,2366.0,4.0],[3.0,2371.0,4.0],[3.0,2391.0,5.0],[3.0,2407.0,4.0],[3.0,2428.0,4.0],[3.0,2448.0,5.0],[3.0,2455.0,4.0],[3.0,2505.0,4.0],[3.0,2528.0,4.0],[3.0,2529.0,5.0],[3.0,2530.0,4.0],[3.0,2531.0,3.0],[3.0,2532.0,4.0],[3.0,2533.0,3.0],[3.0,2541.0,1.0],[3.0,2551.0,4.0],[3.0,2567.0,3.0],[3.0,2571.0,5.0],[3.0,2574.0,3.0],[3.0,2613.0,4.0],[3.0,2615.0,4.0],[3.0,2628.0,5.0],[3.0,2640.0,4.0],[3.0,2642.0,3.0],[3.0,2643.0,1.0],[3.0,2657.0,3.0],[3.0,2662.0,3.0],[3.0,2668.0,4.0],[3.0,2676.0,1.0],[3.0,2694.0,4.0],[3.0,2699.0,3.0],[3.0,2710.0,5.0],[3.0,2722.0,4.0],[3.0,2750.0,4.0],[3.0,2788.0,5.0],[3.0,2791.0,5.0],[3.0,2797.0,4.0],[3.0,2808.0,4.0],[3.0,2857.0,3.0],[3.0,2872.0,5.0],[3.0,2900.0,3.0],[3.0,2901.0,3.0],[3.0,2916.0,4.0],[3.0,2918.0,5.0],[3.0,2947.0,4.0],[3.0,2948.0,4.0],[3.0,2949.0,4.0],[3.0,2968.0,5.0],[3.0,2985.0,5.0],[3.0,2986.0,2.0],[3.0,3033.0,5.0],[3.0,3039.0,5.0],[3.0,3070.0,4.0],[3.0,3072.0,4.0],[3.0,3098.0,4.0],[3.0,3142.0,4.0],[3.0,5060.0,5.0],[4.0,6.0,3.0],[4.0,10.0,4.0],[4.0,19.0,3.0],[4.0,32.0,1.0],[4.0,165.0,3.0],[4.0,329.0,3.0],[4.0,350.0,4.0],[4.0,356.0,4.0],[4.0,367.0,3.0],[4.0,368.0,4.0],[4.0,370.0,4.0],[4.0,377.0,4.0],[4.0,380.0,3.0],[4.0,420.0,3.0],[4.0,431.0,4.0],[4.0,440.0,3.0],[4.0,454.0,5.0],[4.0,480.0,4.0],[4.0,489.0,4.0],[4.0,519.0,3.0],[4.0,520.0,4.0],[4.0,531.0,3.0],[4.0,548.0,3.0],[4.0,586.0,4.0],[4.0,589.0,4.0],[4.0,594.0,4.0],[4.0,596.0,4.0],[4.0,733.0,5.0],[5.0,2.0,3.0],[5.0,11.0,5.0],[5.0,17.0,3.0],[5.0,60.0,3.0],[5.0,62.0,5.0],[5.0,104.0,2.0],[5.0,110.0,4.0],[5.0,140.0,2.0],[5.0,141.0,5.0],[5.0,150.0,5.0],[5.0,224.0,2.0],[5.0,235.0,3.0],[5.0,260.0,5.0],[5.0,282.0,4.0],[5.0,316.0,4.0],[5.0,318.0,5.0],[5.0,350.0,4.0],[5.0,364.0,5.0],[5.0,367.0,3.0],[5.0,368.0,5.0],[5.0,370.0,4.0],[5.0,376.0,4.0],[5.0,377.0,5.0],[5.0,380.0,5.0],[5.0,440.0,5.0],[5.0,454.0,5.0],[5.0,457.0,5.0],[5.0,475.0,4.0],[5.0,480.0,4.0],[5.0,491.0,4.0],[5.0,500.0,5.0],[5.0,508.0,5.0],[5.0,515.0,3.0],[5.0,529.0,4.0],[5.0,531.0,5.0],[5.0,587.0,4.0],[5.0,588.0,5.0],[5.0,589.0,5.0],[5.0,590.0,5.0],[5.0,593.0,3.0],[5.0,594.0,5.0],[5.0,595.0,5.0],[5.0,608.0,3.0],[5.0,631.0,3.0],[5.0,648.0,3.0],[5.0,671.0,5.0],[5.0,708.0,3.0],[5.0,720.0,5.0],[5.0,736.0,5.0],[5.0,780.0,5.0],[5.0,788.0,3.0],[5.0,832.0,5.0],[5.0,1028.0,5.0],[5.0,1035.0,5.0],[5.0,1036.0,5.0],[5.0,1042.0,4.0],[5.0,1073.0,2.0],[5.0,1079.0,5.0],[5.0,1080.0,5.0],[5.0,1097.0,5.0],[5.0,1136.0,5.0],[5.0,1196.0,5.0],[5.0,1198.0,5.0],[5.0,1210.0,5.0],[5.0,1291.0,5.0],[5.0,1393.0,5.0],[6.0,1.0,5.0],[6.0,3.0,3.0],[6.0,7.0,5.0],[6.0,17.0,5.0],[6.0,52.0,5.0],[6.0,62.0,5.0],[6.0,135.0,3.0],[6.0,140.0,4.0],[6.0,141.0,5.0],[6.0,260.0,4.0],[6.0,494.0,4.0],[6.0,628.0,4.0],[6.0,648.0,5.0],[6.0,653.0,4.0],[6.0,708.0,4.0],[6.0,719.0,3.0],[6.0,733.0,3.0],[6.0,736.0,2.0],[6.0,743.0,3.0],[6.0,762.0,3.0],[6.0,780.0,3.0],[6.0,788.0,4.0],[6.0,802.0,3.0],[6.0,1073.0,1.0],[7.0,3.0,3.0],[7.0,7.0,3.0],[7.0,11.0,4.0],[7.0,15.0,2.0],[7.0,16.0,3.0],[7.0,17.0,2.0],[7.0,24.0,3.0],[7.0,105.0,2.0],[7.0,122.0,2.0],[7.0,151.0,3.0],[7.0,252.0,2.0],[7.0,260.0,5.0],[7.0,271.0,3.0],[7.0,276.0,2.0],[7.0,316.0,3.0],[7.0,339.0,3.0],[7.0,348.0,4.0],[7.0,351.0,3.0],[7.0,355.0,3.0],[7.0,356.0,4.0],[7.0,357.0,3.0],[7.0,362.0,3.0],[7.0,364.0,4.0],[7.0,377.0,3.0],[7.0,425.0,3.0],[7.0,440.0,4.0],[7.0,480.0,5.0],[7.0,509.0,2.0],[7.0,539.0,4.0],[7.0,553.0,4.0],[7.0,587.0,5.0],[7.0,589.0,5.0],[7.0,590.0,4.0],[7.0,597.0,4.0],[7.0,674.0,2.0],[7.0,708.0,3.0],[7.0,736.0,3.0],[7.0,750.0,5.0],[7.0,780.0,4.0],[7.0,788.0,3.0],[7.0,806.0,1.0],[7.0,852.0,3.0],[7.0,880.0,3.0],[7.0,899.0,4.0],[7.0,908.0,4.0],[7.0,912.0,5.0],[7.0,914.0,3.0],[7.0,920.0,4.0],[7.0,922.0,3.0],[7.0,924.0,3.0],[7.0,928.0,3.0],[7.0,932.0,3.0],[7.0,952.0,3.0],[7.0,1017.0,4.0],[7.0,1020.0,3.0],[7.0,1077.0,5.0],[7.0,1094.0,3.0],[7.0,1095.0,1.0],[7.0,1097.0,4.0],[7.0,1101.0,3.0],[7.0,1183.0,3.0],[7.0,1196.0,5.0],[7.0,1206.0,2.0],[7.0,1210.0,5.0],[7.0,1230.0,3.0],[7.0,1247.0,4.0],[7.0,1253.0,4.0],[7.0,1256.0,5.0],[7.0,1259.0,3.0],[7.0,1265.0,4.0],[7.0,1270.0,4.0],[7.0,1271.0,4.0],[7.0,1272.0,4.0],[7.0,1301.0,3.0],[7.0,1307.0,3.0],[7.0,1343.0,3.0],[7.0,1357.0,4.0],[7.0,1385.0,4.0],[7.0,1391.0,2.0],[7.0,1393.0,3.0],[7.0,1408.0,3.0],[7.0,1409.0,2.0],[7.0,1441.0,3.0],[7.0,1449.0,4.0],[7.0,1466.0,3.0],[7.0,1513.0,2.0],[7.0,1517.0,3.0],[7.0,1544.0,4.0],[7.0,1573.0,3.0],[7.0,1580.0,3.0],[7.0,1597.0,3.0],[7.0,1617.0,3.0],[7.0,1674.0,4.0],[7.0,1682.0,2.0],[7.0,1721.0,5.0],[7.0,1777.0,4.0],[7.0,1882.0,3.0],[7.0,1888.0,3.0],[7.0,1894.0,3.0],[7.0,1911.0,4.0],[7.0,1917.0,4.0],[7.0,1932.0,3.0],[7.0,1964.0,3.0],[7.0,2011.0,4.0],[7.0,2012.0,4.0],[7.0,2013.0,3.0],[7.0,2018.0,4.0],[7.0,2028.0,5.0],[7.0,2054.0,3.0],[7.0,2067.0,3.0],[7.0,2080.0,4.0],[7.0,2081.0,3.0],[7.0,2108.0,3.0],[7.0,2112.0,3.0],[7.0,2125.0,3.0],[7.0,2146.0,3.0],[7.0,2195.0,2.0],[7.0,2243.0,3.0],[7.0,2266.0,2.0],[7.0,2297.0,3.0],[7.0,2311.0,3.0],[7.0,2316.0,3.0],[7.0,2333.0,3.0],[7.0,2346.0,3.0],[7.0,2363.0,3.0],[7.0,2367.0,3.0],[7.0,2384.0,3.0],[7.0,2385.0,2.0],[7.0,2390.0,4.0],[7.0,2396.0,3.0],[7.0,2403.0,4.0],[7.0,2405.0,4.0],[7.0,2407.0,4.0],[7.0,2424.0,3.0],[7.0,2427.0,3.0],[7.0,2463.0,4.0],[7.0,2468.0,2.0],[7.0,2469.0,3.0],[7.0,2478.0,2.0],[7.0,2498.0,2.0],[7.0,2529.0,4.0],[7.0,2535.0,3.0],[7.0,2546.0,3.0],[7.0,2558.0,3.0],[7.0,2598.0,3.0],[7.0,2628.0,4.0],[7.0,2633.0,3.0],[7.0,2640.0,4.0],[7.0,2641.0,4.0],[7.0,2642.0,3.0],[7.0,2654.0,4.0],[7.0,2657.0,2.0],[7.0,2664.0,4.0],[7.0,2671.0,4.0],[7.0,2683.0,3.0],[7.0,2694.0,3.0],[7.0,2701.0,3.0],[7.0,2716.0,4.0],[7.0,2722.0,3.0],[7.0,2723.0,3.0],[7.0,2734.0,2.0],[7.0,2752.0,4.0],[7.0,2762.0,5.0],[7.0,2770.0,2.0],[7.0,2858.0,3.0],[7.0,2861.0,3.0],[7.0,2881.0,4.0],[7.0,2908.0,4.0],[7.0,2916.0,3.0],[7.0,2942.0,5.0],[7.0,2950.0,3.0],[7.0,2959.0,4.0],[7.0,2968.0,2.0],[7.0,2987.0,4.0],[7.0,2993.0,4.0],[7.0,3004.0,2.0],[7.0,3032.0,2.0],[7.0,3033.0,2.0],[7.0,3037.0,4.0],[7.0,3039.0,3.0],[7.0,3062.0,3.0],[7.0,3074.0,3.0],[7.0,3081.0,2.0],[7.0,3086.0,4.0],[7.0,3103.0,2.0],[7.0,3108.0,3.0],[7.0,3118.0,3.0],[7.0,3156.0,3.0],[7.0,3175.0,2.0],[7.0,3176.0,2.0],[7.0,3179.0,5.0],[7.0,3185.0,3.0],[7.0,3194.0,4.0],[7.0,3199.0,2.0],[7.0,3219.0,2.0],[7.0,3235.0,3.0],[7.0,3244.0,3.0],[7.0,3334.0,3.0],[7.0,3341.0,4.0],[7.0,3354.0,3.0],[7.0,3363.0,4.0],[7.0,3408.0,4.0],[7.0,3417.0,5.0],[7.0,3448.0,4.0],[7.0,3469.0,4.0],[7.0,3479.0,5.0],[7.0,3501.0,3.0],[7.0,3510.0,4.0],[7.0,3512.0,4.0],[7.0,3524.0,4.0],[7.0,3526.0,3.0],[7.0,3527.0,3.0],[7.0,3528.0,2.0],[7.0,3578.0,5.0],[7.0,3593.0,2.0],[7.0,3671.0,4.0],[7.0,3684.0,3.0],[7.0,3699.0,4.0],[7.0,3701.0,3.0],[7.0,3717.0,2.0],[7.0,3753.0,4.0],[7.0,3754.0,2.0],[7.0,3793.0,4.0],[7.0,3798.0,2.0],[7.0,3824.0,2.0],[7.0,3826.0,4.0],[7.0,3827.0,3.0],[7.0,3844.0,3.0],[7.0,3864.0,3.0],[7.0,3911.0,4.0],[7.0,3926.0,3.0],[7.0,3932.0,4.0],[7.0,3959.0,4.0],[7.0,3977.0,4.0],[7.0,3978.0,3.0],[7.0,3987.0,4.0],[7.0,3988.0,4.0],[7.0,3994.0,3.0],[7.0,4018.0,3.0],[7.0,4019.0,4.0],[7.0,4023.0,3.0],[7.0,4041.0,4.0],[7.0,4062.0,3.0],[7.0,4155.0,3.0],[7.0,4186.0,4.0],[7.0,4270.0,3.0],[7.0,4306.0,5.0],[7.0,4308.0,4.0],[7.0,4310.0,3.0],[7.0,4317.0,3.0],[7.0,4339.0,4.0],[7.0,4349.0,3.0],[7.0,4361.0,3.0],[7.0,4368.0,3.0],[7.0,4370.0,2.0],[7.0,4464.0,2.0],[7.0,4503.0,3.0],[7.0,4545.0,4.0],[7.0,4603.0,2.0],[7.0,4626.0,4.0],[7.0,4638.0,4.0],[7.0,4639.0,2.0],[7.0,4643.0,4.0],[7.0,4661.0,2.0],[7.0,4700.0,3.0],[7.0,4736.0,3.0],[7.0,4799.0,5.0],[7.0,4848.0,1.0],[7.0,4867.0,4.0],[7.0,4874.0,4.0],[7.0,4896.0,3.0],[7.0,4963.0,5.0],[7.0,4993.0,4.0],[7.0,4994.0,4.0],[7.0,4995.0,3.0],[7.0,5009.0,3.0],[8.0,1.0,4.0],[8.0,3.0,5.0],[8.0,6.0,3.0],[8.0,10.0,4.0],[8.0,19.0,1.0],[8.0,21.0,4.0],[8.0,39.0,3.0],[8.0,47.0,5.0],[8.0,48.0,4.0],[8.0,110.0,5.0],[8.0,150.0,4.0],[8.0,153.0,3.0],[8.0,161.0,4.0],[8.0,165.0,3.0],[8.0,168.0,3.0],[8.0,172.0,1.0],[8.0,173.0,3.0],[8.0,185.0,2.0],[8.0,207.0,4.0],[8.0,208.0,3.0],[8.0,231.0,3.0],[8.0,236.0,4.0],[8.0,253.0,4.0],[8.0,266.0,5.0],[8.0,276.0,3.0],[8.0,277.0,4.0],[8.0,288.0,5.0],[8.0,292.0,4.0],[8.0,296.0,5.0],[8.0,316.0,2.0],[8.0,329.0,3.0],[8.0,338.0,2.0],[8.0,339.0,4.0],[8.0,344.0,3.0],[8.0,349.0,5.0],[8.0,350.0,4.0],[8.0,353.0,3.0],[8.0,355.0,2.0],[8.0,356.0,5.0],[8.0,357.0,4.0],[8.0,364.0,4.0],[8.0,367.0,3.0],[8.0,372.0,4.0],[8.0,377.0,4.0],[8.0,380.0,4.0],[8.0,381.0,4.0],[8.0,434.0,5.0],[8.0,442.0,4.0],[8.0,454.0,4.0],[8.0,457.0,5.0],[8.0,480.0,4.0],[8.0,500.0,4.0],[8.0,508.0,3.0],[8.0,527.0,5.0],[8.0,539.0,4.0],[8.0,550.0,4.0],[8.0,551.0,4.0],[8.0,552.0,3.0],[8.0,553.0,5.0],[8.0,587.0,4.0],[8.0,588.0,3.0],[8.0,589.0,5.0],[8.0,590.0,5.0],[8.0,592.0,4.0],[8.0,593.0,5.0],[8.0,595.0,3.0],[8.0,597.0,5.0],[8.0,610.0,4.0],[8.0,648.0,5.0],[8.0,733.0,4.0],[9.0,356.0,4.0],[9.0,858.0,5.0],[9.0,1219.0,3.0],[9.0,1911.0,3.0],[9.0,1923.0,4.0],[9.0,1997.0,5.0],[9.0,2279.0,3.0],[9.0,2605.0,2.0],[9.0,2683.0,3.0],[9.0,2688.0,3.0],[9.0,2706.0,4.0],[9.0,2710.0,3.0],[9.0,2719.0,2.0],[9.0,2722.0,2.0],[9.0,2840.0,3.0],[9.0,2841.0,4.0],[9.0,2959.0,5.0],[9.0,3016.0,2.0],[9.0,3785.0,2.0],[9.0,3798.0,5.0],[9.0,3857.0,3.0],[9.0,3908.0,2.0],[9.0,3979.0,3.0],[9.0,3994.0,3.0],[9.0,3999.0,2.0],[9.0,4022.0,4.0],[9.0,4030.0,2.0],[9.0,4034.0,1.0],[9.0,4148.0,5.0],[9.0,4369.0,4.0],[9.0,4483.0,2.0],[9.0,4502.0,1.0],[9.0,4509.0,3.0],[9.0,4519.0,2.0],[9.0,4533.0,3.0],[10.0,1.0,4.0],[10.0,11.0,4.0],[10.0,25.0,4.0],[10.0,260.0,4.0],[10.0,356.0,3.0],[10.0,527.0,5.0],[10.0,858.0,5.0],[10.0,912.0,4.0],[10.0,969.0,4.0],[10.0,1094.0,3.0],[10.0,1136.0,4.0],[10.0,1196.0,4.0],[10.0,1198.0,4.0],[10.0,1204.0,3.0],[10.0,1208.0,4.0],[10.0,1210.0,4.0],[10.0,1221.0,5.0],[10.0,1222.0,3.0],[10.0,1230.0,4.0],[10.0,1240.0,4.0],[10.0,1242.0,4.0],[10.0,1247.0,5.0],[10.0,1250.0,4.0],[10.0,1304.0,3.0],[10.0,1387.0,5.0],[10.0,1721.0,4.0],[10.0,1960.0,3.0],[10.0,2028.0,4.0],[10.0,2058.0,3.0],[10.0,2194.0,4.0],[10.0,2384.0,4.0],[10.0,2529.0,3.0],[10.0,2657.0,4.0],[10.0,2797.0,4.0],[10.0,2944.0,4.0],[10.0,2948.0,4.0],[10.0,3062.0,4.0],[10.0,3107.0,3.0],[11.0,1.0,4.5],[11.0,10.0,2.5],[11.0,19.0,3.5],[11.0,32.0,5.0],[11.0,39.0,4.5],[11.0,65.0,2.0],[11.0,110.0,4.0],[11.0,145.0,3.0],[11.0,150.0,5.0],[11.0,153.0,3.5],[11.0,158.0,4.0],[11.0,160.0,4.0],[11.0,165.0,4.0],[11.0,170.0,5.0],[11.0,172.0,5.0],[11.0,173.0,5.0],[11.0,185.0,4.0],[11.0,208.0,4.5],[11.0,231.0,4.0],[11.0,253.0,4.5],[11.0,256.0,5.0],[11.0,260.0,5.0],[11.0,286.0,0.5],[11.0,296.0,3.5],[11.0,316.0,3.5],[11.0,318.0,5.0],[11.0,344.0,3.5],[11.0,356.0,5.0],[11.0,364.0,4.0],[11.0,367.0,4.0],[11.0,377.0,4.0],[11.0,380.0,5.0],[11.0,384.0,3.5],[11.0,405.0,3.5],[11.0,410.0,4.0],[11.0,441.0,1.5],[11.0,442.0,4.5],[11.0,480.0,5.0],[11.0,500.0,4.5],[11.0,519.0,1.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"userId","type":"\"integer\""},{"name":"movieId","type":"\"integer\""},{"name":"rating","type":"\"double\""}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.473120791496E12,"submitTime":1.473120738354E12,"finishTime":1.473120791635E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4fec9b75-aa08-49c3-a0c3-f0a9f6012a88"},{"version":"CommandV1","origId":36148146263654,"guid":"f1400574-c3e2-4241-ab24-69a5c22ca027","subtype":"command","commandType":"auto","position":18.0,"command":"%md\n## Part 1: Basic Recommendations\n\nOne way to recommend movies is to always recommend the movies with the highest average rating. In this part, we will use Spark to find the name, number of ratings, and the average rating of the 20 movies with the highest average rating and more than 500 reviews. We want to filter our movies with high ratings but greater than or equal to 500 reviews because movies with few reviews may not have broad appeal to everyone.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738375E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2aadec38-36be-4894-ad31-b2c193a39b4a"},{"version":"CommandV1","origId":36148146263655,"guid":"bc309aad-c221-4440-8f72-0c5f7d6b4bc9","subtype":"command","commandType":"auto","position":19.0,"command":"%md\n### (1a) Movies with Highest Average Ratings\n\nNow that we have a way to calculate the average ratings, we will use the `getCountsAndAverages()` helper function with Spark to determine the movies with the highest average ratings.\n\nThe steps you should perform are:\n\n1. Recall that the `ratings_df` contains three columns:\n    - The ID of the user who rated the film\n    - the ID of the movie being rated\n    - and the rating.\n\n   First, transform `ratings_df` into a second DataFrame, `movie_ids_with_avg_ratings`, with the following columns:\n    - The movie ID\n    - The number of ratings for the movie\n    - The average of all the movie's ratings\n\n2. Transform `movie_ids_with_avg_ratings` to another DataFrame, `movie_names_with_avg_ratings_df` that adds the movie name to each row. `movie_names_with_avg_ratings_df`\n   will contain these columns:\n    - The movie ID\n    - The movie name\n    - The number of ratings for the movie\n    - The average of all the movie's ratings\n\n   **Hint**: You'll need to do a join.\n\nYou should end up with something like the following:\n```\nmovie_ids_with_avg_ratings_df:\n+-------+-----+------------------+\n|movieId|count|average           |\n+-------+-----+------------------+\n|1831   |7463 |2.5785207021305103|\n|431    |8946 |3.695059244355019 |\n|631    |2193 |2.7273141814865483|\n+-------+-----+------------------+\nonly showing top 3 rows\n\nmovie_names_with_avg_ratings_df:\n+-------+-----------------------------+-----+-------+\n|average|title                        |count|movieId|\n+-------+-----------------------------+-----+-------+\n|5.0    |Ella Lola, a la Trilby (1898)|1    |94431  |\n|5.0    |Serving Life (2011)          |1    |129034 |\n|5.0    |Diplomatic Immunity (2009? ) |1    |107434 |\n+-------+-----------------------------+-----+-------+\nonly showing top 3 rows\n```","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738399E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"09d402d0-e2d7-4b16-937c-a6351aabd52f"},{"version":"CommandV1","origId":36148146263656,"guid":"60cf9569-4a95-42d4-bb8b-f0e738ecb25e","subtype":"command","commandType":"auto","position":19.25,"command":"%md \n**My Note**  \n\ngroupData.agg(*exprs)\n\nagg(*exprs)  \n  Compute aggregates and returns the result as a DataFrame.\n\n  The available aggregate functions are avg, max, min, sum, count.\n\n  If exprs is a single dict mapping from string to string, then the key is the column to perform aggregation on, and the value is the aggregate function.\n\n  Alternatively, exprs can also be a list of aggregate Column expressions.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738419E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c2f6e68c-0458-42b5-9894-7885f0c63e6a"},{"version":"CommandV1","origId":36148146263657,"guid":"91e9efa9-8142-4f8c-9cc6-d9267c986982","subtype":"command","commandType":"auto","position":19.5,"command":"# If use dict mapping, it can not change column name\n# If you want to change column name, you need do it\n# outside the agg() with other DataFrame methods\n(ratings_df.groupBy('movieId')\n   .agg({'movieId':'count', 'rating':'avg'})\n   .show(2))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------+------------------+--------------+\n|movieId|       avg(rating)|count(movieId)|\n+-------+------------------+--------------+\n|   1831|2.5785207021305103|          7463|\n|    431| 3.695059244355019|          8946|\n+-------+------------------+--------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AssertionError</span>: all exprs should be Column","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AssertionError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-9-4152e48f0f7d&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\"># my version</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> (ratings_df.groupBy(&apos;movieID&apos;)\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\">    </span><span class=\"ansiyellow\">.</span>agg<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;count(&apos;movieID&apos;).alias(&apos;count&apos;)&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;avg(&apos;rating&apos;).alias(&apos;average&apos;)&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span>    .show())\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/group.py</span> in <span class=\"ansicyan\">agg</span><span class=\"ansiblue\">(self, *exprs)</span>\n<span class=\"ansigreen\">     87</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     88</span>             <span class=\"ansired\"># Columns</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 89</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">assert</span> all<span class=\"ansiyellow\">(</span>isinstance<span class=\"ansiyellow\">(</span>c<span class=\"ansiyellow\">,</span> Column<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">for</span> c <span class=\"ansigreen\">in</span> exprs<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;all exprs should be Column&quot;</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     90</span>             jdf = self._jdf.agg(exprs[0]._jc,\n<span class=\"ansigreen\">     91</span>                                 _to_seq(self.sql_ctx._sc, [c._jc for c in exprs[1:]]))\n\n<span class=\"ansired\">AssertionError</span>: all exprs should be Column\n</div>","workflows":[],"startTime":1.473120791676E12,"submitTime":1.473120738443E12,"finishTime":1.473120793716E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6e757979-7bbd-4b55-9c2b-3b87c4d9fd98"},{"version":"CommandV1","origId":36148146263658,"guid":"c2ce4b14-34bc-4cf0-b1ed-afd5d77b6c84","subtype":"command","commandType":"auto","position":19.75,"command":"# So the preferred methods is using list of aggregate Column expressions\nfrom pyspark.sql import functions as F\n(ratings_df.groupBy('movieId')\n   .agg(F.count(F.col('movieId')).alias('count'),F.avg(F.col('rating')).alias('average'))\n   .show(2))\n# or you can reference a Column using ratings_df['movieId']","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------+-----+------------------+\n|movieId|count|           average|\n+-------+-----+------------------+\n|   1831| 7463|2.5785207021305103|\n|    431| 8946| 3.695059244355019|\n+-------+-----+------------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;col&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-12-62fe1f5cbd02&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>sql <span class=\"ansigreen\">import</span> functions <span class=\"ansigreen\">as</span> F<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> (ratings_df.groupBy(&apos;movieId&apos;)\n<span class=\"ansigreen\">----&gt; 4</span><span class=\"ansiyellow\">    </span><span class=\"ansiyellow\">.</span>agg<span class=\"ansiyellow\">(</span>F<span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">(</span>col<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;movieId&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>alias<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;count&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>F<span class=\"ansiyellow\">.</span>avg<span class=\"ansiyellow\">(</span>col<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;rating&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>alias<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;average&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span>    .show(2))\n\n<span class=\"ansired\">NameError</span>: name &apos;col&apos; is not defined\n</div>","workflows":[],"startTime":1.473120793725E12,"submitTime":1.473120738459E12,"finishTime":1.473120795646E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e7cb9f94-c72f-4d0d-ad28-55799eb6083a"},{"version":"CommandV1","origId":36148146263659,"guid":"ded86c90-8971-4ee1-bcb9-04a3a67f492c","subtype":"command","commandType":"auto","position":20.0,"command":"from pyspark.sql import functions as F\n\n# From ratingsDF, create a movie_ids_with_avg_ratings_df that combines the two DataFrames\nmovie_ids_with_avg_ratings_df = ratings_df.groupBy('movieId').agg(F.count(ratings_df.rating).alias(\"count\"), F.avg(ratings_df.rating).alias(\"average\"))\nprint 'movie_ids_with_avg_ratings_df:'\nmovie_ids_with_avg_ratings_df.show(3, truncate=False)\n\n# Note: movie_names_df is a temporary variable, used only to separate the steps necessary\n# to create the movie_names_with_avg_ratings_df DataFrame.\nmovie_names_df = movie_ids_with_avg_ratings_df.join(movies_df, movies_df.ID == movie_ids_with_avg_ratings_df.movieId)\nmovie_names_with_avg_ratings_df = movie_names_df.drop('ID')\n\nprint 'movie_names_with_avg_ratings_df:'\nmovie_names_with_avg_ratings_df.show(3, truncate=False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">movie_ids_with_avg_ratings_df:\n+-------+-----+------------------+\n|movieId|count|average           |\n+-------+-----+------------------+\n|1831   |7463 |2.5785207021305103|\n|431    |8946 |3.695059244355019 |\n|631    |2193 |2.7273141814865483|\n+-------+-----+------------------+\nonly showing top 3 rows\n\nmovie_names_with_avg_ratings_df:\n+-------+-----+------------------+------------------------------+\n|movieId|count|average           |title                         |\n+-------+-----+------------------+------------------------------+\n|1831   |7463 |2.5785207021305103|Lost in Space (1998)          |\n|431    |8946 |3.695059244355019 |Carlito&apos;s Way (1993)          |\n|631    |2193 |2.7273141814865483|All Dogs Go to Heaven 2 (1996)|\n+-------+-----+------------------+------------------------------+\nonly showing top 3 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.473120795657E12,"submitTime":1.473120738473E12,"finishTime":1.473120799418E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dfa12e78-dbf7-4378-81fb-55842ecc33b1"},{"version":"CommandV1","origId":36148146263660,"guid":"bf8f7e16-bc36-456a-a18c-9e1996e79b91","subtype":"command","commandType":"auto","position":21.0,"command":"# TEST Movies with Highest Average Ratings (1a)\nTest.assertEquals(movie_ids_with_avg_ratings_df.count(), 26744,\n                'incorrect movie_ids_with_avg_ratings_df.count() (expected 26744)')\nmovie_ids_with_ratings_take_ordered = movie_ids_with_avg_ratings_df.orderBy('MovieID').take(3)\n_take_0 = movie_ids_with_ratings_take_ordered[0]\n_take_1 = movie_ids_with_ratings_take_ordered[1]\n_take_2 = movie_ids_with_ratings_take_ordered[2]\nTest.assertTrue(_take_0[0] == 1 and _take_0[1] == 49695,\n                'incorrect count of ratings for movie with ID {0} (expected 49695)'.format(_take_0[0]))\nTest.assertEquals(round(_take_0[2], 2), 3.92, \"Incorrect average for movie ID {0}. Expected 3.92\".format(_take_0[0]))\n\nTest.assertTrue(_take_1[0] == 2 and _take_1[1] == 22243,\n                'incorrect count of ratings for movie with ID {0} (expected 22243)'.format(_take_1[0]))\nTest.assertEquals(round(_take_1[2], 2), 3.21, \"Incorrect average for movie ID {0}. Expected 3.21\".format(_take_1[0]))\n\nTest.assertTrue(_take_2[0] == 3 and _take_2[1] == 12735,\n                'incorrect count of ratings for movie with ID {0} (expected 12735)'.format(_take_2[0]))\nTest.assertEquals(round(_take_2[2], 2), 3.15, \"Incorrect average for movie ID {0}. Expected 3.15\".format(_take_2[0]))\n\n\nTest.assertEquals(movie_names_with_avg_ratings_df.count(), 26744,\n                  'incorrect movie_names_with_avg_ratings_df.count() (expected 26744)')\nmovie_names_with_ratings_take_ordered = movie_names_with_avg_ratings_df.orderBy(['average', 'title']).take(3)\nresult = [(r['average'], r['title'], r['count'], r['movieId']) for r in movie_names_with_ratings_take_ordered]\nTest.assertEquals(result,\n                  [(0.5, u'13 Fighting Men (1960)', 1, 109355),\n                   (0.5, u'20 Years After (2008)', 1, 131062),\n                   (0.5, u'3 Holiday Tails (Golden Christmas 2: The Second Tail, A) (2011)', 1, 111040)],\n                  'incorrect top 3 entries in movie_names_with_avg_ratings_df')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47312079944E12,"submitTime":1.473120738487E12,"finishTime":1.473120832418E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8c702a49-5405-4d1f-9eae-06cd93021202"},{"version":"CommandV1","origId":36148146263661,"guid":"00b1b3a9-bfab-47a7-9031-4c0fc0a6e434","subtype":"command","commandType":"auto","position":22.0,"command":"%md\n### (1b) Movies with Highest Average Ratings and more than 500 reviews\n\nNow that we have a DataFrame of the movies with highest average ratings, we can use Spark to determine the 20 movies with highest average ratings and more than 500 reviews.\n\nAdd a single DataFrame transformation (in place of `<FILL_IN>`, below) to limit the results to movies with ratings from more than 500 people.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.4731207385E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5fa6083e-f092-49aa-87db-3fca8bc915b4"},{"version":"CommandV1","origId":36148146263662,"guid":"d4cac447-b233-4a22-a2da-037f58b45b06","subtype":"command","commandType":"auto","position":22.5,"command":"display(movie_names_with_avg_ratings_df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1831.0,7463.0,2.5785207021305103,"Lost in Space (1998)"],[431.0,8946.0,3.695059244355019,"Carlito's Way (1993)"],[631.0,2193.0,2.7273141814865483,"All Dogs Go to Heaven 2 (1996)"],[231.0,32085.0,2.9524700015583605,"Dumb & Dumber (Dumb and Dumber) (1994)"],[32031.0,1777.0,3.270962296004502,"Robots (2005)"],[45431.0,2059.0,3.416221466731423,"Over the Hedge (2006)"],[2231.0,6759.0,3.727400503032993,"Rounders (1998)"],[2431.0,6045.0,3.109677419354839,"Patch Adams (1998)"],[4031.0,1047.0,2.89207258834766,"All the Pretty Horses (2000)"],[31.0,9435.0,3.250344462109168,"Dangerous Minds (1995)"],[1231.0,7902.0,3.9474816502151353,"Right Stuff, The (1983)"],[3831.0,1564.0,3.6620843989769822,"Saving Grace (2000)"],[27831.0,2883.0,3.7835587929240373,"Layer Cake (2004)"],[1031.0,4227.0,3.329548142890939,"Bedknobs and Broomsticks (1971)"],[4231.0,996.0,3.0737951807228914,"Someone Like You (2001)"],[1431.0,2931.0,2.571989082224497,"Beverly Hills Ninja (1997)"],[3031.0,348.0,2.2485632183908044,"Repossessed (1990)"],[6631.0,99.0,2.282828282828283,"Man's Best Friend (1993)"],[8831.0,327.0,2.8700305810397553,"Suspect Zero (2004)"],[2831.0,83.0,2.6686746987951806,"Dog of Flanders, A (1999)"],[4631.0,53.0,2.7452830188679247,"Old Gringo (1989)"],[5431.0,142.0,3.0246478873239435,"Goin' South (1978)"],[39231.0,1097.0,3.1180492251595258,"Elizabethtown (2005)"],[1631.0,480.0,3.44375,"Assignment, The (1997)"],[7831.0,336.0,3.8779761904761907,"Another Thin Man (1939)"],[56631.0,11.0,3.5,"Densha otoko (Train Man) (2005)"],[80831.0,581.0,3.621342512908778,"Let Me In (2010)"],[5231.0,215.0,3.432558139534884,"Road to Morocco (1942)"],[6031.0,307.0,3.688925081433225,"Imitation of Life (1959)"],[46231.0,17.0,2.264705882352941,"Stoned (2005)"],[41831.0,66.0,3.303030303030303,"They Died with Their Boots On (1941)"],[115231.0,131.0,3.5381679389312977,"St. Vincent (2014)"],[93831.0,279.0,3.1792114695340503,"American Reunion (American Pie 4) (2012)"],[2031.0,256.0,2.619140625,"Million Dollar Duck, The (a.k.a. $1,000,000 Duck) (1971)"],[3431.0,474.0,2.4082278481012658,"Death Wish 2 (1982)"],[55031.0,291.0,3.754295532646048,"Evening with Kevin Smith, An (2002)"],[64231.0,263.0,2.76425855513308,"Punisher: War Zone (2008)"],[26631.0,117.0,3.576923076923077,"Alice (Neco z Alenky) (1988)"],[27631.0,13.0,2.923076923076923,"Cremaster 3 (2002)"],[48231.0,104.0,3.4375,"Taxidermia (2006)"],[4831.0,117.0,2.0982905982905984,"Can't Stop the Music (1980)"],[65631.0,77.0,3.292207792207792,"Battle in Seattle (2007)"],[2631.0,36.0,1.6805555555555556,"Frogs for Snakes (1998)"],[5631.0,21.0,2.5,"Between Strangers (2002)"],[31431.0,368.0,2.0652173913043477,"Boogeyman (2005)"],[73431.0,54.0,2.9166666666666665,"Maiden Heist, The (2009)"],[7031.0,136.0,2.5919117647058822,"Real McCoy, The (1993)"],[6231.0,121.0,3.3636363636363638,"Benny Goodman Story, The (1955)"],[6431.0,40.0,3.0,"Battle Cry (1955)"],[5031.0,34.0,3.2794117647058822,"Maria's Lovers (1984)"],[91831.0,54.0,2.2962962962962963,"Devil Inside, The (2012)"],[7231.0,32.0,2.9375,"Where Angels Go, Trouble Follows (1968)"],[831.0,221.0,3.5316742081447963,"Stonewall (1995)"],[3631.0,33.0,3.121212121212121,"It's in the Water (1998)"],[8631.0,79.0,3.329113924050633,"Hard Times (1975)"],[26231.0,132.0,3.746212121212121,"Performance (1970)"],[26831.0,18.0,3.2222222222222223,"Night We Never Met, The (1993)"],[104231.0,27.0,3.4074074074074074,"Drug War (Du zhan) (2012)"],[68831.0,10.0,3.15,"Ghosts of Cité Soleil (2006)"],[74431.0,26.0,3.826923076923077,"Takva: A Man's Fear of God (2006)"],[40831.0,5.0,3.3,"My Mother's Smile (a.k.a. The Religion Hour) (L'ora di religione) (Il sorriso di mia madre) (2002)"],[27031.0,11.0,3.4545454545454546,"Wavelength (1967)"],[4431.0,47.0,3.372340425531915,"Rembrandt (1936)"],[3231.0,18.0,2.888888888888889,"Saphead, The (1920)"],[113831.0,1.0,3.5,"Passenger Side (2009)"],[52831.0,44.0,3.1363636363636362,"Maniac Cop (1988)"],[70831.0,9.0,3.5,"Krakatoa: The Last Days (2006)"],[27431.0,11.0,3.5,"Adversary, The (L'adversaire) (2002)"],[81031.0,12.0,3.5,"Worlds Apart (To verdener) (2008)"],[121231.0,15.0,3.7333333333333334,"It Follows (2014)"],[25831.0,16.0,3.5625,"These Three (1936)"],[102231.0,19.0,3.6052631578947367,"Dragon (Wu Xia) (2011)"],[69231.0,8.0,3.1875,"Snug as a Bug (U Pana Boga za piecem) (1998)"],[73831.0,7.0,3.0,"Mall Girls (Galerianki) (2009)"],[110431.0,2.0,2.25,"Girl from the Naked Eye, The (2012)"],[104631.0,35.0,3.085714285714286,"Adore (2013)"],[98631.0,4.0,3.25,"Day He Arrives, The (Book chon bang hyang) (2011)"],[26431.0,48.0,3.6770833333333335,"Opening Night (1977)"],[116231.0,2.0,2.75,"Confessions of an Opium Eater (1962)"],[97031.0,4.0,3.0,"Goke, Body Snatcher from Hell (Kyuketsuki Gokemidoro) (1968)"],[78631.0,6.0,1.75,"Shark in Venice (2008)"],[101431.0,3.0,3.5,"Christine Jorgensen Story, The (1970)"],[104031.0,1.0,3.5,"Fred & Vinnie (2011)"],[5831.0,11.0,2.6818181818181817,"Soul Assassin (2001)"],[75831.0,8.0,2.1875,"Hollywood Revue of 1929, The (1929)"],[85231.0,4.0,3.25,"Twenty-Four Eyes (Nijûshi no hitomi) (1954)"],[92231.0,1.0,3.5,"Blue Bird, The (1918)"],[77231.0,3.0,2.5,"Hell Is Sold Out (1951)"],[81631.0,4.0,2.75,"Trail of the Screaming Forehead (2007)"],[6831.0,11.0,2.227272727272727,"Nobody's Baby (2001)"],[127031.0,1.0,3.0,"Pizzas (2012)"],[116831.0,2.0,3.75,"Give 'em Hell, Malone (2009)"],[121831.0,1.0,3.5,"The Seventh Sin (1957)"],[131031.0,1.0,3.0,"La liga no es cosa de hombres (1972)"],[115631.0,1.0,0.5,"Alone for Christmas (2013)"],[115831.0,1.0,3.5,"Serial Killer Culture (2014)"],[59031.0,7.0,3.357142857142857,"Private Property (Nue propriété) (2006)"],[114631.0,3.0,4.0,"Koumiko Mystery, The (Mystère Koumiko, Le) (1967)"],[104431.0,8.0,2.6875,"Enter Nowhere (2011)"],[121031.0,1.0,0.5,"Santos (2008)"],[127831.0,1.0,3.5,"Tintin and I (2003)"],[87831.0,2.0,2.5,"Marie-Jo and Her 2 Lovers (Marie-Jo et ses 2 amours) (2002)"],[73031.0,2.0,2.25,"Too Shy to Try (Je suis timide... mais je me soigne) (1978)"],[77831.0,2.0,3.5,"Fine, Totally Fine (Zenzen Daijobu) (2008)"],[82631.0,3.0,3.5,"Duelist (Hyeongsa) (2005)"],[34231.0,2.0,4.25,"Fighter in the Wind (2004)"],[120631.0,1.0,3.5,"Out of the Clear Blue Sky (2012)"],[105831.0,1.0,1.5,"Bloody Bloody Bible Camp (2012)"],[106431.0,3.0,3.5,"Chasing Ghosts: Beyond the Arcade (2007) "],[87031.0,5.0,3.1,"Strip Nude for Your Killer (Nude per l'assassino) (1975)"],[61031.0,5.0,3.4,"World's Greatest Lover, The (1977)"],[131231.0,1.0,3.5,"Standby (2014)"],[88031.0,3.0,2.0,"Tiresia (2003)"],[91031.0,5.0,3.3,"Wichita (1955)"],[111031.0,1.0,4.5,"Manufacturing Reality: Slavoj Zizek and the Reality of the Virtual (Slavoj Zizek: The Reality of the Virtual) (2004)"],[60231.0,2.0,3.5,"London After Midnight (1927)"],[43631.0,2.0,3.25,"Green Dolphin Street (1947)"],[81831.0,6.0,3.0833333333333335,"First Beautiful Thing, The (La prima cosa bella) (2010)"],[79031.0,1.0,3.0,"Horror Business (2005)"],[86231.0,3.0,4.0,"Warrendale (1967)"],[99631.0,2.0,3.75,"I Know What I Saw (2009)"],[96631.0,1.0,4.5,"Deathstalker II (1987)"],[114431.0,1.0,3.0,"Monkey's Teeth (Dents du singe, Les) (1960)"],[83831.0,1.0,3.0,"Story of Dr. Wassell, The (1944)"],[94831.0,1.0,3.0,"Leadbelly (1976)"],[103631.0,1.0,4.0,"Abols Upe (1974)"],[119031.0,1.0,3.0,"The Son of the Sheik (1977)"],[91231.0,1.0,3.0,"My Flesh My Blood (Moja krew) (2009)"],[103831.0,1.0,4.0,"Out of Life (Hors la vie) (1991)"],[116431.0,1.0,3.5,"Now! (1967)"],[94431.0,1.0,5.0,"Ella Lola, a la Trilby (1898)"],[120831.0,1.0,2.5,"Dealin' with Idiots (2013)"],[32.0,44980.0,3.8980546909737663,"Twelve Monkeys (a.k.a. 12 Monkeys) (1995)"],[832.0,14347.0,3.4579354568899423,"Ransom (1996)"],[3032.0,1666.0,3.43187274909964,"Omega Man, The (1971)"],[1032.0,7842.0,3.6301326192297885,"Alice in Wonderland (1951)"],[1432.0,1308.0,2.8704128440366974,"Metro (1997)"],[2232.0,6090.0,3.5929392446633828,"Cube (1997)"],[4232.0,3682.0,2.8379956545355784,"Spy Kids (2001)"],[55232.0,1351.0,3.1695040710584754,"Resident Evil: Extinction (2007)"],[60832.0,161.0,2.8819875776397517,"Pathology (2008)"],[432.0,12819.0,2.735470785552695,"City Slickers II: The Legend of Curly's Gold (1994)"],[232.0,6150.0,4.035609756097561,"Eat Drink Man Woman (Yin shi nan nu) (1994)"],[87232.0,3678.0,3.8304785209352907,"X-Men: First Class (2011)"],[1632.0,172.0,2.4011627906976742,"Smile Like Yours, A (1997)"],[5632.0,580.0,3.7663793103448278,"Bloody Sunday (2002)"],[632.0,342.0,3.91812865497076,"Land and Freedom (Tierra y libertad) (1995)"],[1232.0,1663.0,4.021948286229706,"Stalker (1979)"],[2032.0,238.0,2.8676470588235294,"Barefoot Executive, The (1971)"],[6832.0,919.0,3.3460282916213275,"Regarding Henry (1991)"],[64032.0,315.0,2.911111111111111,"Four Christmases (2008)"],[42632.0,1099.0,3.828935395814377,"Lady Vengeance (Sympathy for Lady Vengeance) (Chinjeolhan geumjassi) (2005)"],[2432.0,2026.0,3.2206317867719645,"Stepmom (1998)"],[4632.0,180.0,3.2111111111111112,"Package, The (1989)"],[5232.0,161.0,3.3074534161490683,"Road to Singapore (1940)"],[5432.0,53.0,2.0943396226415096,"Hero and the Terror (1988)"],[6032.0,225.0,3.7711111111111113,"Little Romance, A (1979)"],[96432.0,287.0,3.451219512195122,"Lawless (2012)"],[27032.0,146.0,3.3595890410958904,"Who Am I? (Wo shi shei) (1998)"],[3632.0,369.0,3.734417344173442,"Monsieur Verdoux (1947)"],[4032.0,81.0,3.0123456790123457,"Everlasting Piece, An (2000)"],[7032.0,123.0,2.8089430894308944,"Revenge (1990)"],[27432.0,91.0,3.67032967032967,"Beautiful Country, The (2004)"],[4432.0,789.0,4.076679340937896,"Sweet Smell of Success (1957)"],[58432.0,141.0,2.6560283687943262,"What Just Happened (2008)"],[31032.0,67.0,2.9402985074626864,"Last Horror Movie, The (2003)"],[80432.0,13.0,3.8846153846153846,"Our Relations (1936)"],[95032.0,10.0,2.8,"Vares: The Kiss of Evil (Vares - Pahan suudelma) (2011)"],[3432.0,430.0,2.1732558139534883,"Death Wish 3 (1985)"],[5832.0,129.0,2.294573643410853,"Left Behind II: Tribulation Force (2002)"],[48032.0,118.0,3.656779661016949,"Tiger and the Snow, The (La tigre e la neve) (2005)"],[3232.0,165.0,3.915151515151515,"Seven Chances (1925)"],[3832.0,144.0,3.4479166666666665,"Black Sabbath (Tre volti della paura, I) (1963)"],[7232.0,46.0,3.4347826086956523,"Heat and Dust (1983)"],[6432.0,75.0,3.0533333333333332,"Courtship of Eddie's Father, The (1963)"],[1832.0,48.0,2.625,"Heaven's Burning (1997)"],[32632.0,76.0,3.4342105263157894,"Electra Glide in Blue (1973)"],[6232.0,334.0,3.4221556886227544,"Born Free (1966)"],[128832.0,7.0,2.142857142857143,"The Last Five Years (2014)"],[2632.0,129.0,3.63953488372093,"Saragossa Manuscript, The (Rekopis znaleziony w Saragossie) (1965)"],[70432.0,60.0,3.5166666666666666,"Fail Safe (2000)"],[8832.0,129.0,3.3488372093023258,"Warriors of Heaven and Earth (Tian di ying xiong) (2003)"],[5032.0,32.0,2.34375,"Romantic Comedy (1983)"],[7832.0,216.0,3.865740740740741,"Thin Man Goes Home, The (1945)"],[43832.0,140.0,3.5142857142857142,"Call of Cthulhu, The (2005)"],[8232.0,64.0,3.6953125,"I Love You Again (1940)"],[70032.0,93.0,3.193548387096774,"Visioneers (2008)"],[96832.0,192.0,3.6067708333333335,"Holy Motors (2012)"],[58632.0,18.0,3.5277777777777777,"Terror's Advocate (Avocat de la terreur, L') (2007)"],[4832.0,57.0,2.956140350877193,"Carny (1980)"],[82032.0,6.0,2.9166666666666665,"All These Women (För att inte tala om alla dessa kvinnor) (1964)"],[26432.0,15.0,2.933333333333333,"Quintet (1979)"],[59832.0,48.0,3.59375,"Where the Sidewalk Ends (1950)"],[79832.0,25.0,3.58,"Easy Living (1937)"],[97832.0,40.0,3.5,"Chasing Mavericks (2012)"],[97232.0,35.0,3.0714285714285716,"Good Old Fashioned Orgy, A (2011)"],[93432.0,44.0,3.602272727272727,"Forks Over Knives (2011)"],[2832.0,31.0,2.9838709677419355,"Lost Son, The (1999)"],[27232.0,7.0,2.9285714285714284,"Beautiful Joe (2000)"],[33832.0,59.0,3.23728813559322,"Yes (2004)"],[78832.0,7.0,2.9285714285714284,"Wing and a Prayer (1944)"],[26232.0,2.0,4.25,"Rejs (1970)"],[6632.0,16.0,3.09375,"Of Unknown Origin (1983)"],[73232.0,17.0,3.088235294117647,"Girl in the Park, The (2007)"],[119432.0,4.0,3.5,"A Thousand Times Goodnight (2014)"],[69432.0,15.0,3.2,"Small Town Gay Bar (2006)"],[102432.0,5.0,3.3,"Blueprint for Murder, A (1953)"],[90432.0,4.0,3.375,"Lentsu (1990)"],[99832.0,6.0,3.5,"Hand, The (Ruka) (1966)"],[84232.0,13.0,3.4615384615384617,"Love Nest, The (1923)"],[84832.0,4.0,2.0,"Don Quixote (Don Quijote de Orson Welles) (1992)"],[34032.0,5.0,3.1,"Modigliani (2004)"],[57432.0,14.0,2.75,"Timber Falls (2007)"],[8632.0,15.0,2.3666666666666667,"Secret Society (2002)"],[56432.0,26.0,3.4423076923076925,"Swimming Pool, The (La piscine) (1969)"],[116032.0,2.0,2.0,"Children of the Corn V: Fields of Terror (1998)"],[78032.0,31.0,2.5161290322580645,"Dread (2009)"],[83232.0,4.0,2.875,"White Wedding (Noce blanche) (1989)"],[100032.0,12.0,3.4166666666666665,"Beauty Is Embarrassing (2012)"],[91632.0,13.0,3.3461538461538463,"G.I. Joe: A Real American Hero (G.I. Joe: The MASS Device) (1983)"],[25832.0,10.0,3.6,"Wife vs. Secretary (1936)"],[79232.0,3.0,4.0,"Comrades (1986)"],[51632.0,16.0,2.9375,"Atlantis: Milo's Return (2003) "],[60032.0,25.0,2.64,"Hounddog (2007)"],[90632.0,5.0,2.8,"Answer This! (2010)"],[81432.0,2.0,2.75,"Finances of the Grand Duke, The (Die Finanzen des Großherzogs) (1924)"],[86432.0,15.0,3.433333333333333,"Outside the Law (Hors-la-loi) (2010)"],[107632.0,1.0,3.5,"Carmen (1918)"],[89632.0,4.0,4.25,"Masti (2004)"],[113632.0,3.0,3.8333333333333335,"Other F Word, The (2011)"],[128632.0,7.0,2.0,"Home Sweet Hell (2015)"],[106232.0,1.0,2.0,"Reformer and the Redhead, The (1950)"],[111632.0,1.0,1.5,"Heat's On, The (1943)"],[72632.0,2.0,3.25,"Before I Self Destruct (2009)"],[129032.0,4.0,4.125,"Sense & Sensibility (2008)"],[107032.0,1.0,0.5,"Route 666 (2001)"],[107232.0,1.0,2.5,"Deadly Spawn, The (1983)"],[76032.0,1.0,0.5,"After Last Season (2009)"],[105032.0,2.0,3.75,"Farah Goes Bang (2013)"],[76832.0,2.0,1.75,"Black Waters of Echo's Pond, The (2009)"],[109032.0,1.0,3.0,"Hornets' Nest (1970)"],[100232.0,1.0,3.0,"Not with My Wife, You Don't! (1966)"],[106832.0,2.0,3.0,"7th Cavalry (Seventh Cavalry) (1956)"],[103032.0,3.0,3.8333333333333335,"They Call Us Misfits (Dom kallar oss mods) (1968)"],[117432.0,1.0,2.0,"The Heart Machine (2014)"],[120432.0,1.0,3.0,"A Summer in St. Tropez (1983)"],[92032.0,2.0,2.5,"Don Is Dead, The (1973)"],[125632.0,1.0,4.5,"In Our Garden"],[106032.0,1.0,2.0,"Chastity Bites (2013)"],[72032.0,4.0,4.0,"Forever (2006)"],[124232.0,1.0,3.0,"The Fuller Brush Man (1948)"],[98032.0,2.0,1.0,"Bear with Me (2005)"],[104832.0,2.0,3.5,"Glass Web, The (1953)"],[113232.0,1.0,3.0,"National Lampoon's Pucked (2006)"],[114232.0,1.0,3.5,"Marilena de la P7 (2006)"],[95832.0,2.0,3.0,"Elephant Boy (1937)"],[110032.0,1.0,3.0,"Blondes at Work (1938)"],[127232.0,1.0,4.0,"The Referee (2013)"],[126032.0,1.0,1.5,"Betty Boop's Hallowe'en Party (1933)"],[95232.0,2.0,0.5,"Beauty #2 (1965)"],[119832.0,1.0,1.5,"Screamers (1979)"],[129432.0,1.0,3.0,"Love and Bullets (1979)"],[126432.0,1.0,4.5,"Visitor to a Museum (Posetitel muzeya) (1989)"],[113432.0,1.0,3.5,"So Much So Fast (2006)"],[101632.0,1.0,4.5,"18 Fingers of Death! (2006)"],[3033.0,11536.0,3.4018290568654646,"Spaceballs (1987)"],[2633.0,1717.0,3.349155503785673,"Mummy, The (1932)"],[8633.0,1444.0,3.402354570637119,"Last Starfighter, The (1984)"],[1233.0,13612.0,4.139729650308551,"Boot, Das (Boat, The) (1981)"],[71033.0,1191.0,4.0465994962216625,"Secret in Their Eyes, The (El secreto de sus ojos) (2009)"],[1833.0,2389.0,3.019673503557974,"Mercury Rising (1998)"],[2433.0,3965.0,3.3383354350567465,"Civil Action, A (1998)"],[4033.0,3366.0,3.681966726084373,"Thirteen Days (2000)"],[4233.0,634.0,2.4645110410094637,"Tomcats (2001)"],[233.0,3478.0,3.523720529039678,"Exotica (1994)"],[433.0,1242.0,2.9239130434782608,"Clean Slate (1994)"],[833.0,1427.0,2.725998598458304,"High School High (1996)"],[1633.0,2400.0,3.670625,"Ulee's Gold (1997)"],[3633.0,2688.0,3.4058779761904763,"On Her Majesty's Secret Service (1969)"],[4633.0,217.0,3.1912442396313363,"Parents (1989)"],[4833.0,547.0,3.6023765996343693,"Changeling, The (1980)"],[86833.0,1407.0,3.5277185501066097,"Bridesmaids (2011)"],[8833.0,582.0,3.1872852233676974,"Vanity Fair (2004)"],[1033.0,3982.0,3.4280512305374184,"Fox and the Hound, The (1981)"],[2033.0,1415.0,3.1950530035335687,"Black Cauldron, The (1985)"],[5033.0,380.0,3.223684210526316,"Russia House, The (1990)"],[5433.0,417.0,2.821342925659472,"Silver Bullet (Stephen King's Silver Bullet) (1985)"],[44633.0,381.0,3.909448818897638,"Devil and Daniel Johnston, The (2005)"],[31433.0,548.0,3.153284671532847,"Wedding Date, The (2005)"],[5833.0,969.0,3.3493292053663573,"Dog Soldiers (2002)"],[8033.0,591.0,3.9230118443316413,"How to Steal a Million (1966)"],[5633.0,502.0,3.587649402390438,"Heaven (2002)"],[94833.0,180.0,3.441666666666667,"Pirates! Band of Misfits, The (2012)"],[5233.0,104.0,3.5336538461538463,"Road to Utopia (1946)"],[27833.0,109.0,2.9128440366972477,"Silver City (2004)"],[6233.0,215.0,2.7883720930232556,"Born Yesterday (1993)"],[63033.0,512.0,3.3369140625,"Blindness (2008)"],[3833.0,314.0,2.3662420382165603,"Brain That Wouldn't Die, The (1962)"],[63433.0,379.0,3.7994722955145117,"Farscape: The Peacekeeper Wars (2004)"],[2233.0,53.0,2.8679245283018866,"Digging to China (1998)"],[6433.0,436.0,3.9644495412844036,"Man with the Movie Camera, The (Chelovek s kino-apparatom) (1929)"],[7033.0,561.0,3.0828877005347595,"Secret of My Succe$s, The (a.k.a. The Secret of My Success) (1987)"],[82633.0,28.0,3.5892857142857144,"Kuroneko (Black Cat from the Grove, The) (Yabu no naka no kuroneko) (1968)"],[3433.0,267.0,1.8614232209737829,"Death Wish 4: The Crackdown (1987)"],[48833.0,24.0,3.125,"Jade Warrior (Jadesoturi) (2006)"],[6033.0,69.0,2.8768115942028984,"Mystery Date (1991)"],[102033.0,222.0,3.1103603603603602,"Pain & Gain (2013)"],[91233.0,127.0,3.893700787401575,"Lifted (2006)"],[633.0,336.0,3.3735119047619047,"Denise Calls Up (1995)"],[77833.0,105.0,3.6,"Armadillo (2010)"],[27033.0,184.0,3.9347826086956523,"Kingdom II, The (Riget II) (1997)"],[99633.0,29.0,3.0,"Sweeney, The (2012)"],[4433.0,216.0,3.787037037037037,"Written on the Wind (1956)"],[33.0,65.0,3.0076923076923077,"Wings of Courage (1995)"],[2833.0,166.0,3.253012048192771,"Lucie Aubrac (1997)"],[7833.0,278.0,3.856115107913669,"Shadow of the Thin Man (1941)"],[40033.0,38.0,3.6447368421052633,"Adventures of Prince Achmed, The (Abenteuer des Prinzen Achmed, Die) (1926)"],[1433.0,67.0,2.1940298507462686,"Machine, The (1994)"],[6833.0,12.0,3.2083333333333335,"Debut, The (2000)"],[78633.0,39.0,3.576923076923077,"Casino Jack and the United States of Money (2010)"],[40833.0,16.0,3.625,"Fists in the Pocket (Pugni in tasca, I) (1965)"],[77233.0,66.0,3.8636363636363638,"Union: The Business Behind Getting High, The (2007)"],[54833.0,34.0,3.661764705882353,"Brighton Rock (1947)"],[129233.0,1.0,2.0,"Believe Me (2014)"],[86233.0,28.0,2.8035714285714284,"New Kids Turbo (2010)"],[56633.0,97.0,3.118556701030928,"Butterfly on a Wheel (Shattered) (2007)"],[72833.0,6.0,3.5833333333333335,"Art of Travel, The (2008)"],[25833.0,108.0,3.7546296296296298,"Camille (1936)"],[79633.0,13.0,3.8461538461538463,"Kautokeino Rebellion, The (Kautokeino-opprøret) (2008)"],[87433.0,18.0,3.0555555555555554,"Ghidorah, the Three-Headed Monster (San daikaijû: Chikyû saidai no kessen) (1964)"],[3233.0,12.0,2.9583333333333335,"Smashing Time (1967)"],[77433.0,16.0,3.78125,"Ten Commandments, The (1923)"],[6633.0,10.0,2.6,"Prince of Jutland (a.k.a. Royal Deceit) (1994)"],[103233.0,20.0,3.125,"LEGO Batman: The Movie - DC Heroes Unite (2013)"],[67233.0,5.0,3.2,"Young Thugs: Nostalgia (Kishiwada shônen gurentai: Bôkyô) (1998)"],[114033.0,35.0,2.914285714285714,"Into the Storm (2014)"],[26033.0,8.0,3.5625,"Giants and Toys (Kyojin to gangu) (1958)"],[109633.0,15.0,3.566666666666667,"Garden of Words, The (Koto no ha no niwa) (2013)"],[115633.0,2.0,3.25,"Archangel (2005)"],[80033.0,3.0,2.0,"President's Man, The (2000)"],[81633.0,4.0,3.75,"Dark and Stormy Night (2009)"],[71433.0,8.0,3.625,"Black God, White Devil (Deus e o Diabo na Terra do Sol) (1964)"],[53833.0,11.0,3.9545454545454546,"David Holzman's Diary (1967)"],[69233.0,9.0,3.0555555555555554,"Blind Husbands (1919)"],[70833.0,10.0,3.45,"Queen Kelly (1929)"],[110633.0,3.0,3.0,"Arsène Lupin (1932)"],[51433.0,6.0,2.75,"Changing Times (Les temps qui changent) (2004)"],[92633.0,2.0,3.25,"Castle of Sand, The (Suna no utsuwa) (1974)"],[83833.0,8.0,3.6875,"Street Angel (1928)"],[98633.0,2.0,3.75,"My Lucky Stars (Fuk sing go jiu) (1985)"],[101233.0,3.0,2.3333333333333335,"Glass Menagerie, The (1950)"],[102233.0,1.0,4.0,"Verlorene, Der (Lost One, The) (1951)"],[104033.0,3.0,2.5,"Love, Marilyn (2012)"],[111233.0,2.0,3.25,"Tentacles (Tentacoli) (1977)"],[127033.0,1.0,4.5,"Mother, I Love You (2013)"],[26433.0,6.0,4.25,"Rockers (1978)"],[115233.0,1.0,2.5,"Berlin Babylon (2001)"],[65033.0,6.0,3.0,"Girls Rock! (2007)"],[32433.0,1.0,2.0,"Mixed Blood (1984)"],[104233.0,3.0,3.8333333333333335,"Cat and the Canary, The (1939)"],[114633.0,2.0,3.0,"Junkopia (1981)"],[116833.0,1.0,3.5,"Son of the White Mare (1981)"],[110433.0,3.0,3.0,"Möbius (2013)"],[110233.0,1.0,2.5,"Man at Bath (Homme au bain) (2010)"],[126233.0,1.0,1.5,"Seventh Heaven (1993)"],[86033.0,6.0,2.6666666666666665,"Flodder in Amerika! (1992)"],[65633.0,4.0,3.25,"Fuel (2008)"],[7233.0,4.0,1.625,"My Letter to George (Mesmerized) (1986)"],[101433.0,1.0,1.0,"Moving Out (1983)"],[87033.0,5.0,3.5,"Ballad of the Paper Balloons (a.k.a. Humanity and Paper Balloons) (Ninjô kami fûsen) (1937)"],[80233.0,3.0,2.1666666666666665,"Truth, The (2010) "],[101833.0,2.0,2.75,"About Face: Supermodels Then and Now (2012)"],[105833.0,2.0,1.0,"Bloody New Year (1987)"],[68833.0,3.0,3.1666666666666665,"How to Cook Your Life (2007)"],[116233.0,1.0,3.0,"Confidence Girl (1952)"],[121033.0,1.0,3.0,"A Patriotic Man (2013)"],[43633.0,3.0,3.8333333333333335,"Lt. Robin Crusoe, U.S.N. (1966)"],[109833.0,2.0,3.5,"Blackbeard, the Pirate (1952)"],[88633.0,3.0,2.0,"Adopted (2009)"],[52033.0,6.0,3.3333333333333335,"Tall Target, The (1951)"],[58033.0,1.0,3.0,"Already Dead (2007)"],[113033.0,1.0,3.5,"Rasmus på luffen (1981)"],[100633.0,2.0,3.75,"Scarecrow, The (1972)"],[89833.0,1.0,3.0,"Bad Girl (1931)"],[127433.0,1.0,4.0,"High School Hellcats (1958)"],[94433.0,1.0,3.0,"Guilty Hands (1931)"],[103633.0,1.0,4.5,"Making a Killing: The Untold Story of Psychotropic Drugging (2008)"],[114433.0,1.0,4.0,"Dead Times (Temps morts, Les) (1965)"],[68233.0,1.0,3.0,"Man Behind the Gun, The (1953)"],[104633.0,1.0,3.5,"French Roast (2008)"],[87633.0,1.0,3.5,"Scenic Route, The (1978)"],[116433.0,1.0,1.0,"America's Most Haunted Inns (2004)"],[103433.0,1.0,3.0,"Grandpa for Christmas, A (Bert & Becca) (2007)"],[120833.0,1.0,3.0,"Super Capers (2009)"],[6834.0,46.0,2.6847826086956523,"Wilder Napalm (1993)"],[2034.0,2182.0,2.8285976168652613,"Black Hole, The (1979)"],[434.0,24940.0,3.0573376102646352,"Cliffhanger (1993)"],[4034.0,16379.0,3.8272483057573723,"Traffic (2000)"],[64034.0,1008.0,3.8546626984126986,"Boy in the Striped Pajamas, The (Boy in the Striped Pyjamas, The) (2008)"],[34.0,32255.0,3.6430940939389242,"Babe (1995)"],[7034.0,1747.0,3.8234115626788783,"Show Me Love (Fucking Åmål) (1998)"],[7234.0,905.0,4.035911602209945,"Strada, La (1954)"],[234.0,3269.0,2.679718568369532,"Exit to Eden (1994)"],[1234.0,14926.0,4.173556210639153,"Sting, The (1973)"],[81834.0,3884.0,3.879119464469619,"Harry Potter and the Deathly Hallows: Part 1 (2010)"],[51834.0,603.0,3.5630182421227197,"Becoming Jane (2007)"],[1834.0,4521.0,3.8821057288210574,"Spanish Prisoner, The (1997)"],[3634.0,895.0,4.0206703910614525,"Seven Days in May (1964)"],[3034.0,4525.0,3.6796685082872926,"Robin Hood (1973)"],[4234.0,1534.0,2.9664276401564535,"Tailor of Panama, The (2001)"],[1034.0,1502.0,3.5392809587217045,"Freeway (1996)"],[2634.0,638.0,3.103448275862069,"Mummy, The (1959)"],[2834.0,192.0,3.3098958333333335,"Very Thought of You, The (1998)"],[33834.0,1202.0,3.2429284525790347,"Land of the Dead (2005)"],[62434.0,1880.0,3.359042553191489,"Zack and Miri Make a Porno (2008)"],[1434.0,60.0,3.066666666666667,"Stranger, The (1994)"],[3834.0,520.0,2.8173076923076925,"Bronco Billy (1980)"],[5434.0,386.0,3.7966321243523318,"Sorry, Wrong Number (1948)"],[5034.0,941.0,3.773645058448459,"Truly, Madly, Deeply (1991)"],[7834.0,490.0,3.904081632653061,"After the Thin Man (1936)"],[87234.0,449.0,3.7416481069042318,"Submarine (2010)"],[5634.0,31.0,3.1774193548387095,"Pipe Dream (2002)"],[27434.0,235.0,2.5148936170212766,"Darkness (2002)"],[27834.0,466.0,3.913090128755365,"Return, The (Vozvrashcheniye) (2003)"],[39234.0,622.0,3.5860128617363345,"North Country (2005)"],[5234.0,106.0,3.2358490566037736,"Road to Zanzibar (1941)"],[4634.0,228.0,3.1600877192982457,"Penn & Teller Get Killed (1989)"],[25834.0,142.0,3.73943661971831,"Captains Courageous (1937)"],[78034.0,148.0,3.456081081081081,"Cemetery Junction (2010)"],[59834.0,50.0,2.77,"100 Rifles (1969)"],[634.0,334.0,2.320359281437126,"Theodore Rex (1995)"],[26834.0,47.0,2.606382978723404,"Philadelphia Experiment II (1993)"],[6234.0,156.0,3.451923076923077,"Equus (1977)"],[4834.0,474.0,2.809071729957806,"Cheech & Chong's Next Movie (1980)"],[8634.0,119.0,2.588235294117647,"Tank (1984)"],[3434.0,213.0,1.9061032863849765,"Death Wish 5: The Face of Death (1994)"],[8834.0,36.0,2.25,"Cookout, The (2004)"],[62834.0,117.0,2.952991452991453,"Babylon 5: The Legend of the Rangers: To Live and Die in Starlight (2002)"],[6034.0,19.0,2.473684210526316,"Paradise, Hawaiian Style (1966)"],[6434.0,49.0,3.357142857142857,"Objective, Burma! (1945)"],[834.0,203.0,2.645320197044335,"Phat Beach (1996)"],[92234.0,77.0,2.935064935064935,"Red Tails (2012)"],[42634.0,54.0,3.259259259259259,"Boys Don't Cry (Chlopaki nie placza) (2000)"],[47634.0,124.0,3.5120967741935485,"36 Quai des Orfèvres (Department 36) (2004)"],[2234.0,56.0,2.5714285714285716,"Let's Talk About Sex (1998)"],[58434.0,17.0,2.9411764705882355,"Little Trip to Heaven, A (2005)"],[103834.0,6.0,3.3333333333333335,"Fetching Cody (2005)"],[106234.0,14.0,3.2142857142857144,"Great Expectations (2012)"],[46034.0,24.0,3.3541666666666665,"Mountain Patrol (Kekexili) (2004)"],[46634.0,6.0,3.1666666666666665,"These Girls (2005)"],[4434.0,91.0,3.2472527472527473,"10th Victim, The (La decima vittima) (1965)"],[84234.0,17.0,3.735294117647059,"Simple Simon (I rymden finns inga känslor) (2010)"],[61434.0,9.0,3.5,"Oh! What a Lovely War (1969)"],[5834.0,48.0,3.2604166666666665,"Fingers (1978)"],[32234.0,116.0,3.6810344827586206,"Julia (1977)"],[97834.0,16.0,3.0,"Craigslist Joe (2012)"],[112434.0,3.0,3.3333333333333335,"In Bloom (Grzeli nateli dgeebi) (2013)"],[2434.0,271.0,3.5,"Down in the Delta (1998)"],[75434.0,8.0,3.8125,"Wrestler, The (Painija) (1985)"],[100034.0,17.0,3.1470588235294117,"Girl Model (2011)"],[32834.0,44.0,3.3068181818181817,"Macbeth (1948)"],[96034.0,4.0,3.125,"Hierro (2009) "],[64234.0,47.0,2.4680851063829787,"Guyver, The (1991)"],[73834.0,3.0,2.0,"Pokrajina St.2 (2008)"],[3234.0,3.0,3.3333333333333335,"Train Ride to Hollywood (1975)"],[90634.0,2.0,4.0,"Doll, The (Lalka) (1968)"],[96634.0,14.0,3.107142857142857,"Emergo (Apartment 143) (2011)"],[66234.0,23.0,3.239130434782609,"Jar City (Mýrin) (2006)"],[82834.0,7.0,3.142857142857143,"Elena and Her Men (Paris Does Strange Things) (Elena et les hommes) (1956)"],[83034.0,11.0,3.6363636363636362,"Death of a Salesman (1951)"],[98834.0,4.0,3.75,"Fitzgerald Family Christmas, The (2012)"],[6634.0,11.0,2.3181818181818183,"Rowing with the Wind (Remando al viento) (1988)"],[90434.0,21.0,3.0952380952380953,"Assassination Games (2011)"],[41434.0,7.0,3.642857142857143,"After Innocence (2005)"],[129034.0,1.0,5.0,"Serving Life (2011)"],[27234.0,2.0,3.25,"Underground Comedy Movie, The  (1999)"],[91634.0,15.0,3.1,"G.I. Joe: The Revenge of Cobra (1984)"],[97234.0,12.0,3.7083333333333335,"Inside: 'Dr. Strangelove or How I Learned to Stop Worrying and Love the Bomb' (2000)"],[84834.0,14.0,3.1785714285714284,"Three Kingdoms: Resurrection of the Dragon (Saam gwok dzi gin lung se gap) (2008)"],[78834.0,1.0,3.5,"Tomorrow at Dawn (Demain dès l'aube) (2009)"],[80834.0,20.0,3.65,"Sintel (2010)"],[44234.0,8.0,2.8125,"Illustrated Man, The (1969)"],[71634.0,12.0,3.25,"Story of Louis Pasteur, The (1935)"],[130834.0,1.0,2.5,"Dancers (1987)"],[96834.0,24.0,3.2291666666666665,"Knuckleball! (2012)"],[99434.0,7.0,3.357142857142857,"Snow on Tha Bluff (2011)"],[26034.0,13.0,3.576923076923077,"Last Hurrah, The (1958)"],[117434.0,7.0,3.0714285714285716,"Starry Eyes (2014)"],[74434.0,9.0,3.6666666666666665,"Wounds, The (Rane) (1998)"],[95034.0,14.0,2.5357142857142856,"Few Best Men, A (2011)"],[114834.0,2.0,3.0,"Hellgate (1989)"],[102434.0,2.0,2.75,"Huey P. Newton Story, A (2001)"],[128634.0,1.0,3.5,"Invisible Ghost (1941)"],[95234.0,6.0,3.3333333333333335,"Wings in the Dark (1935)"],[73234.0,2.0,2.5,"Command Performance (2009)"],[109434.0,1.0,2.0,"Psychosis (2010)"],[86434.0,3.0,2.8333333333333335,"Wrong Rosary (Uzak ihtimal) (2009)"],[129834.0,1.0,0.5,"Tom and Jerry: The Lost Dragon (2014)"],[61634.0,10.0,2.3,"Son of Lassie (1945)"],[107634.0,2.0,2.75,"Grand Tour: Disaster in Time (Timescape) (1992)"],[49234.0,7.0,3.2857142857142856,"Red Dust (2004)"],[87834.0,6.0,3.75,"My Life as McDull (Mak dau goo si) (2001)"],[72634.0,2.0,3.5,"Hoop Realities (2007)"],[106834.0,1.0,4.0,"Deeper Shade of Blue, A (2011)"],[116034.0,1.0,3.5,"Children of the Corn: Genesis (2011)"],[52634.0,5.0,3.5,"Smash-Up: The Story of a Woman (1947)"],[98034.0,3.0,1.5,"Children of the Living Dead (2001)"],[128834.0,1.0,4.5,"Naked (2000)"],[106434.0,1.0,0.5,"Chillers (1987)"],[107234.0,1.0,1.5,"Deadly Surveillance (1991)"],[93834.0,4.0,3.125,"Ticked-Off Trannies with Knives (2010)"],[107434.0,1.0,5.0,"Diplomatic Immunity (2009– )"],[105034.0,6.0,3.8333333333333335,"Shadowlands (1985)"],[34234.0,1.0,2.0,"Pornography (Pornografia) (2003)"],[105234.0,2.0,3.5,"Wanda Sykes: Sick and Tired (2006)"],[26634.0,5.0,3.1,"Pascali's Island (1988)"],[55434.0,2.0,3.25,"Between Heaven and Hell (1956)"],[130034.0,1.0,4.5,"Stand by Me Doraemon (2014)"],[125634.0,1.0,4.0,"Giuseppe Makes a Movie (2014)"],[113434.0,2.0,4.25,"What About Dick? (2012)"],[113634.0,2.0,3.5,"Message from Akira Kurosawa: For Beautiful Movies, A (Kurosawa Akira kara no messêji: Utsukushii eiga o) (2000)"],[115834.0,1.0,3.0,"Charlie Chan's Murder Cruise (1940)"],[91834.0,5.0,2.9,"Born to Race (2011)"],[106634.0,2.0,3.0,"Raisin in the Sun, A (2008)"],[113834.0,2.0,3.0,"Piripäiväkirja (2014)"],[113234.0,2.0,3.25,"Thirty-Nine Steps, The (1978)"],[109034.0,2.0,2.25,"Evidence (1995)"],[114234.0,1.0,2.5,"Uncle Marin, the Billionaire (Nea Marin miliardar) (Uncle Martin, the Multimillionaire) (1979)"],[110034.0,1.0,3.5,"Blondie of the Follies (1932)"],[127234.0,1.0,3.5,"Reality (2012)"],[126034.0,1.0,1.5,"Halloween (1931)"],[76034.0,1.0,4.0,"Cross: The Arthur Blessitt Story, The (2009)"],[127634.0,1.0,2.0,"Sebastian (1968)"],[79234.0,1.0,3.5,"Snake-Crane Secret (She hao dan xin zhen jiu zhou) (1976)"],[126434.0,1.0,3.0,"The Hyperboloid of Engineer Garin (Giperboloid inzhenera Garina) (1965)"],[101634.0,1.0,0.5,"Get2Gether, A (2005)"],[235.0,16419.0,3.6636518667397526,"Ed Wood (1994)"],[1035.0,14049.0,3.8044344793223717,"Sound of Music, The (1965)"],[3235.0,453.0,3.1490066225165565,"Where the Buffalo Roam (1980)"],[4235.0,5511.0,4.0168753402286335,"Amores Perros (Love's a Bitch) (2000)"],[435.0,13911.0,2.5935590539860542,"Coneheads (1993)"],[1835.0,4823.0,3.2564793696869168,"City of Angels (1998)"],[7235.0,1007.0,3.4697120158887786,"Ichi the Killer (Koroshiya 1) (2001)"],[39435.0,889.0,3.079865016872891,"Legend of Zorro, The (2005)"],[1635.0,5570.0,3.8045780969479353,"Ice Storm, The (1997)"],[3635.0,4179.0,3.541517109356305,"Spy Who Loved Me, The (1977)"],[3435.0,4909.0,4.224281931146873,"Double Indemnity (1944)"],[4435.0,49.0,3.3979591836734695,"Colonel Redl (Oberst Redl) (1985)"],[4835.0,1172.0,3.650170648464164,"Coal Miner's Daughter (1980)"],[3035.0,2522.0,4.052339413164155,"Mister Roberts (1955)"],[1235.0,8066.0,3.999814034217704,"Harold and Maude (1971)"],[88235.0,436.0,3.697247706422018,"Guard, The (2011)"],[2835.0,461.0,2.319956616052061,"Chill Factor (1999)"],[8835.0,189.0,2.687830687830688,"Paparazzi (2004)"],[35.0,1493.0,3.5016744809109177,"Carrington (1995)"],[635.0,1100.0,3.6454545454545455,"Family Thing, A (1996)"],[2435.0,667.0,2.95952023988006,"Hurlyburly (1998)"],[2235.0,32.0,2.4375,"One Man's Hero (1999)"],[3835.0,869.0,2.609896432681243,"Crush, The (1993)"],[4035.0,326.0,3.2423312883435584,"Claim, The (2000)"],[4635.0,402.0,2.3333333333333335,"Pink Cadillac (1989)"],[5235.0,148.0,2.989864864864865,"Split Second (1992)"],[5435.0,244.0,3.622950819672131,"Hombre (1967)"],[86835.0,340.0,2.875,"Priest (2011)"],[6235.0,909.0,3.9697469746974696,"Europa Europa (Hitlerjunge Salomon) (1990)"],[52435.0,1501.0,3.798134576948701,"How the Grinch Stole Christmas! (1966)"],[2035.0,324.0,3.103395061728395,"Blackbeard's Ghost (1968)"],[835.0,947.0,3.1768743400211195,"Foxfire (1996)"],[31435.0,247.0,3.840080971659919,"Rory O'Shea Was Here (Inside I'm Dancing) (2004)"],[5635.0,194.0,3.304123711340206,"Man from Elysian Fields, The (2001)"],[8235.0,319.0,3.9357366771159876,"Safety Last! (1923)"],[88835.0,39.0,2.576923076923077,"Glee: The 3D Concert Movie (2011)"],[45635.0,232.0,3.1810344827586206,"Notorious Bettie Page, The (2005)"],[53435.0,468.0,2.661324786324786,"Hostel: Part II (2007)"],[7035.0,175.0,2.9285714285714284,"Streets of Fire (1984)"],[2635.0,176.0,3.0511363636363638,"Mummy's Curse, The (1944)"],[72035.0,16.0,3.6875,"Dimensions of Dialogue (Moznosti dialogu) (1982)"],[31035.0,186.0,3.7204301075268815,"Testament (1983)"],[43635.0,63.0,3.134920634920635,"Bye Bye Birdie (1963)"],[6435.0,32.0,3.15625,"Operation Pacific (1951)"],[87435.0,14.0,2.25,"Sergeant Körmy and the South Pacific (Vääpeli Körmy ja etelän hetelmät) (1992)"],[114635.0,8.0,4.0,"Look of Silence, The (2014)"],[120635.0,94.0,2.824468085106383,"Taken 3 (2015)"],[8035.0,83.0,2.86144578313253,"Stendhal Syndrome, The (Sindrome di Stendhal, La) (1996)"],[6035.0,163.0,3.726993865030675,"Pépé le Moko (1937)"],[5035.0,116.0,3.1982758620689653,"Wuthering Heights (1970)"],[103235.0,135.0,3.8666666666666667,"Best Offer, The (Migliore offerta, La) (2013)"],[6835.0,36.0,2.5277777777777777,"Alien Contamination (1980)"],[105835.0,90.0,3.4277777777777776,"Double, The (2013)"],[25835.0,89.0,3.4831460674157304,"Dead End (1937)"],[68835.0,57.0,3.692982456140351,"Were the World Mine (2008)"],[7835.0,169.0,3.7366863905325443,"Song of the Thin Man (1947)"],[65435.0,102.0,2.6323529411764706,"Open Season 2 (2008)"],[96435.0,3.0,3.3333333333333335,"Chameleon (Kaméleon) (2008)"],[111235.0,87.0,3.8793103448275863,"Jodorowsky's Dune (2013)"],[65235.0,24.0,3.5,"Grocer's Son, The (Fils de l'épicier, Le) (2007)"],[62235.0,136.0,3.4963235294117645,"Red (2008)"],[91035.0,34.0,3.0588235294117645,"Wuthering Heights (2011)"],[80235.0,6.0,3.4166666666666665,"Wedding Song, The (2008) "],[6635.0,62.0,3.0080645161290325,"Rachel Papers, The (1989)"],[48035.0,29.0,3.2586206896551726,"Pretty Poison (1968)"],[82635.0,5.0,3.1,"Glue (2006)"],[53835.0,41.0,3.6951219512195124,"Journey to Italy (Viaggio in Italia) (Voyage to Italy) (Voyage in Italy) (1954)"],[86635.0,2.0,2.25,"Vice (2008)"],[49035.0,14.0,3.2857142857142856,"Daddy Long Legs (1955)"],[129235.0,1.0,3.5,"Les Invisibles (2012)"],[5835.0,20.0,3.175,"Good Evening, Mr. Wallenberg (God afton, Herr Wallenberg) (1990)"],[34435.0,52.0,3.7884615384615383,"Sholay (1975)"],[8635.0,28.0,2.642857142857143,"Jungle Holocaust (Ultimo mondo cannibale) (1977)"],[78635.0,10.0,3.05,"Under the North Star (Täällä Pohjantähden alla) (2009)"],[26435.0,11.0,2.8636363636363638,"Starting Over (1979)"],[26835.0,6.0,3.5833333333333335,"Positively True Adventures of the Alleged Texas Cheerleader-Murdering Mom, The (1993)"],[27835.0,12.0,3.4583333333333335,"Agronomist, The (2003)"],[33435.0,22.0,3.7954545454545454,"Los Angeles Plays Itself (2003)"],[78235.0,18.0,3.9444444444444446,"Betrayal (1983)"],[94835.0,1.0,3.5,"Vie meilleure, Une (Better Life, A) (2011)"],[83435.0,3.0,3.5,"Hatful of Rain, A (1957)"],[49435.0,25.0,2.58,"Reeker (2005)"],[83835.0,9.0,3.2777777777777777,"Frozen North, The (1922)"],[121235.0,6.0,2.25,"The Anomaly (2014)"],[121035.0,9.0,3.4444444444444446,"Houdini (2014)"],[56835.0,6.0,0.75,"Pledge This! (2006)"],[61035.0,19.0,2.763157894736842,"W Delta Z (a.k.a. The Killing Gene) (2007)"],[95835.0,12.0,2.25,"Forger, The (2012)"],[77835.0,6.0,2.5833333333333335,"Stage Door Canteen (1943)"],[38435.0,5.0,3.0,"Forty Shades of Blue (2005)"],[82035.0,17.0,3.3823529411764706,"Cocaine Cowboys II: Hustlin' With the Godmother (2008)"],[70235.0,15.0,2.933333333333333,"Dallas 362 (2003)"],[92635.0,2.0,3.0,"At Home by Myself... with You (2009)"],[103635.0,2.0,3.5,"Pax Americana and the Weaponization of Space (2009)"],[59435.0,19.0,3.3157894736842106,"Numb (2007)"],[97035.0,4.0,2.5,"Living Skeleton, The (Kyûketsu dokuro-sen) (1968)"],[102235.0,4.0,3.125,"Manhunt (2013)"],[79035.0,9.0,3.7222222222222223,"Hold Back the Dawn (1941)"],[81435.0,3.0,2.8333333333333335,"Haunted Castle, The (Schloß Vogeloed) (1921)"],[101235.0,11.0,3.3636363636363638,"Great Gatsby, The (1949)"],[33235.0,6.0,3.75,"Isadora (1968)"],[120835.0,7.0,2.5,"Fight for Your Right Revisited (2011)"],[127035.0,1.0,3.0,"Dream Team 1935 (2012)"],[129435.0,1.0,3.0,"Piggy (2012)"],[114035.0,13.0,3.5,"Calling, The (2014)"],[104035.0,3.0,2.3333333333333335,"Beneath (2013)"],[113035.0,3.0,2.5,"Bachelor Weekend, The (2013)"],[115235.0,8.0,2.1875,"Young Ones (2014)"],[26035.0,2.0,3.0,"Machine Gun Kelly (1958)"],[79835.0,4.0,2.125,"Like It Is (1998)"],[102035.0,1.0,2.0,"Holding, The (2011)"],[126235.0,1.0,3.0,"La Belle équipe (1936)"],[101835.0,1.0,3.5,"According to Spencer (2001)"],[48235.0,1.0,4.5,"Flight from Death: The Quest for Immortality (2003)"],[104835.0,1.0,1.5,"Incredible Melting Man, The (1977)"],[110235.0,4.0,3.0,"Our Paradise (Notre paradis) (2011)"],[27235.0,1.0,4.0,"Shrink Is In, The (2001)"],[89635.0,1.0,3.5,"Story of Me, The (O contador de histórias) (2009)"],[110635.0,1.0,3.5,"Beauty and the Beast (1962)"],[90235.0,2.0,3.0,"Happiest Girl in the World, The (Cea mai fericita fata din lume) (2009)"],[109635.0,6.0,3.5833333333333335,"Pandora's Promise (2013)"],[26235.0,5.0,3.3,"Long Live Death (Viva la muerte) (1971)"],[105435.0,1.0,2.0,"Narrien illat (1970) "],[72235.0,1.0,5.0,"Between the Devil and the Deep Blue Sea (1995)"],[77435.0,1.0,2.5,"This Is the Army (1943)"],[82235.0,1.0,2.5,"Story of Three Loves, The (1953)"],[93035.0,2.0,2.75,"Great Sinner, The (1949)"],[103435.0,1.0,3.0,"Ah, Wilderness! (1935)"],[119035.0,1.0,3.5,"Swindle (1977)"],[124235.0,1.0,3.0,"Precious Find (1996)"],[92435.0,1.0,3.0,"Dancing Hawk, The (Tanczacy jastrzab) (1978)"],[116435.0,1.0,3.5,"Building the Inferno: Nobuo Nakagawa and the Making of 'Jigoku' (2006)"],[91235.0,1.0,3.0,"Living Will... (2010)"],[109235.0,1.0,2.5,"Beyond Tomorrow (Beyond Christmas) (1940)"],[1036.0,30399.0,3.9338465081088194,"Die Hard (1988)"],[8636.0,15712.0,3.551107433808554,"Spider-Man 2 (2004)"],[2236.0,1817.0,3.4507429829389102,"Simon Birch (1998)"],[236.0,12215.0,3.3153499795333605,"French Kiss (1995)"],[35836.0,9588.0,3.554182311222361,"40-Year-Old Virgin, The (2005)"],[36.0,20809.0,3.9427170935652844,"Dead Man Walking (1995)"],[3836.0,2151.0,3.800092980009298,"Kelly's Heroes (1970)"],[2836.0,1235.0,3.25748987854251,"Outside Providence (1999)"],[836.0,4860.0,2.907716049382716,"Chain Reaction (1996)"],[4436.0,162.0,3.419753086419753,"Obsession (1976)"],[1236.0,942.0,4.042993630573249,"Trust (1990)"],[1636.0,78.0,2.4935897435897436,"Stag (1997)"],[2436.0,1311.0,3.400839054157132,"Tea with Mussolini (1999)"],[61236.0,1013.0,3.9284304047384007,"Waltz with Bashir (Vals im Bashir) (2008)"],[4036.0,2389.0,3.4416073670992047,"Shadow of the Vampire (2000)"],[2036.0,1074.0,2.339851024208566,"Blank Check (1994)"],[4636.0,608.0,2.34375,"Punisher, The (1989)"],[7036.0,1091.0,2.7937671860678277,"Teen Wolf (1985)"],[69436.0,605.0,2.5322314049586776,"Year One (2009)"],[1836.0,1533.0,3.2961513372472275,"Last Days of Disco, The (1998)"],[3036.0,1124.0,3.261120996441281,"Quest for Fire (Guerre du feu, La) (1981)"],[436.0,1239.0,2.6073446327683616,"Color of Night (1994)"],[2636.0,74.0,2.6013513513513513,"Mummy's Ghost, The (1944)"],[3236.0,23.0,2.782608695652174,"Zachariah (1971)"],[5036.0,223.0,3.1121076233183858,"California Suite (1978)"],[6636.0,893.0,3.604703247480403,"Sure Thing, The (1985)"],[7836.0,1017.0,3.887905604719764,"Woodstock (1970)"],[100436.0,58.0,3.8275862068965516,"Gatekeepers, The (2012)"],[33836.0,1381.0,2.610065170166546,"Bewitched (2005)"],[78836.0,347.0,3.670028818443804,"Enter the Void (2009)"],[1436.0,68.0,2.9705882352941178,"Falling in Love Again (1980)"],[6436.0,752.0,3.5997340425531914,"This Boy's Life (1993)"],[8836.0,524.0,3.2786259541984735,"Wicker Park (2004)"],[33036.0,179.0,3.2430167597765363,"Eiger Sanction, The (1975)"],[43836.0,785.0,2.6305732484076434,"Pink Panther, The (2006)"],[7636.0,201.0,2.853233830845771,"Raising Cain (1992)"],[27636.0,88.0,3.4545454545454546,"Herr Lehmann (2003)"],[5636.0,264.0,3.0568181818181817,"Welcome to Collinwood (2002)"],[63436.0,615.0,2.7178861788617885,"Saw V (2008)"],[7236.0,464.0,3.4008620689655173,"Boy and His Dog, A (1975)"],[4836.0,181.0,3.425414364640884,"Competition, The (1980)"],[3436.0,772.0,2.773316062176166,"Dying Young (1991)"],[5436.0,99.0,3.474747474747475,"Horse's Mouth, The (1958)"],[5836.0,269.0,3.3884758364312266,"Houseboat (1958)"],[27036.0,166.0,3.4096385542168677,"Merlin (1998)"],[62836.0,103.0,3.2184466019417477,"Babylon 5: The Lost Tales - Voices in the Dark (2007)"],[75436.0,17.0,2.823529411764706,"Skin, Skin (Käpy selän alla) (1966)"],[4236.0,127.0,3.4173228346456694,"Keep the River on Your Right: A Modern Cannibal Tale (2000)"],[97836.0,109.0,3.1376146788990824,"Here Comes the Boom (2012)"],[55036.0,8.0,2.4375,"Gotti (1996)"],[98836.0,59.0,3.093220338983051,"Hyde Park on Hudson (2012)"],[3636.0,53.0,2.9056603773584904,"Those Who Love Me Can Take the Train (Ceux qui m'aiment prendront le train) (1998)"],[63836.0,24.0,3.0,"Manson Family, The (2003)"],[6236.0,59.0,3.4661016949152543,"Fear Strikes Out (1957)"],[92236.0,38.0,3.6578947368421053,"In Darkness (2011)"],[5236.0,68.0,3.610294117647059,"Tale of Springtime, A (Conte de Printemps) (1990)"],[38036.0,10.0,3.7,"Medea (1988)"],[636.0,35.0,2.9,"Frisk (1995)"],[27236.0,8.0,2.8125,"Charisma (Karisuma) (1999)"],[6036.0,107.0,3.1121495327102804,"Secret Admirer (1985)"],[47836.0,50.0,3.45,"Sketches of Frank Gehry (2005)"],[40436.0,10.0,3.2,"Stratton Story, The (1949)"],[118236.0,1.0,4.5,"Bleak Night (2010)"],[84236.0,26.0,3.7115384615384617,"White Stripes Under Great White Northern Lights, The (2009)"],[107436.0,23.0,3.282608695652174,"Haunter (2013)"],[92836.0,10.0,3.6,"Knuckle (2011) "],[36436.0,13.0,3.4615384615384617,"Holy Girl, The (Niña santa, La) (2004)"],[111436.0,19.0,3.8684210526315788,"Jim Gaffigan: Obsessed (2014)"],[35636.0,34.0,2.8088235294117645,"Teen Witch (1989)"],[74436.0,30.0,2.966666666666667,"Body Bags (1993)"],[106236.0,13.0,3.3846153846153846,"Somm (2012)"],[26436.0,3.0,2.3333333333333335,"Barnens ö (1980)"],[45036.0,4.0,3.625,"Chess Players, The (Shatranj Ke Khilari) (1977)"],[6836.0,23.0,2.5217391304347827,"Amazing Transparent Man, The (1960)"],[8236.0,39.0,3.423076923076923,"While the City Sleeps (1956)"],[87636.0,4.0,3.5,"Run, Man, Run! (Corri uomo corri) (1968)"],[60436.0,14.0,3.142857142857143,"Honeydripper (2007)"],[27436.0,12.0,2.875,"Mockingbird Don't Sing (2001)"],[64236.0,39.0,3.2435897435897436,"Flashbacks of a Fool (2008)"],[87036.0,6.0,3.0833333333333335,"Comedy of Innocence (Comédie de l'innocence) (2000)"],[79236.0,2.0,4.0,"Yumeji (1991)"],[99636.0,12.0,3.7083333333333335,"English Vinglish (2012)"],[103836.0,2.0,2.75,"Black & White & Sex (2012)"],[26236.0,12.0,3.9166666666666665,"White Sun of the Desert, The (Beloe solntse pustyni) (1970)"],[129036.0,1.0,5.0,"People of the Wind (1976)"],[31636.0,20.0,2.8,"Bunker, The (2001)"],[116036.0,3.0,3.0,"Children of the Corn: Revelation (2001)"],[112436.0,11.0,3.5454545454545454,"Very Good Girls (2014)"],[32836.0,7.0,3.5,"Garage Olimpo (1999)"],[84836.0,2.0,1.75,"Spiders, Part 2: The Diamond Ship, The (Die Spinnen, 2. Teil - Das Brillantenschiff) (1920)"],[80836.0,13.0,2.6538461538461537,"Big Buck Bunny (2008)"],[104636.0,15.0,4.233333333333333,"TT3D: Closer to the Edge (2011)"],[79636.0,2.0,3.25,"Inner Life of Martin Frost, The (2007)"],[42636.0,3.0,2.0,"Superproduction (Superprodukcja) (2003)"],[57236.0,8.0,3.1875,"LOL (2006)"],[86436.0,4.0,3.125,"Crimson Kimono, The (1959)"],[66036.0,1.0,3.0,"Wrestling with Alligators (1998)"],[114836.0,2.0,3.25,"Sleeping Car, The (1990)"],[114436.0,3.0,2.6666666666666665,"World of Kanako, The (Kawaki.) (2014)"],[119836.0,2.0,2.0,"The Great Alligator (1979)"],[98036.0,7.0,3.4285714285714284,"Lady, The (2011)"],[121436.0,1.0,1.0,"The Squeeze (1987)"],[130836.0,1.0,1.0,"Fifty/Fifty (1992)"],[84436.0,1.0,2.5,"Less is More (Menos es más) (2000)"],[105236.0,1.0,2.5,"Sorceress (1982)"],[130036.0,3.0,3.5,"Saints and Soldiers: The Void (2014)"],[109436.0,2.0,3.5,"Almost Man, The (Mer eller mindre mann) (2012)"],[96836.0,6.0,3.75,"Either Way (Á annan veg) (2011)"],[111036.0,1.0,2.0,"Attack from Space (1965)"],[113836.0,1.0,2.0,"Among Us (Onder Ons) (2011)"],[100836.0,3.0,2.6666666666666665,"Empty Nest (El nido vacío) (2008)"],[103036.0,1.0,4.0,"No and Me (No et moi) (2010)"],[107636.0,1.0,4.0,"Springsteen & I (2013)"],[82836.0,7.0,3.9285714285714284,"Life of Reilly, The (2006)"],[128836.0,1.0,4.0,"The Ghosts in Our Machine (2013)"],[107836.0,1.0,4.0,"Annie Get Your Gun (1967)"],[104236.0,1.0,3.0,"Criminal Justice (1990)"],[100036.0,10.0,3.05,"Crossfire Hurricane (2012)"],[112236.0,1.0,3.0,"Broadway Idiot (2013)"],[106436.0,1.0,2.5,"For Those in Peril (2013)"],[76836.0,3.0,2.8333333333333335,"Most Beautiful, The (Ichiban utsukushiku) (1944)"],[95036.0,2.0,2.75,"Late Bloomers (2011)"],[59836.0,4.0,2.875,"Blood Alley (1955)"],[102436.0,2.0,2.0,"Affair of the Heart, An (2012)"],[107236.0,1.0,3.0,"Those Daring Young Men in Their Jaunty Jalopies (1969)"],[73236.0,2.0,2.5,"Direct Contact (2009)"],[104436.0,1.0,4.0,"Viagem a Portugal (2011)"],[114236.0,1.0,3.5,"Obama Deception: The Mask Comes Off, The (2009)"],[127236.0,1.0,2.5,"Amnèsia (2002)"],[126036.0,1.0,1.0,"Barbie: A Fashion Fairytale (2010)"],[127636.0,1.0,2.5,"The Strange Affair (1968)"],[97236.0,2.0,3.5,"Shadowing the Third Man (2004)"],[113636.0,1.0,4.0,"Out of Balance: ExxonMobil's Impact on Climate Change (2006)"],[125636.0,1.0,4.5,"Youth of the Son (1952)"],[126436.0,1.0,3.0,"Cosmic Journey (1935)"],[101636.0,1.0,1.0,"Man Called Gannon, A (1968)"],[3037.0,4033.0,3.980287627076618,"Little Big Man (1970)"],[1037.0,7006.0,2.734656009135027,"Lawnmower Man, The (1992)"],[60037.0,1212.0,2.4917491749174916,"Happening, The (2008)"],[65037.0,141.0,3.5390070921985815,"Ben X (2007)"],[78637.0,676.0,3.2758875739644973,"Shrek Forever After (a.k.a. Shrek: The Final Chapter) (2010)"],[637.0,5791.0,2.8384562251769987,"Sgt. Bilko (1996)"],[437.0,1835.0,2.616076294277929,"Cops and Robbersons (1994)"],[237.0,6422.0,3.22454064154469,"Forget Paris (1995)"],[34437.0,2922.0,3.6153319644079396,"Broken Flowers (2005)"],[837.0,5294.0,3.430676237249717,"Matilda (1996)"],[1237.0,4142.0,4.102848865282472,"Seventh Seal, The (Sjunde inseglet, Det) (1957)"],[4037.0,1970.0,3.967766497461929,"House of Games (1987)"],[59037.0,501.0,3.1087824351297404,"Speed Racer (2008)"],[5237.0,749.0,3.4679572763684914,"Taps (1981)"],[27837.0,684.0,2.961988304093567,"Flight of the Phoenix (2004)"],[68237.0,4867.0,4.021060201356072,"Moon (2009)"],[2237.0,400.0,3.6575,"Without Limits (1998)"],[33437.0,1380.0,3.5170289855072463,"Unleashed (Danny the Dog) (2005)"],[2037.0,425.0,3.3188235294117647,"Candleshoe (1977)"],[3837.0,402.0,2.7587064676616917,"Phantasm II (1988)"],[4837.0,194.0,2.8376288659793816,"Cruising (1980)"],[5437.0,358.0,3.2304469273743015,"Manhattan Project, The (1986)"],[77837.0,243.0,3.6419753086419755,"You Don't Know Jack (2010)"],[84637.0,218.0,2.8440366972477062,"Gnomeo & Juliet (2011)"],[6237.0,315.0,3.6714285714285713,"Glenn Miller Story, The (1953)"],[4237.0,244.0,3.69672131147541,"Gleaners & I, The (Les glaneurs et la glaneuse) (2000)"],[99437.0,138.0,3.322463768115942,"John Dies at the End (2012)"],[7037.0,197.0,3.616751269035533,"High Heels (Tacones lejanos) (1991)"],[82037.0,142.0,3.6232394366197185,"Tillman Story, The (2010)"],[31437.0,458.0,3.9366812227074237,"Nobody Knows (Dare mo shiranai) (2004)"],[105037.0,79.0,3.0443037974683542,"To Do List, The (2013)"],[4637.0,188.0,2.132978723404255,"Red Scorpion (1989)"],[88237.0,33.0,3.3484848484848486,"Griff the Invisible (2011)"],[5637.0,471.0,3.7802547770700636,"Flirting (1991)"],[6437.0,78.0,3.4871794871794872,"13 Rue Madeleine (1947)"],[1437.0,317.0,3.673501577287066,"Cement Garden, The (1993)"],[1837.0,488.0,2.6147540983606556,"Odd Couple II, The (1998)"],[51037.0,239.0,3.3619246861924688,"Unknown (2006)"],[62437.0,519.0,3.1917148362235066,"W. (2008)"],[37.0,85.0,3.0176470588235293,"Across the Sea of Time (1995)"],[4437.0,910.0,3.6142857142857143,"Suspiria (1977)"],[2837.0,192.0,3.3125,"Bedrooms & Hallways (1998)"],[64037.0,88.0,3.096590909090909,"Surveillance (2008)"],[3437.0,139.0,1.6654676258992807,"Cool as Ice (1991)"],[86237.0,29.0,3.7758620689655173,"Connections (1978)"],[92637.0,15.0,3.5,"Pitfall (Otoshiana) (1962)"],[2637.0,169.0,2.7071005917159763,"Mummy's Hand, The (1940)"],[88837.0,33.0,3.6515151515151514,"Trotsky, The (2009)"],[2437.0,778.0,3.552056555269923,"Wilde (1997)"],[7237.0,63.0,3.007936507936508,"Last Tycoon, The (1976)"],[57637.0,117.0,3.0811965811965814,"Signal, The (2007)"],[26237.0,82.0,3.518292682926829,"Zabriskie Point (1970)"],[7637.0,128.0,3.3046875,"Irma Vep (1996)"],[6037.0,110.0,2.8227272727272728,"Summer Lovers (1982)"],[7437.0,192.0,3.1145833333333335,"Connie and Carla (2004)"],[6837.0,102.0,3.6372549019607843,"Love Affair (1939)"],[3637.0,158.0,3.7658227848101267,"Vagabond (Sans toit ni loi) (1985)"],[56837.0,29.0,3.0689655172413794,"As You Like It (2006)"],[5837.0,21.0,1.6904761904761905,"Legion of the Dead (2001)"],[5037.0,50.0,3.34,"Long Gray Line, The (1955)"],[8837.0,21.0,2.7857142857142856,"Triggermen (2002)"],[61037.0,47.0,3.5531914893617023,"Silent Light (Stellet licht) (2007)"],[7837.0,40.0,2.9875,"36 fillette (1988)"],[89837.0,89.0,3.230337078651685,"Kill List (2011)"],[52037.0,59.0,3.457627118644068,"Avenue Montaigne (Fauteuils d'orchestre) (2006)"],[8037.0,12.0,3.125,"Non-Stop (1996)"],[90237.0,5.0,4.0,"Examined Life (2008)"],[63237.0,29.0,2.6724137931034484,"Happily Ever After (1993)"],[115437.0,6.0,3.5833333333333335,"Blind (2014)"],[95237.0,38.0,3.236842105263158,"Detention (2012)"],[86837.0,10.0,2.75,"19th Wife, The (2010)"],[91037.0,5.0,3.8,"From Beyond the Grave (Creatures) (1974)"],[6637.0,36.0,3.111111111111111,"Thrashin' (1986)"],[45837.0,54.0,3.4722222222222223,"Let It Be (1970)"],[33237.0,60.0,3.575,"San Francisco (1936)"],[70637.0,35.0,3.6714285714285713,"I Can't Think Straight (2007)"],[49037.0,17.0,3.5294117647058822,"Hi Tessa (Czesc Tereska) (2001)"],[53837.0,13.0,3.4615384615384617,"Swoon (1992)"],[8237.0,7.0,3.2857142857142856,"Way Ahead, The (a.k.a. The Immortal Battalion) (1944)"],[8637.0,13.0,2.6538461538461537,"America's Heart and Soul (2004)"],[37837.0,21.0,3.261904761904762,"Côte d'Azur (Crustacés et coquillages) (2005)"],[92437.0,21.0,3.4523809523809526,"Toast (2010)"],[105837.0,5.0,3.3,"Godzilla vs. SpaceGodzilla (Gojira VS Supesugojira) (1994)"],[83437.0,7.0,3.2142857142857144,"Young in Heart, The (1938)"],[86637.0,2.0,2.25,"1612: Khroniki smutnogo vremeni (2007)"],[52237.0,19.0,3.6315789473684212,"Tarnished Angels, The (1958)"],[83837.0,11.0,3.5454545454545454,"Electric House, The (1922)"],[78037.0,6.0,2.8333333333333335,"Hell's Highway: The True Story of Highway Safety Films (2003)"],[70237.0,5.0,3.1,"Moonshot (2009)"],[103237.0,5.0,3.8,"Sassy Pants (2012)"],[116837.0,2.0,3.25,"The Little Fox (1981)"],[72637.0,2.0,3.0,"Printed Rainbow (2006)"],[93037.0,2.0,3.5,"Her Highness and the Bellboy (1945)"],[98237.0,10.0,3.2,"Price Check (2012)"],[58437.0,6.0,3.0,"Prince of Pennsylvania, The (1988)"],[94837.0,28.0,2.9285714285714284,"Hemingway & Gellhorn (2012)"],[122037.0,1.0,1.0,"The Bone Snatcher (2003)"],[95837.0,3.0,4.666666666666667,"Child's Christmas in Wales, A (1987)"],[72037.0,13.0,3.769230769230769,"Darkness/Light/Darkness (Tma/Svetlo/Tma) (1989)"],[113037.0,2.0,3.5,"Finding Bliss (2009)"],[47237.0,2.0,4.0,"Black Gold (2006)"],[60237.0,4.0,2.75,"Dog Day (Canicule) (1984)"],[120637.0,13.0,3.3461538461538463,"Blackhat (2015)"],[25837.0,7.0,3.5,"Double Wedding (1937)"],[129437.0,1.0,4.5,"Ugly (2013)"],[104837.0,1.0,3.0,"Rage of Honor (1987)"],[110437.0,2.0,2.5,"Forgetting the Girl (2012)"],[3237.0,8.0,2.5625,"Kestrel's Eye (Falkens öga) (1998)"],[102037.0,4.0,2.125,"Breaking Wind (2011)"],[108237.0,2.0,2.75,"HOUBA! On the Trail of the Marsupilami (Sur la piste du Marsupilami) (2012)"],[81637.0,7.0,2.5,"Turtle's Tale: Sammy's Adventures, A (2010)"],[71237.0,1.0,3.5,"Hillsborough (1996)"],[111237.0,1.0,2.0,"Unlawful Killing (2011)"],[62237.0,2.0,3.0,"Part of the Weekend Never Dies (2008)"],[103437.0,5.0,3.1,"Crossfire Trail (Louis L'Amour's 'Crossfire Trail') (2001)"],[103637.0,1.0,3.0,"Arizona Raiders (1965)"],[109237.0,2.0,2.75,"Bhowani Junction (1956)"],[120837.0,2.0,3.25,"Busting (1974)"],[125237.0,1.0,3.5,"The Learning Tree (1969)"],[110637.0,2.0,2.0,"Beauty and the Beast (Beauty and the Beasts: A Dark Tale) (2009)"],[126237.0,1.0,2.5,"Stop Train 349 (1963)"],[66437.0,2.0,3.5,"Man in the Chair (2007)"],[127837.0,1.0,3.0,"Paz! (2002)"],[112637.0,1.0,2.0,"Ultimate Warrior, The (1975)"],[119037.0,1.0,3.0,"Little Italy (1978)"],[93437.0,1.0,2.5,"Deserter (Dezertir) (1933)"],[97037.0,1.0,3.0,"Madonna of the Seven Moons (1945)"],[131237.0,1.0,3.0,"What Men Talk About (2010)"],[3438.0,4951.0,2.813371036154312,"Teenage Mutant Ninja Turtles (1990)"],[7438.0,18684.0,3.869085848854635,"Kill Bill: Vol. 2 (2004)"],[4638.0,6668.0,2.645620875824835,"Jurassic Park III (2001)"],[838.0,7938.0,3.7961073318216174,"Emma (1996)"],[38038.0,4436.0,3.787195671776375,"Wallace & Gromit in The Curse of the Were-Rabbit (2005)"],[2238.0,594.0,3.8585858585858586,"Seven Beauties (Pasqualino Settebellezze) (1976)"],[8638.0,3449.0,3.9375181211945494,"Before Sunset (2004)"],[1438.0,5933.0,2.8168717343670995,"Dante's Peak (1997)"],[3638.0,4680.0,3.1476495726495726,"Moonraker (1979)"],[4238.0,2795.0,3.244186046511628,"Along Came a Spider (2001)"],[1238.0,3194.0,3.96665623043206,"Local Hero (1983)"],[4838.0,83.0,3.1144578313253013,"D.O.A. (1980)"],[3238.0,1254.0,2.3361244019138754,"Eye of the Beholder (1999)"],[5038.0,193.0,3.7072538860103625,"Flight of Dragons, The (1982)"],[3038.0,608.0,4.048519736842105,"Face in the Crowd, A (1957)"],[638.0,581.0,3.284853700516351,"Jack and Sarah (1995)"],[38.0,552.0,2.857789855072464,"It Takes Two (1995)"],[438.0,1054.0,2.7120493358633775,"Cowboy Way, The (1994)"],[1038.0,233.0,3.227467811158798,"Unhook the Stars (1996)"],[2038.0,1230.0,2.8853658536585365,"Cat from Outer Space, The (1978)"],[3838.0,210.0,2.45,"Phantasm III: Lord of the Dead (1994)"],[4038.0,119.0,3.19327731092437,"Kill Me Again (1989)"],[5438.0,761.0,2.657687253613666,"Men at Work (1990)"],[5638.0,439.0,2.907744874715262,"Godzilla vs. Mothra (Mosura tai Gojira) (1964)"],[238.0,834.0,3.1690647482014387,"Far From Home: The Adventures of Yellow Dog (1995)"],[5838.0,103.0,3.2135922330097086,"Madame Bovary (1991)"],[6238.0,1260.0,2.971031746031746,"Green Card (1990)"],[26838.0,208.0,3.641826923076923,"Snapper, The (1993)"],[68838.0,61.0,3.6147540983606556,"Every Little Step (2008)"],[106438.0,418.0,3.860047846889952,"Philomena (2013)"],[27838.0,690.0,3.5768115942028986,"Mean Creek (2004)"],[8838.0,559.0,3.6887298747763864,"Alice Doesn't Live Here Anymore (1974)"],[53038.0,58.0,3.5948275862068964,"Red Dust (1932)"],[71838.0,893.0,3.616461366181411,"Law Abiding Citizen (2009)"],[75438.0,35.0,2.7857142857142856,"Nine Dead (2010)"],[5238.0,236.0,3.694915254237288,"Return of the Secaucus 7 (1980)"],[8238.0,47.0,3.382978723404255,"Little Murders (1971)"],[33838.0,174.0,3.5344827586206895,"Rize (2005)"],[51638.0,76.0,3.3092105263157894,"Westerner, The (1940)"],[6038.0,64.0,3.21875,"Tune in Tomorrow... (1990)"],[104638.0,5.0,1.9,"Planet of the Future, The (2010)"],[2638.0,178.0,2.7275280898876404,"Mummy's Tomb, The (1942)"],[93838.0,464.0,3.6508620689655173,"The Raid: Redemption (2011)"],[26638.0,12.0,2.4166666666666665,"Prison (1988)"],[27238.0,28.0,3.017857142857143,"Guest House Paradiso (1999)"],[85438.0,396.0,3.7512626262626263,"Jane Eyre (2011)"],[6438.0,42.0,3.2738095238095237,"633 Squadron (1964)"],[52838.0,107.0,2.8598130841121496,"Year of the Dog (2007)"],[7238.0,252.0,3.8551587301587302,"Ashes and Diamonds (Popiól i diament) (1958)"],[6638.0,417.0,3.274580335731415,"Valley Girl (1983)"],[43838.0,46.0,2.5543478260869565,"Troll (1986)"],[7038.0,184.0,3.421195652173913,"Things You Can Tell Just by Looking at Her (2000)"],[59838.0,13.0,2.9615384615384617,"Chato's Land (1972)"],[4438.0,399.0,3.710526315789474,"Fist of Fury (Chinese Connection, The) (Jing wu men) (1972)"],[44238.0,69.0,1.9782608695652173,"Leprechaun 2 (1994)"],[7638.0,50.0,3.18,"Buck Privates (1941)"],[26038.0,64.0,3.5390625,"Teacher's Pet (1958)"],[78838.0,17.0,2.764705882352941,"Cry of the Owl, The (2009)"],[89638.0,23.0,3.630434782608696,"Nothing Personal (2009)"],[74438.0,25.0,3.02,"Legend of the Red Dragon (a.k.a. New Legend of Shaolin, The) (Hong Xi Guan: Zhi Shao Lin wu zu) (1994)"],[99638.0,8.0,3.625,"Fish Story (Fisshu sutôrî) (2009)"],[34238.0,23.0,3.5652173913043477,"Symmetry (Symetria) (2003)"],[78438.0,9.0,3.388888888888889,"Edge of the City (1957)"],[71438.0,80.0,3.7,"Still Walking (Aruitemo aruitemo) (2008)"],[98838.0,17.0,2.2941176470588234,"Lay the Favorite (2012)"],[31038.0,43.0,2.9069767441860463,"Smooth Talk (1985)"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"movieId","type":"\"integer\""},{"name":"count","type":"\"long\""},{"name":"average","type":"\"double\""},{"name":"title","type":"\"string\""}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.473120832424E12,"submitTime":1.473120738519E12,"finishTime":1.473120833608E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1128.181818","height":"82.18181799999999","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8d4bd6b1-c915-4d8b-8c7e-e920305862d9"},{"version":"CommandV1","origId":36148146263663,"guid":"4a6fe220-6f2c-4812-ba71-d775490192f3","subtype":"command","commandType":"auto","position":23.0,"command":"movies_with_500_ratings_or_more = movie_names_with_avg_ratings_df.filter(F.col('count')>=500)\nprint 'Movies with highest ratings:'\nmovies_with_500_ratings_or_more.show(20, truncate=False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Movies with highest ratings:\n+-------+-----+------------------+-----------------------------------------+\n|movieId|count|average           |title                                    |\n+-------+-----+------------------+-----------------------------------------+\n|1831   |7463 |2.5785207021305103|Lost in Space (1998)                     |\n|431    |8946 |3.695059244355019 |Carlito&apos;s Way (1993)                     |\n|631    |2193 |2.7273141814865483|All Dogs Go to Heaven 2 (1996)           |\n|231    |32085|2.9524700015583605|Dumb &amp; Dumber (Dumb and Dumber) (1994)   |\n|32031  |1777 |3.270962296004502 |Robots (2005)                            |\n|45431  |2059 |3.416221466731423 |Over the Hedge (2006)                    |\n|2231   |6759 |3.727400503032993 |Rounders (1998)                          |\n|2431   |6045 |3.109677419354839 |Patch Adams (1998)                       |\n|4031   |1047 |2.89207258834766  |All the Pretty Horses (2000)             |\n|31     |9435 |3.250344462109168 |Dangerous Minds (1995)                   |\n|1231   |7902 |3.9474816502151353|Right Stuff, The (1983)                  |\n|3831   |1564 |3.6620843989769822|Saving Grace (2000)                      |\n|27831  |2883 |3.7835587929240373|Layer Cake (2004)                        |\n|1031   |4227 |3.329548142890939 |Bedknobs and Broomsticks (1971)          |\n|4231   |996  |3.0737951807228914|Someone Like You (2001)                  |\n|1431   |2931 |2.571989082224497 |Beverly Hills Ninja (1997)               |\n|39231  |1097 |3.1180492251595258|Elizabethtown (2005)                     |\n|80831  |581  |3.621342512908778 |Let Me In (2010)                         |\n|32     |44980|3.8980546909737663|Twelve Monkeys (a.k.a. 12 Monkeys) (1995)|\n|832    |14347|3.4579354568899423|Ransom (1996)                            |\n+-------+-----+------------------+-----------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.473120833632E12,"submitTime":1.47312073854E12,"finishTime":1.473120835055E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"08367e8e-04c9-4445-8f13-abd840353e36"},{"version":"CommandV1","origId":36148146263664,"guid":"5e45a47e-72de-4fa6-8a38-f36057096265","subtype":"command","commandType":"auto","position":23.5,"command":"movies_with_500_ratings_or_more.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">15</span><span class=\"ansired\">]: </span>4489\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.473120835063E12,"submitTime":1.47312073855E12,"finishTime":1.473120837084E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"27f07f92-fd40-461f-9108-75afdf216dd7"},{"version":"CommandV1","origId":36148146263665,"guid":"dc0322bb-8813-4167-ae2f-ec4101d1d746","subtype":"command","commandType":"auto","position":24.0,"command":"# TEST Movies with Highest Average Ratings and more than 500 Reviews (1b)\n\nTest.assertEquals(movies_with_500_ratings_or_more.count(), 4489,\n                  'incorrect movies_with_500_ratings_or_more.count(). Expected 4489.')\ntop_20_results = [(r['average'], r['title'], r['count']) for r in movies_with_500_ratings_or_more.orderBy(F.desc('average')).take(20)]\n\nTest.assertEquals(top_20_results,\n                  [(4.446990499637029, u'Shawshank Redemption, The (1994)', 63366),\n                   (4.364732196832306, u'Godfather, The (1972)', 41355),\n                   (4.334372207803259, u'Usual Suspects, The (1995)', 47006),\n                   (4.310175010988133, u\"Schindler's List (1993)\", 50054),\n                   (4.275640557704942, u'Godfather: Part II, The (1974)', 27398),\n                   (4.2741796572216, u'Seven Samurai (Shichinin no samurai) (1954)', 11611),\n                   (4.271333600779414, u'Rear Window (1954)', 17449),\n                   (4.263182346109176, u'Band of Brothers (2001)', 4305),\n                   (4.258326830670664, u'Casablanca (1942)', 24349),\n                   (4.256934865900383, u'Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)', 6525),\n                   (4.24807897901911, u\"One Flew Over the Cuckoo's Nest (1975)\", 29932),\n                   (4.247286821705426, u'Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb (1964)', 23220),\n                   (4.246001523229246, u'Third Man, The (1949)', 6565),\n                   (4.235410064157069, u'City of God (Cidade de Deus) (2002)', 12937),\n                   (4.2347902097902095, u'Lives of Others, The (Das leben der Anderen) (2006)', 5720),\n                   (4.233538107122288, u'North by Northwest (1959)', 15627),\n                   (4.2326233183856505, u'Paths of Glory (1957)', 3568),\n                   (4.227123123722136, u'Fight Club (1999)', 40106),\n                   (4.224281931146873, u'Double Indemnity (1944)', 4909),\n                   (4.224137931034483, u'12 Angry Men (1957)', 12934)],\n                  'Incorrect top 20 movies with 500 or more ratings')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.4731208371E12,"submitTime":1.47312073856E12,"finishTime":1.473120850793E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f5df42d3-863a-45fc-8e20-47c49d569fd4"},{"version":"CommandV1","origId":36148146263666,"guid":"4701154d-64b4-4033-a00c-030131e70643","subtype":"command","commandType":"auto","position":25.0,"command":"%md\nUsing a threshold on the number of reviews is one way to improve the recommendations, but there are many other good ways to improve quality. For example, you could weight ratings by the number of ratings.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.47312073857E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f75434c9-26f8-4ddc-8ca0-6664d8157d11"},{"version":"CommandV1","origId":36148146263667,"guid":"b75c943e-d2a3-4092-8544-659dea963149","subtype":"command","commandType":"auto","position":26.0,"command":"%md\n## Part 2: Collaborative Filtering\nIn this course, you have learned about many of the basic transformations and actions that Spark allows us to apply to distributed datasets.  Spark also exposes some higher level functionality; in particular, Machine Learning using a component of Spark called [MLlib][mllib].  In this part, you will learn how to use MLlib to make personalized movie recommendations using the movie data we have been analyzing.\n\n<img src=\"https://courses.edx.org/c4x/BerkeleyX/CS100.1x/asset/Collaborative_filtering.gif\" alt=\"collaborative filtering\" style=\"float: right\"/>\n\nWe are going to use a technique called [collaborative filtering][collab]. Collaborative filtering is a method of making automatic predictions (filtering) about the interests of a user by collecting preferences or taste information from many users (collaborating). The underlying assumption of the collaborative filtering approach is that if a person A has the same opinion as a person B on an issue, A is more likely to have B's opinion on a different issue x than to have the opinion on x of a person chosen randomly. You can read more about collaborative filtering [here][collab2].\n\nThe image at the right (from [Wikipedia][collab]) shows an example of predicting of the user's rating using collaborative filtering. At first, people rate different items (like videos, images, games). After that, the system is making predictions about a user's rating for an item, which the user has not rated yet. These predictions are built upon the existing ratings of other users, who have similar ratings with the active user. For instance, in the image below the system has made a prediction, that the active user will not like the video.\n\n<br clear=\"all\"/>\n\n----\n\nFor movie recommendations, we start with a matrix whose entries are movie ratings by users (shown in red in the diagram below).  Each column represents a user (shown in green) and each row represents a particular movie (shown in blue).\n\nSince not all users have rated all movies, we do not know all of the entries in this matrix, which is precisely why we need collaborative filtering.  For each user, we have ratings for only a subset of the movies.  With collaborative filtering, the idea is to approximate the ratings matrix by factorizing it as the product of two matrices: one that describes properties of each user (shown in green), and one that describes properties of each movie (shown in blue).\n\n<img alt=\"factorization\" src=\"http://spark-mooc.github.io/web-assets/images/matrix_factorization.png\" style=\"width: 885px\"/>\n<br clear=\"all\"/>\n\nWe want to select these two matrices such that the error for the users/movie pairs where we know the correct ratings is minimized.  The [Alternating Least Squares][als] algorithm does this by first randomly filling the users matrix with values and then optimizing the value of the movies such that the error is minimized.  Then, it holds the movies matrix constrant and optimizes the value of the user's matrix.  This alternation between which matrix to optimize is the reason for the \"alternating\" in the name.\n\nThis optimization is what's being shown on the right in the image above.  Given a fixed set of user factors (i.e., values in the users matrix), we use the known ratings to find the best values for the movie factors using the optimization written at the bottom of the figure.  Then we \"alternate\" and pick the best user factors given fixed movie factors.\n\nFor a simple example of what the users and movies matrices might look like, check out the [videos from Lecture 2][videos] or the [slides from Lecture 8][slides]\n[videos]: https://courses.edx.org/courses/course-v1:BerkeleyX+CS110x+2T2016/courseware/9d251397874d4f0b947b606c81ccf83c/3cf61a8718fe4ad5afcd8fb35ceabb6e/\n[slides]: https://d37djvu3ytnwxt.cloudfront.net/assets/courseware/v1/fb269ff9a53b669a46d59e154b876d78/asset-v1:BerkeleyX+CS110x+2T2016+type@asset+block/Lecture2s.pdf\n[als]: https://en.wikiversity.org/wiki/Least-Squares_Method\n[mllib]: http://spark.apache.org/docs/1.6.2/mllib-guide.html\n[collab]: https://en.wikipedia.org/?title=Collaborative_filtering\n[collab2]: http://recommender-systems.org/collaborative-filtering/","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.47312073859E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a72bf9a7-f40b-4c64-9e1c-3e09560bce3f"},{"version":"CommandV1","origId":36148146263668,"guid":"dfd8a5fa-caf4-4b50-b97a-8fb74b20b786","subtype":"command","commandType":"auto","position":27.0,"command":"%md\n### (2a) Creating a Training Set\n\nBefore we jump into using machine learning, we need to break up the `ratings_df` dataset into three pieces:\n* A training set (DataFrame), which we will use to train models\n* A validation set (DataFrame), which we will use to choose the best model\n* A test set (DataFrame), which we will use for our experiments\n\nTo randomly split the dataset into the multiple groups, we can use the pySpark [randomSplit()](http://spark.apache.org/docs/1.6.2/api/python/pyspark.sql.html#pyspark.sql.DataFrame.randomSplit) transformation. `randomSplit()` takes a set of splits and a seed and returns multiple DataFrames.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738606E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5355719e-63ed-48bf-8dce-966bfb321f66"},{"version":"CommandV1","origId":36148146263669,"guid":"47ec0d5b-95b7-46f7-93a0-e973073d493a","subtype":"command","commandType":"auto","position":28.0,"command":"# We'll hold out 60% for training, 20% of our data for validation, and leave 20% for testing\nseed = 1800009193L\n(split_60_df, split_a_20_df, split_b_20_df) = ratings_df.randomSplit([6., 2., 2.], seed)\n\n# Let's cache these datasets for performance\ntraining_df = split_60_df.cache()\nvalidation_df = split_a_20_df.cache()\ntest_df = split_b_20_df.cache()\n\nprint('Training: {0}, validation: {1}, test: {2}\\n'.format(\n  training_df.count(), validation_df.count(), test_df.count())\n)\ntraining_df.show(3)\nvalidation_df.show(3)\ntest_df.show(3)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Training: 12001389, validation: 4003694, test: 3995180\n\n+------+-------+------+\n|userId|movieId|rating|\n+------+-------+------+\n|     1|      2|   3.5|\n|     1|     29|   3.5|\n|     1|     47|   3.5|\n+------+-------+------+\nonly showing top 3 rows\n\n+------+-------+------+\n|userId|movieId|rating|\n+------+-------+------+\n|     1|     32|   3.5|\n|     1|    253|   4.0|\n|     1|    293|   4.0|\n+------+-------+------+\nonly showing top 3 rows\n\n+------+-------+------+\n|userId|movieId|rating|\n+------+-------+------+\n|     1|    112|   3.5|\n|     1|    151|   4.0|\n|     1|    318|   4.0|\n+------+-------+------+\nonly showing top 3 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"java.lang.ClassCastException: java.lang.Integer cannot be cast to java.lang.Double","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-22-eff39c245527&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansired\"># We&apos;ll hold out 60% for training, 20% of our data for validation, and leave 20% for testing</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> seed <span class=\"ansiyellow\">=</span> <span class=\"ansicyan\">1800009193L</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 5</span><span class=\"ansiyellow\"> </span><span class=\"ansiyellow\">(</span>split_60_df<span class=\"ansiyellow\">,</span> split_a_20_df<span class=\"ansiyellow\">,</span> split_b_20_df<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">=</span> ratings_df<span class=\"ansiyellow\">.</span>randomSplit<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">6</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">2</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">2</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> seed<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      6</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span> <span class=\"ansired\"># Let&apos;s cache these datasets for performance</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">randomSplit</span><span class=\"ansiblue\">(self, weights, seed)</span>\n<span class=\"ansigreen\">    560</span>                 <span class=\"ansigreen\">raise</span> ValueError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Weights must be positive. Found weight value: %s&quot;</span> <span class=\"ansiyellow\">%</span> w<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    561</span>         seed <span class=\"ansiyellow\">=</span> seed <span class=\"ansigreen\">if</span> seed <span class=\"ansigreen\">is</span> <span class=\"ansigreen\">not</span> None <span class=\"ansigreen\">else</span> random<span class=\"ansiyellow\">.</span>randint<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">,</span> sys<span class=\"ansiyellow\">.</span>maxsize<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 562</span><span class=\"ansiyellow\">         </span>rdd_array <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>randomSplit<span class=\"ansiyellow\">(</span>_to_list<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">.</span>_sc<span class=\"ansiyellow\">,</span> weights<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> long<span class=\"ansiyellow\">(</span>seed<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    563</span>         <span class=\"ansigreen\">return</span> <span class=\"ansiyellow\">[</span>DataFrame<span class=\"ansiyellow\">(</span>rdd<span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">for</span> rdd <span class=\"ansigreen\">in</span> rdd_array<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    564</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    811</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    812</span>         return_value = get_return_value(\n<span class=\"ansigreen\">--&gt; 813</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">    814</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    815</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     43</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     44</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 45</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     46</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     47</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    306</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    307</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 308</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    309</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    310</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o139.randomSplit.\n: java.lang.ClassCastException: java.lang.Integer cannot be cast to java.lang.Double\n\tat scala.runtime.BoxesRunTime.unboxToDouble(BoxesRunTime.java:119)\n\tat scala.runtime.ScalaRunTime$.array_update(ScalaRunTime.scala:91)\n\tat scala.collection.IterableLike$class.copyToArray(IterableLike.scala:237)\n\tat scala.collection.AbstractIterable.copyToArray(Iterable.scala:54)\n\tat scala.collection.TraversableOnce$class.copyToArray(TraversableOnce.scala:241)\n\tat scala.collection.AbstractTraversable.copyToArray(Traversable.scala:105)\n\tat scala.collection.TraversableOnce$class.toArray(TraversableOnce.scala:249)\n\tat scala.collection.AbstractTraversable.toArray(Traversable.scala:105)\n\tat org.apache.spark.sql.DataFrame.randomSplit(DataFrame.scala:1097)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:497)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:231)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:381)\n\tat py4j.Gateway.invoke(Gateway.java:259)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:133)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:209)\n\tat java.lang.Thread.run(Thread.java:745)\n\n</div>","workflows":[],"startTime":1.473120850803E12,"submitTime":1.47312073863E12,"finishTime":1.473120858228E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ea5b9383-e818-4cf1-93ba-9d1486bbd94e"},{"version":"CommandV1","origId":36148146263670,"guid":"d3047b04-b278-4383-9b0f-5bc50253a2f6","subtype":"command","commandType":"auto","position":29.0,"command":"# TEST Creating a Training Set (2a)\nTest.assertEquals(training_df.count(), 12001389, \"Incorrect training_df count. Expected 12001389\")\nTest.assertEquals(validation_df.count(), 4003694, \"Incorrect validation_df count. Expected 4003694\")\nTest.assertEquals(test_df.count(), 3995180, \"Incorrect test_df count. Expected 3995180\")\n\nTest.assertEquals(training_df.filter((ratings_df.userId == 1) & (ratings_df.movieId == 5952) & (ratings_df.rating == 5.0)).count(), 1)\nTest.assertEquals(training_df.filter((ratings_df.userId == 1) & (ratings_df.movieId == 1193) & (ratings_df.rating == 3.5)).count(), 1)\nTest.assertEquals(training_df.filter((ratings_df.userId == 1) & (ratings_df.movieId == 1196) & (ratings_df.rating == 4.5)).count(), 1)\n\nTest.assertEquals(validation_df.filter((ratings_df.userId == 1) & (ratings_df.movieId == 296) & (ratings_df.rating == 4.0)).count(), 1)\nTest.assertEquals(validation_df.filter((ratings_df.userId == 1) & (ratings_df.movieId == 32) & (ratings_df.rating == 3.5)).count(), 1)\nTest.assertEquals(validation_df.filter((ratings_df.userId == 1) & (ratings_df.movieId == 6888) & (ratings_df.rating == 3.0)).count(), 1)\n\nTest.assertEquals(test_df.filter((ratings_df.userId == 1) & (ratings_df.movieId == 4993) & (ratings_df.rating == 5.0)).count(), 1)\nTest.assertEquals(test_df.filter((ratings_df.userId == 1) & (ratings_df.movieId == 4128) & (ratings_df.rating == 4.0)).count(), 1)\nTest.assertEquals(test_df.filter((ratings_df.userId == 1) & (ratings_df.movieId == 4915) & (ratings_df.rating == 3.0)).count(), 1)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.473120858234E12,"submitTime":1.473120738643E12,"finishTime":1.473120860252E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2ade28c2-0bdb-4676-9683-b710af76b79e"},{"version":"CommandV1","origId":36148146263671,"guid":"1bcd4142-c7c5-48a9-b2ad-83d0589b7c2f","subtype":"command","commandType":"auto","position":30.0,"command":"%md\nAfter splitting the dataset, your training set has about 12 million entries and the validation and test sets each have about 4 million entries. (The exact number of entries in each dataset varies slightly due to the random nature of the `randomSplit()` transformation.)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738652E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"04f77c16-8663-4b32-a494-a75c9bf22499"},{"version":"CommandV1","origId":36148146263672,"guid":"3fb36bcf-31b9-4a9d-9aa9-a6c8f1ccca4e","subtype":"command","commandType":"auto","position":31.0,"command":"%md\n### (2b) Alternating Least Squares\n\nIn this part, we will use the Apache Spark ML Pipeline implementation of Alternating Least Squares, [ALS](http://spark.apache.org/docs/1.6.2/api/python/pyspark.ml.html#pyspark.ml.recommendation.ALS). ALS takes a training dataset (DataFrame) and several parameters that control the model creation process. To determine the best values for the parameters, we will use ALS to train several models, and then we will select the best model and use the parameters from that model in the rest of this lab exercise.\n\nThe process we will use for determining the best model is as follows:\n1. Pick a set of model parameters. The most important parameter to model is the *rank*, which is the number of rows in the Users matrix (green in the diagram above) or the number of columns in the Movies matrix (blue in the diagram above). In general, a lower rank will mean higher error on the training dataset, but a high rank may lead to [overfitting](https://en.wikipedia.org/wiki/Overfitting).  We will train models with ranks of 4, 8, and 12 using the `training_df` dataset.\n\n2. Set the appropriate parameters on the `ALS` object:\n    * The \"User\" column will be set to the values in our `userId` DataFrame column.\n    * The \"Item\" column will be set to the values in our `movieId` DataFrame column.\n    * The \"Rating\" column will be set to the values in our `rating` DataFrame column.\n    * We'll using a regularization parameter of 0.1.\n\n   **Note**: Read the documentation for the [ALS](http://spark.apache.org/docs/1.6.2/api/python/pyspark.ml.html#pyspark.ml.recommendation.ALS) class **carefully**. It will help you accomplish this step.\n3. Have the ALS output transformation (i.e., the result of [ALS.fit()](http://spark.apache.org/docs/1.6.2/api/python/pyspark.ml.html#pyspark.ml.recommendation.ALS.fit)) produce a _new_ column\n   called \"prediction\" that contains the predicted value.\n\n4. Create multiple models using [ALS.fit()](http://spark.apache.org/docs/1.6.2/api/python/pyspark.ml.html#pyspark.ml.recommendation.ALS.fit), one for each of our rank values. We'll fit\n   against the training data set (`training_df`).\n\n5. For each model, we'll run a prediction against our validation data set (`validation_df`) and check the error.\n\n6. We'll keep the model with the best error rate.\n\n#### Why are we doing our own cross-validation?\n\nA challenge for collaborative filtering is how to provide ratings to a new user (a user who has not provided *any* ratings at all). Some recommendation systems choose to provide new users with a set of default ratings (e.g., an average value across all ratings), while others choose to provide no ratings for new users. Spark's ALS algorithm yields a NaN (`Not a Number`) value when asked to provide a rating for a new user.\n\nUsing the ML Pipeline's [CrossValidator](http://spark.apache.org/docs/1.6.2/api/python/pyspark.ml.html#pyspark.ml.tuning.CrossValidator) with ALS is thus problematic, because cross validation involves dividing the training data into a set of folds (e.g., three sets) and then using those folds for testing and evaluating the parameters during the parameter grid search process. It is likely that some of the folds will contain users that are not in the other folds, and, as a result, ALS produces NaN values for those new users. When the CrossValidator uses the Evaluator (RMSE) to compute an error metric, the RMSE algorithm will return NaN. This will make *all* of the parameters in the parameter grid appear to be equally good (or bad).\n\nYou can read the discussion on [Spark JIRA 14489](https://issues.apache.org/jira/browse/SPARK-14489) about this issue. There are proposed workarounds of having ALS provide default values or having RMSE drop NaN values. Both introduce potential issues. We have chosen to have RMSE drop NaN values. While this does not solve the underlying issue of ALS not predicting a value for a new user, it does provide some evaluation value. We manually implement the parameter grid search process using a for loop (below) and remove the NaN values before using RMSE.\n\nFor a production application, you would want to consider the tradeoffs in how to handle new users.\n\n**Note**: This cell will likely a couple of minutes to run.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738671E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aa9f813b-841c-4725-b2b8-bf6ab7b3891b"},{"version":"CommandV1","origId":36148146263673,"guid":"8bed996a-a977-4bd3-9a9b-d387c50766a0","subtype":"command","commandType":"auto","position":32.0,"command":"# This step is broken in ML Pipelines: https://issues.apache.org/jira/browse/SPARK-14489\nfrom pyspark.ml.recommendation import ALS\n\n# Let's initialize our ALS learner\nals = ALS()\n\n# Now we set the parameters for the method\nals.setMaxIter(5)\\\n   .setSeed(seed)\\\n   .setRegParam(0.1)\\\n   .setUserCol(\"userId\")\\\n   .setItemCol(\"movieId\")\\\n   .setRatingCol(\"rating\")\n\n# Now let's compute an evaluation metric for our test dataset\nfrom pyspark.ml.evaluation import RegressionEvaluator\n\n# Create an RMSE evaluator using the label and predicted columns\nreg_eval = RegressionEvaluator(predictionCol=\"prediction\", labelCol=\"rating\", metricName=\"rmse\")\n\ntolerance = 0.03\nranks = [4, 8, 12]\nerrors = [0, 0, 0]\nmodels = [0, 0, 0]\nerr = 0\nmin_error = float('inf')\nbest_rank = -1\nfor rank in ranks:\n  # Set the rank here:\n  als.setRank(rank)\n  # Create the model with these parameters.\n  model = als.fit(training_df)\n  # Run the model to create a prediction. Predict against the validation_df.\n  predict_df = model.transform(validation_df)\n\n  # Remove NaN values from prediction (due to SPARK-14489)\n  predicted_ratings_df = predict_df.filter(predict_df.prediction != float('nan'))\n\n  # Run the previously created RMSE evaluator, reg_eval, on the predictedRatingsDF DataFrame\n  error = reg_eval.evaluate(predicted_ratings_df)\n  errors[err] = error\n  models[err] = model\n  print 'For rank %s the RMSE is %s' % (rank, error)\n  if error < min_error:\n    min_error = error\n    best_rank = err\n  err += 1\n\nals.setRank(ranks[best_rank])\nprint 'The best model was trained with rank %s' % ranks[best_rank]\nmy_model = models[best_rank]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">For rank 4 the RMSE is 0.82825406832\nFor rank 8 the RMSE is 0.816154128069\nFor rank 12 the RMSE is 0.810037726846\nThe best model was trained with rank 12\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: &apos;RegressionEvaluator&apos; object is not callable","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-21-09b36513d5b7&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     34</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     35</span>   <span class=\"ansired\"># Run the previously created RMSE evaluator, reg_eval, on the predictedRatingsDF DataFrame</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 36</span><span class=\"ansiyellow\">   </span>error <span class=\"ansiyellow\">=</span> reg_eval<span class=\"ansiyellow\">(</span>predicted_ratings_df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     37</span>   errors<span class=\"ansiyellow\">[</span>err<span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> error<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     38</span>   models<span class=\"ansiyellow\">[</span>err<span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">=</span> model<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: &apos;RegressionEvaluator&apos; object is not callable\n</div>","workflows":[],"startTime":1.473122041131E12,"submitTime":1.473122039548E12,"finishTime":1.473122193966E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fe63fb8a-e3d4-43cb-acbe-3ab6e6cbf1c3"},{"version":"CommandV1","origId":36148146263674,"guid":"b09fe700-b1bc-4a4e-bd10-ad2cedcc5882","subtype":"command","commandType":"auto","position":33.0,"command":"# TEST\nTest.assertEquals(round(min_error, 2), 0.81, \"Unexpected value for best RMSE. Expected rounded value to be 0.81. Got {0}\".format(round(min_error, 2)))\nTest.assertEquals(ranks[best_rank], 12, \"Unexpected value for best rank. Expected 12. Got {0}\".format(ranks[best_rank]))\nTest.assertEqualsHashed(als.getItemCol(), \"18f0e2357f8829fe809b2d95bc1753000dd925a6\", \"Incorrect choice of {0} for ALS item column.\".format(als.getItemCol()))\nTest.assertEqualsHashed(als.getUserCol(), \"db36668fa9a19fde5c9676518f9e86c17cabf65a\", \"Incorrect choice of {0} for ALS user column.\".format(als.getUserCol()))\nTest.assertEqualsHashed(als.getRatingCol(), \"3c2d687ef032e625aa4a2b1cfca9751d2080322c\", \"Incorrect choice of {0} for ALS rating column.\".format(als.getRatingCol()))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.473122202201E12,"submitTime":1.473122200614E12,"finishTime":1.473122202275E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9feda12f-4068-42e0-bfbc-22fe1603fa54"},{"version":"CommandV1","origId":36148146263675,"guid":"e0809512-ce60-4dba-aa3a-2a0d1be1dfa8","subtype":"command","commandType":"auto","position":34.0,"command":"%md\n### (2c) Testing Your Model\n\nSo far, we used the `training_df` and `validation_df` datasets to select the best model.  Since we used these two datasets to determine what model is best, we cannot use them to test how good the model is; otherwise, we would be very vulnerable to [overfitting](https://en.wikipedia.org/wiki/Overfitting).  To decide how good our model is, we need to use the `test_df` dataset.  We will use the `best_rank` you determined in part (2b) to create a model for predicting the ratings for the test dataset and then we will compute the RMSE.\n\nThe steps you should perform are:\n* Run a prediction, using `my_model` as created above, on the test dataset (`test_df`), producing a new `predict_df` DataFrame.\n* Filter out unwanted NaN values (necessary because of [a bug in Spark](https://issues.apache.org/jira/browse/SPARK-14489)). We've supplied this piece of code for you.\n* Use the previously created RMSE evaluator, `reg_eval` to evaluate the filtered DataFrame.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738706E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"609e9304-76fb-4c3b-8235-5d6cee88e9ac"},{"version":"CommandV1","origId":36148146263676,"guid":"7ee306b9-bf1a-4f8e-99f3-ff075c071d21","subtype":"command","commandType":"auto","position":35.0,"command":"# In ML Pipelines, this next step has a bug that produces unwanted NaN values. We\n# have to filter them out. See https://issues.apache.org/jira/browse/SPARK-14489\npredict_df = my_model.transform(test_df)\n\n# Remove NaN values from prediction (due to SPARK-14489)\npredicted_test_df = predict_df.filter(predict_df.prediction != float('nan'))\n\n# Run the previously created RMSE evaluator, reg_eval, on the predicted_test_df DataFrame\ntest_RMSE = reg_eval.evaluate(predicted_test_df)\n\nprint('The model had a RMSE on the test set of {0}'.format(test_RMSE))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">The model had a RMSE on the test set of 0.809624038485\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.473122498365E12,"submitTime":1.473122496772E12,"finishTime":1.473122508817E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"eea65bd4-7ead-4b0f-8852-f07ef30cbfaa"},{"version":"CommandV1","origId":36148146263677,"guid":"b5295d3d-2416-4c58-a0be-eee9ed89177c","subtype":"command","commandType":"auto","position":36.0,"command":"# TEST Testing Your Model (2c)\nTest.assertTrue(abs(test_RMSE - 0.809624038485) < tolerance, 'incorrect test_RMSE: {0:.11f}'.format(test_RMSE))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.473122515968E12,"submitTime":1.473122514375E12,"finishTime":1.473122516041E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"90d46125-bb8c-4837-a217-aa1a1cfe89b7"},{"version":"CommandV1","origId":36148146263678,"guid":"a6d18e9d-1720-40aa-be80-130f2c18ede1","subtype":"command","commandType":"auto","position":37.0,"command":"%md\n### (2d) Comparing Your Model\n\nLooking at the RMSE for the results predicted by the model versus the values in the test set is one way to evalute the quality of our model. Another way to evaluate the model is to evaluate the error from a test set where every rating is the average rating for the training set.\n\nThe steps you should perform are:\n* Use the `training_df` to compute the average rating across all movies in that training dataset.\n* Use the average rating that you just determined and the `test_df` to create a DataFrame (`test_for_avg_df`) with a `prediction` column containing the average rating. **HINT**: You'll want to use the `lit()` function,\n  from `pyspark.sql.functions`, available here as `F.lit()`.\n* Use our previously created `reg_eval` object to evaluate the `test_for_avg_df` and calculate the RMSE.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738744E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5c4f056a-ad50-4d0c-b8e6-47f4b74c8e00"},{"version":"CommandV1","origId":36148146263679,"guid":"16d78034-cc04-4d8d-9298-25fc15349de6","subtype":"command","commandType":"auto","position":38.0,"command":"# Compute the average rating\navg_rating_df = training_df.groupBy().avg('rating')\n\n# Extract the average rating value. (This is row 0, column 0.)\ntraining_avg_rating = avg_rating_df.collect()[0][0]\n\nprint('The average rating for movies in the training set is {0}'.format(training_avg_rating))\n\n# Add a column with the average rating\ntest_for_avg_df = training_df.withColumn('prediction', F.lit(training_avg_rating))\n\n# Run the previously created RMSE evaluator, reg_eval, on the test_for_avg_df DataFrame\ntest_avg_RMSE = reg_eval.evaluate(test_for_avg_df)\n\nprint(\"The RMSE on the average set is {0}\".format(test_avg_RMSE))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">The average rating for movies in the training set is 3.52547984237\nThe RMSE on the average set is 1.0519743756\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: &apos;RegressionEvaluator&apos; object is not callable","error":"<div class=\"ansiout\">The average rating for movies in the training set is 3.52547984237\n<span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-27-315d093209c9&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     12</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     13</span> <span class=\"ansired\"># Run the previously created RMSE evaluator, reg_eval, on the test_for_avg_df DataFrame</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 14</span><span class=\"ansiyellow\"> </span>test_avg_RMSE <span class=\"ansiyellow\">=</span> reg_eval<span class=\"ansiyellow\">(</span>test_for_avg_df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     15</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     16</span> <span class=\"ansigreen\">print</span><span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;The RMSE on the average set is {0}&quot;</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>test_avg_RMSE<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: &apos;RegressionEvaluator&apos; object is not callable\n</div>","workflows":[],"startTime":1.473122754104E12,"submitTime":1.473122752504E12,"finishTime":1.473122756321E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7bdd80e9-27ac-44dd-8576-80aab9e2f15d"},{"version":"CommandV1","origId":36148146263680,"guid":"f54e6060-cc68-4abf-b79f-53eab5dea6c1","subtype":"command","commandType":"auto","position":39.0,"command":"# TEST Comparing Your Model (2d)\nTest.assertTrue(abs(training_avg_rating - 3.52547984237) < 0.000001,\n                'incorrect training_avg_rating (expected 3.52547984237): {0:.11f}'.format(training_avg_rating))\nTest.assertTrue(abs(test_avg_RMSE - 1.0519743756) < 0.000001,\n                'incorrect test_avg_RMSE (expected 1.0519743756): {0:.11f}'.format(test_avg_RMSE))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.473122764861E12,"submitTime":1.47312276326E12,"finishTime":1.473122764939E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c8f6b060-8b05-4602-96c0-01acec1ae463"},{"version":"CommandV1","origId":36148146263681,"guid":"5d6523ef-89fa-4be6-8bf0-e94f30d0430f","subtype":"command","commandType":"auto","position":40.0,"command":"%md\nYou now have code to predict how users will rate movies!","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.47312073878E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fb73797d-4efd-435e-aa8a-6dfef74917d8"},{"version":"CommandV1","origId":36148146263682,"guid":"d37dc091-ca07-40e2-b9db-1ba158e0993d","subtype":"command","commandType":"auto","position":41.0,"command":"%md\n## Part 3: Predictions for Yourself\nThe ultimate goal of this lab exercise is to predict what movies to recommend to yourself.  In order to do that, you will first need to add ratings for yourself to the `ratings_df` dataset.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738804E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a582f7b9-841b-4b5e-b057-85b1a552b4f6"},{"version":"CommandV1","origId":36148146263683,"guid":"79a317db-c32e-48ce-8dfe-83b44f64e634","subtype":"command","commandType":"auto","position":42.0,"command":"%md\n**(3a) Your Movie Ratings**\n\nTo help you provide ratings for yourself, we have included the following code to list the names and movie IDs of the 50 highest-rated movies from `movies_with_500_ratings_or_more` which we created in part 1 the lab.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738824E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d42303be-46cc-4e46-88a3-cf0671359637"},{"version":"CommandV1","origId":36148146263684,"guid":"0aeb47cf-8899-4933-8832-a61c18abe282","subtype":"command","commandType":"auto","position":43.0,"command":"print 'Most rated movies:'\nprint '(average rating, movie name, number of reviews, movie ID)'\ndisplay(movies_with_500_ratings_or_more.orderBy(movies_with_500_ratings_or_more['average'].desc()).take(100))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[318.0,63366.0,4.446990499637029,"Shawshank Redemption, The (1994)"],[858.0,41355.0,4.364732196832306,"Godfather, The (1972)"],[50.0,47006.0,4.334372207803259,"Usual Suspects, The (1995)"],[527.0,50054.0,4.310175010988133,"Schindler's List (1993)"],[1221.0,27398.0,4.275640557704942,"Godfather: Part II, The (1974)"],[2019.0,11611.0,4.2741796572216,"Seven Samurai (Shichinin no samurai) (1954)"],[904.0,17449.0,4.271333600779414,"Rear Window (1954)"],[7502.0,4305.0,4.263182346109176,"Band of Brothers (2001)"],[912.0,24349.0,4.258326830670664,"Casablanca (1942)"],[922.0,6525.0,4.256934865900383,"Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)"],[1193.0,29932.0,4.24807897901911,"One Flew Over the Cuckoo's Nest (1975)"],[750.0,23220.0,4.247286821705426,"Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb (1964)"],[1212.0,6565.0,4.246001523229246,"Third Man, The (1949)"],[6016.0,12937.0,4.235410064157069,"City of God (Cidade de Deus) (2002)"],[44555.0,5720.0,4.2347902097902095,"Lives of Others, The (Das leben der Anderen) (2006)"],[908.0,15627.0,4.233538107122288,"North by Northwest (1959)"],[1178.0,3568.0,4.2326233183856505,"Paths of Glory (1957)"],[2959.0,40106.0,4.227123123722136,"Fight Club (1999)"],[3435.0,4909.0,4.224281931146873,"Double Indemnity (1944)"],[1203.0,12934.0,4.224137931034483,"12 Angry Men (1957)"],[77658.0,936.0,4.2206196581196584,"Cosmos (1980)"],[58559.0,20438.0,4.220129171151776,"Dark Knight, The (2008)"],[1198.0,43295.0,4.219009123455364,"Raiders of the Lost Ark (Indiana Jones and the Raiders of the Lost Ark) (1981)"],[3030.0,3559.0,4.211716774374825,"Yojimbo (1961)"],[1284.0,5529.0,4.207361186471333,"Big Sleep, The (1946)"],[926.0,4826.0,4.2041027766266055,"All About Eve (1950)"],[5618.0,13466.0,4.203809594534383,"Spirited Away (Sen to Chihiro no kamikakushi) (2001)"],[1252.0,15310.0,4.199673416067929,"Chinatown (1974)"],[930.0,4932.0,4.1977899432279,"Notorious (1946)"],[4973.0,24349.0,4.19707174832642,"Amelie (Fabuleux destin d'Amélie Poulain, Le) (2001)"],[1260.0,4232.0,4.193171077504726,"M (1931)"],[260.0,54502.0,4.190671901948552,"Star Wars: Episode IV - A New Hope (1977)"],[1207.0,14769.0,4.188943056401923,"To Kill a Mockingbird (1962)"],[1196.0,45313.0,4.188202061218635,"Star Wars: Episode V - The Empire Strikes Back (1980)"],[913.0,12144.0,4.187211791831357,"Maltese Falcon, The (1941)"],[2571.0,51334.0,4.187185880702848,"Matrix, The (1999)"],[950.0,3358.0,4.184187016081,"Thin Man, The (1934)"],[1213.0,26406.0,4.183632507763387,"Goodfellas (1990)"],[1248.0,4718.0,4.183022467147096,"Touch of Evil (1958)"],[94466.0,582.0,4.18298969072165,"Black Mirror (2011)"],[1148.0,15022.0,4.181067767274664,"Wallace & Gromit: The Wrong Trousers (1993)"],[4226.0,30443.0,4.1785467923660615,"Memento (2000)"],[593.0,63299.0,4.17705650958151,"Silence of the Lambs, The (1991)"],[1197.0,32586.0,4.1767323390413065,"Princess Bride, The (1987)"],[5291.0,3712.0,4.176724137931035,"Rashomon (Rashômon) (1950)"],[2324.0,18156.0,4.175837188808107,"Life Is Beautiful (La Vita è bella) (1997)"],[296.0,67310.0,4.174231169217055,"Pulp Fiction (1994)"],[1136.0,33024.0,4.174146075581396,"Monty Python and the Holy Grail (1975)"],[3307.0,2593.0,4.174122637871192,"City Lights (1931)"],[1217.0,4824.0,4.173611111111111,"Ran (1985)"],[1234.0,14926.0,4.173556210639153,"Sting, The (1973)"],[898.0,6583.0,4.171426401336777,"Philadelphia Story, The (1940)"],[905.0,4184.0,4.170052581261951,"It Happened One Night (1934)"],[745.0,12073.0,4.167315497390872,"Wallace & Gromit: A Close Shave (1995)"],[1945.0,5644.0,4.163536498936924,"On the Waterfront (1954)"],[3022.0,2224.0,4.162769784172662,"General, The (1926)"],[1204.0,12378.0,4.162102116658588,"Lawrence of Arabia (1962)"],[1254.0,5155.0,4.161396702230844,"Treasure of the Sierra Madre, The (1948)"],[2203.0,2199.0,4.1596180081855385,"Shadow of a Doubt (1943)"],[2186.0,5154.0,4.158614668218859,"Strangers on a Train (1951)"],[1147.0,3737.0,4.158415841584159,"When We Were Kings (1996)"],[79132.0,14023.0,4.156172003137702,"Inception (2010)"],[2858.0,44987.0,4.155933936470536,"American Beauty (1999)"],[1172.0,9100.0,4.154010989010989,"Cinema Paradiso (Nuovo cinema Paradiso) (1989)"],[951.0,3902.0,4.1529984623270115,"His Girl Friday (1940)"],[2329.0,23309.0,4.151207688017504,"American History X (1998)"],[3134.0,1594.0,4.150878293601004,"Grand Illusion (La grande illusion) (1937)"],[5971.0,5489.0,4.1494807797413005,"My Neighbor Totoro (Tonari no Totoro) (1988)"],[903.0,14094.0,4.148006243791684,"Vertigo (1958)"],[5008.0,1620.0,4.146604938271605,"Witness for the Prosecution (1957)"],[1280.0,3253.0,4.144328312327083,"Raise the Red Lantern (Da hong deng long gao gao gua) (1991)"],[3089.0,3186.0,4.143596986817326,"Bicycle Thieves (a.k.a. The Bicycle Thief) (a.k.a. The Bicycle Thieves) (Ladri di biciclette) (1948)"],[3462.0,3732.0,4.143086816720257,"Modern Times (1936)"],[7153.0,31577.0,4.14238211356367,"Lord of the Rings: The Return of the King, The (2003)"],[668.0,761.0,4.139947437582129,"Song of the Little Road (Pather Panchali) (1955)"],[1233.0,13612.0,4.139729650308551,"Boot, Das (Boat, The) (1981)"],[1131.0,3247.0,4.139051432091161,"Jean de Florette (1986)"],[2351.0,1152.0,4.138888888888889,"Nights of Cabiria (Notti di Cabiria, Le) (1957)"],[4993.0,37553.0,4.137925065906852,"Lord of the Rings: The Fellowship of the Ring, The (2001)"],[1262.0,10904.0,4.137655906089509,"Great Escape, The (1963)"],[2731.0,2851.0,4.136267976148719,"400 Blows, The (Les quatre cents coups) (1959)"],[541.0,30526.0,4.133705693507174,"Blade Runner (1982)"],[1949.0,2123.0,4.13259538389072,"Man for All Seasons, A (1966)"],[92259.0,2738.0,4.132395909422937,"Intouchables (2011)"],[923.0,17774.0,4.1304433442106445,"Citizen Kane (1941)"],[2935.0,1398.0,4.130185979971388,"Lady Eve, The (1941)"],[1256.0,5569.0,4.129646256060334,"Duck Soup (1933)"],[1189.0,2700.0,4.128888888888889,"Thin Blue Line, The (1988)"],[2859.0,2192.0,4.1288777372262775,"Stop Making Sense (1984)"],[1209.0,4407.0,4.128545495802133,"Once Upon a Time in the West (C'era una volta il West) (1968)"],[1267.0,8988.0,4.128504672897196,"Manchurian Candidate, The (1962)"],[670.0,765.0,4.124836601307189,"World of Apu, The (Apur Sansar) (1959)"],[3468.0,3955.0,4.1246523388116305,"Hustler, The (1961)"],[6669.0,1118.0,4.124329159212881,"Ikiru (1952)"],[2360.0,2292.0,4.12325479930192,"Celebration, The (Festen) (1998)"],[1201.0,14496.0,4.123240894039735,"Good, the Bad and the Ugly, The (Buono, il brutto, il cattivo, Il) (1966)"],[1224.0,4656.0,4.120811855670103,"Henry V (1989)"],[3429.0,2585.0,4.120696324951644,"Creature Comforts (1989)"],[2066.0,1082.0,4.118761552680222,"Out of the Past (1947)"],[2920.0,1048.0,4.11736641221374,"Children of Paradise (Les enfants du paradis) (1945)"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"movieId","type":"\"long\""},{"name":"count","type":"\"long\""},{"name":"average","type":"\"double\""},{"name":"title","type":"\"string\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.47312387313E12,"submitTime":1.473123871492E12,"finishTime":1.47312388337E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9310e4e2-c7ea-4576-ac25-0815503fd9a9"},{"version":"CommandV1","origId":36148146263685,"guid":"fd16069b-9684-4809-a065-1dc5be644033","subtype":"command","commandType":"auto","position":44.0,"command":"%md\nThe user ID 0 is unassigned, so we will use it for your ratings. We set the variable `my_user_ID` to 0 for you. Next, create a new DataFrame called `my_ratings_df`, with your ratings for at least 10 movie ratings. Each entry should be formatted as `(my_user_id, movieID, rating)`.  As in the original dataset, ratings should be between 1 and 5 (inclusive). If you have not seen at least 10 of these movies, you can increase the parameter passed to `take()` in the above cell until there are 10 movies that you have seen (or you can also guess what your rating would be for movies you have not seen).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738859E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"996c5e92-bfc7-4a35-9767-5d67cd6917b0"},{"version":"CommandV1","origId":36148146263686,"guid":"1e01f706-2edd-4772-b6f8-4e6dc47ef40c","subtype":"command","commandType":"auto","position":45.0,"command":"from pyspark.sql import Row\nmy_user_id = 0\n\n# Note that the movie IDs are the *last* number on each line. A common error was to use the number of ratings as the movie ID.\nmy_rated_movies = [\n     # The format of each line is (my_user_id, movie ID, your rating)\n     # For example, to give the movie \"Star Wars: Episode IV - A New Hope (1977)\" a five rating, you would add the following line:\n     #   (my_user_id, 260, 5),\n     (0, 318, 5),\n     (0, 858, 5),\n     (0, 50, 4),\n     (0, 527, 4),\n     (0, 1221, 5),\n     (0, 2019, 4),\n     (0, 904, 4),\n     (0, 6016, 4),\n     (0, 912, 4),\n     (0, 922,  4),\n     (0, 58559, 4),\n     (0, 3468, 3),\n     (0, 593, 5),\n     (0, 260, 4)\n]\n\nmy_ratings_df = sqlContext.createDataFrame(my_rated_movies, ['userId','movieId','rating'])\nprint 'My movie ratings:'\ndisplay(my_ratings_df.limit(10))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.0,318.0,5.0],[0.0,858.0,5.0],[0.0,50.0,4.0],[0.0,527.0,4.0],[0.0,1221.0,5.0],[0.0,2019.0,4.0],[0.0,904.0,4.0],[0.0,6016.0,4.0],[0.0,912.0,4.0],[0.0,922.0,4.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"userId","type":"\"long\""},{"name":"movieId","type":"\"long\""},{"name":"rating","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.473124134772E12,"submitTime":1.473124133134E12,"finishTime":1.473124134948E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"11c11f8a-2c57-42f4-b530-0e287ec39acf"},{"version":"CommandV1","origId":36148146263687,"guid":"98a6fa3e-ee08-4580-802f-ceb577e47156","subtype":"command","commandType":"auto","position":46.0,"command":"%md\n### (3b) Add Your Movies to Training Dataset\n\nNow that you have ratings for yourself, you need to add your ratings to the `training` dataset so that the model you train will incorporate your preferences.  Spark's [unionAll()](http://spark.apache.org/docs/1.6.2/api/python/pyspark.sql.html#pyspark.sql.DataFrame.unionAll) transformation combines two DataFrames; use `unionAll()` to create a new training dataset that includes your ratings and the data in the original training dataset.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738888E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"822ae5eb-d675-444c-b6de-9022846af71b"},{"version":"CommandV1","origId":36148146263688,"guid":"7482f88a-43e9-4d18-80f0-b8bb89324b64","subtype":"command","commandType":"auto","position":47.0,"command":"training_with_my_ratings_df = training_df.unionAll(my_ratings_df)\n\nprint ('The training dataset now has %s more entries than the original training dataset' %\n       (training_with_my_ratings_df.count() - training_df.count()))\nassert (training_with_my_ratings_df.count() - training_df.count()) == my_ratings_df.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">The training dataset now has 14 more entries than the original training dataset\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;list&apos; object has no attribute &apos;_jdf&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-34-8308c99f673d&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>training_with_my_ratings_df <span class=\"ansiyellow\">=</span> training_df<span class=\"ansiyellow\">.</span>unionAll<span class=\"ansiyellow\">(</span>my_rated_movies<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> print (&apos;The training dataset now has %s more entries than the original training dataset&apos; %\n<span class=\"ansigreen\">      5</span>        (training_with_my_ratings_df.count() - training_df.count()))\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">unionAll</span><span class=\"ansiblue\">(self, other)</span>\n<span class=\"ansigreen\">    996</span>         This <span class=\"ansigreen\">is</span> equivalent to <span class=\"ansiyellow\">&#96;</span>UNION ALL<span class=\"ansiyellow\">&#96;</span> <span class=\"ansigreen\">in</span> SQL<span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    997</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 998</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>unionAll<span class=\"ansiyellow\">(</span>other<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    999</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1000</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.3</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;list&apos; object has no attribute &apos;_jdf&apos;\n</div>","workflows":[],"startTime":1.473124281927E12,"submitTime":1.473124280285E12,"finishTime":1.473124283241E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8e4caae8-bc0e-426b-bdd5-23a4257c1e44"},{"version":"CommandV1","origId":36148146263689,"guid":"0d418dec-84bd-4221-8381-221fd5c624ef","subtype":"command","commandType":"auto","position":48.0,"command":"%md\n### (3c) Train a Model with Your Ratings\n\nNow, train a model with your ratings added and the parameters you used in in part (2b) and (2c). Mke sure you include **all** of the parameters.\n\n**Note**: This cell will take about 30 seconds to run.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738917E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"acbd4e59-2666-400a-ad8a-7cf4837da3a0"},{"version":"CommandV1","origId":36148146263690,"guid":"424563d6-a8c5-477b-9fa9-b557b5f16e3f","subtype":"command","commandType":"auto","position":49.0,"command":"# Reset the parameters for the ALS object.\nals.setPredictionCol(\"prediction\")\\\n   .setMaxIter(5)\\\n   .setSeed(seed)\\\n   .setRegParam(0.1)\\\n   .setUserCol(\"userId\")\\\n   .setItemCol(\"movieId\")\\\n   .setRatingCol(\"rating\")\\\n   .setRank(12)\n\n\n# Create the model with these parameters.\nmy_ratings_model = als.fit(training_with_my_ratings_df)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.473124682648E12,"submitTime":1.473124680996E12,"finishTime":1.473124769793E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7d178e2b-1dbf-4adc-8f33-4fbaccd03e18"},{"version":"CommandV1","origId":36148146263691,"guid":"81d7beed-2c03-44c1-b145-239f3660caee","subtype":"command","commandType":"auto","position":50.0,"command":"%md\n### (3d) Check RMSE for the New Model with Your Ratings\n\nCompute the RMSE for this new model on the test set.\n* Run your model (the one you just trained) against the test data set in `test_df`.\n* Then, use our previously-computed `reg_eval` object to compute the RMSE of your ratings.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738943E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"82177939-0835-4588-814a-297bf9aa9782"},{"version":"CommandV1","origId":36148146263692,"guid":"720f57f7-a5eb-4d08-9a13-0af0599b7058","subtype":"command","commandType":"auto","position":51.0,"command":"my_predict_df = my_ratings_model.transform(test_df)\n\n# Remove NaN values from prediction (due to SPARK-14489)\npredicted_test_my_ratings_df = my_predict_df.filter(my_predict_df.prediction != float('nan'))\n\n# Run the previously created RMSE evaluator, reg_eval, on the predicted_test_my_ratings_df DataFrame\ntest_RMSE_my_ratings = reg_eval.evaluate(predicted_test_my_ratings_df)\nprint('The model had a RMSE on the test set of {0}'.format(test_RMSE_my_ratings))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">The model had a RMSE on the test set of 0.811317055037\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">IllegalArgumentException</span>: u&apos;Field &quot;prediction&quot; does not exist.&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">IllegalArgumentException</span>                  Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-39-5592e5dcd39d&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      6</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span> <span class=\"ansired\"># Run the previously created RMSE evaluator, reg_eval, on the predicted_test_my_ratings_df DataFrame</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 8</span><span class=\"ansiyellow\"> </span>test_RMSE_my_ratings <span class=\"ansiyellow\">=</span> reg_eval<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>test_df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      9</span> <span class=\"ansigreen\">print</span><span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;The model had a RMSE on the test set of {0}&apos;</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>test_RMSE_my_ratings<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/evaluation.py</span> in <span class=\"ansicyan\">evaluate</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     67</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>             <span class=\"ansigreen\">raise</span> ValueError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Params must be a param map but got %s.&quot;</span> <span class=\"ansiyellow\">%</span> type<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/evaluation.py</span> in <span class=\"ansicyan\">_evaluate</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">     97</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">     98</span>         self<span class=\"ansiyellow\">.</span>_transfer_params_to_java<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 99</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    100</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    101</span>     <span class=\"ansigreen\">def</span> isLargerBetter<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    811</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    812</span>         return_value = get_return_value(\n<span class=\"ansigreen\">--&gt; 813</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">    814</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    815</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     51</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     52</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;java.lang.IllegalArgumentException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 53</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> IllegalArgumentException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     54</span>             <span class=\"ansigreen\">raise</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     55</span>     <span class=\"ansigreen\">return</span> deco<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">IllegalArgumentException</span>: u&apos;Field &quot;prediction&quot; does not exist.&apos;\n</div>","workflows":[],"startTime":1.473125014602E12,"submitTime":1.47312501294E12,"finishTime":1.473125025279E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e0dbd138-ec1a-458a-a0fc-254741384a80"},{"version":"CommandV1","origId":36148146263693,"guid":"c57c1c8f-42d9-4468-b5cc-1a4647b87dff","subtype":"command","commandType":"auto","position":52.0,"command":"%md\n### (3e) Predict Your Ratings\n\nSo far, we have only computed the error of the model.  Next, let's predict what ratings you would give to the movies that you did not already provide ratings for.\n\nThe steps you should perform are:\n* Filter out the movies you already rated manually. (Use the `my_rated_movie_ids` variable.) Put the results in a new `not_rated_df`.\n\n   **Hint**: The [Column.isin()](http://spark.apache.org/docs/1.6.2/api/python/pyspark.sql.html#pyspark.sql.Column.isin)\n   method, as well as the `~` (\"not\") DataFrame logical operator, may come in handy here. Here's an example of using `isin()`:\n\n```\n    > df1 = sqlContext.createDataFrame([(\"Jim\", 10), (\"Julie\", 9), (\"Abdul\", 20), (\"Mireille\", 19)], [\"name\", \"age\"])\n    > df1.show()\n    +--------+---+\n    |    name|age|\n    +--------+---+\n    |     Jim| 10|\n    |   Julie|  9|\n    |   Abdul| 20|\n    |Mireille| 19|\n    +--------+---+\n\n    > names_to_delete = (\"Julie\", \"Abdul\") # this is just a Python tuple\n    > df2 = df1.filter(~ df1[\"name\"].isin(names_to_delete)) # \"NOT IN\"\n    > df2.show()\n    +--------+---+\n    |    name|age|\n    +--------+---+\n    |     Jim| 10|\n    |   Julie|  9|\n    +--------+---+\n```\n\n* Transform `not_rated_df` into `my_unrated_movies_df` by:\n    - renaming the \"ID\" column to \"movieId\"\n    - adding a \"userId\" column with the value contained in the `my_user_id` variable defined above.\n\n* Create a `predicted_ratings_df` DataFrame by applying `my_ratings_model` to `my_unrated_movies_df`.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.47312073897E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"371f66a1-40d9-4245-8150-5362ea8bdb8c"},{"version":"CommandV1","origId":36148146263694,"guid":"161571c4-2942-4786-997e-73ac2def2fe8","subtype":"command","commandType":"auto","position":53.0,"command":"# Create a list of my rated movie IDs\nmy_rated_movie_ids = [x[1] for x in my_rated_movies]\n\n# Filter out the movies I already rated.\nnot_rated_df = movies_df.filter(~movies_df[\"ID\"].isin(my_rated_movie_ids))\n\n# Rename the \"ID\" column to be \"movieId\", and add a column with my_user_id as \"userId\".\nmy_unrated_movies_df = not_rated_df.withColumnRenamed(\"ID\",\"movieId\").select('*', F.lit(my_user_id).alias('userId'))\n\n# Use my_rating_model to predict ratings for the movies that I did not manually rate.\nraw_predicted_ratings_df = my_ratings_model.transform(my_unrated_movies_df)\n\npredicted_ratings_df = raw_predicted_ratings_df.filter(raw_predicted_ratings_df['prediction'] != float('nan'))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&apos;Cannot resolve column name &quot;userId&quot; among (ID, title);&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-41-b858860b3d4c&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     11</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     12</span> <span class=\"ansired\"># Use my_rating_model to predict ratings for the movies that I did not manually rate.</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 13</span><span class=\"ansiyellow\"> </span>raw_predicted_ratings_df <span class=\"ansiyellow\">=</span> my_ratings_model<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>my_unrated_movies_df<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     14</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     15</span> predicted_ratings_df <span class=\"ansiyellow\">=</span> raw_predicted_ratings_df<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span>raw_predicted_ratings_df<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;prediction&apos;</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">!=</span> float<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;nan&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/pipeline.py</span> in <span class=\"ansicyan\">transform</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">    112</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">,</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    113</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 114</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    115</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    116</span>             <span class=\"ansigreen\">raise</span> ValueError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Params must be either a param map but got %s.&quot;</span> <span class=\"ansiyellow\">%</span> type<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/wrapper.py</span> in <span class=\"ansicyan\">_transform</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    147</span>     <span class=\"ansigreen\">def</span> _transform<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    148</span>         self<span class=\"ansiyellow\">.</span>_transfer_params_to_java<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 149</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> dataset<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    150</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    151</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    811</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    812</span>         return_value = get_return_value(\n<span class=\"ansigreen\">--&gt; 813</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">    814</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    815</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     49</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     50</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 51</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     52</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;java.lang.IllegalArgumentException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     53</span>                 <span class=\"ansigreen\">raise</span> IllegalArgumentException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&apos;Cannot resolve column name &quot;userId&quot; among (ID, title);&apos;\n</div>","workflows":[],"startTime":1.473126839928E12,"submitTime":1.473126838212E12,"finishTime":1.473126840108E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ec48260d-17d1-4009-a9f9-b6167417ee82"},{"version":"CommandV1","origId":36148146263695,"guid":"c1275e40-2b70-400d-9a32-e7c99c61cc0d","subtype":"command","commandType":"auto","position":53.5,"command":"display(predicted_ratings_df.orderBy('prediction', ascending=False).take(50))","commandVersion":0,"state":"finished","results":{"type":"table","data":[[128091.0,"Craig Ferguson: A Wee Bit o' Revolution (2009)",0.0,6.228808403015137],[121029.0,"No Distance Left to Run (2010)",0.0,5.235832214355469],[77736.0,"Crazy Stone (Fengkuang de shitou) (2006)",0.0,4.966998100280762],[112473.0,"Stuart: A Life Backward (2007)",0.0,4.943744659423828],[122290.0,"Homeboy (1988)",0.0,4.916393756866455],[130347.0,"Bill Hicks: Sane Man (1989)",0.0,4.88247013092041],[26793.0,"Tito and Me (Tito i ja) (1992)",0.0,4.86664342880249],[117907.0,"My Brother Tom (2001)",0.0,4.854216575622559],[98595.0,"Peppermint Soda (Diabolo menthe) (1977)",0.0,4.831931114196777],[124273.0,"Kevin Smith: Too Fat For 40 (2010)",0.0,4.823497772216797],[108875.0,"Harvest (Stadt Land Fluss) (2011)",0.0,4.800127983093262],[99493.0,"Girl Walk: All Day (2011)",0.0,4.713228225708008],[81117.0,"Moth, The (Cma) (1980)",0.0,4.711601734161377],[127256.0,"The Old Gun (1975)",0.0,4.700347423553467],[102119.0,"Yesterday Was a Lie (2008)",0.0,4.6696367263793945],[95776.0,"Bob Funk (2009)",0.0,4.66879940032959],[129751.0,"The Beehive (1982)",0.0,4.63208532333374],[3226.0,"Hellhounds on My Trail (1999)",0.0,4.614691257476807],[25990.0,"It Should Happen to You (1954)",0.0,4.613913536071777],[101538.0,"Smitty (2012)",0.0,4.6045637130737305],[99243.0,"Parasites, Les (1999)",0.0,4.598155975341797],[101706.0,"Lush Life (1993)",0.0,4.5636725425720215],[72235.0,"Between the Devil and the Deep Blue Sea (1995)",0.0,4.561233043670654],[107361.0,"Unbeatable (Ji zhan) (2013)",0.0,4.55210018157959],[99675.0,"Eat Sleep Die (Äta sova dö) (2012)",0.0,4.54721212387085],[60983.0,"Eve and the Fire Horse (2005)",0.0,4.541123390197754],[25885.0,"Prelude to War (Why We Fight, 1) (1943)",0.0,4.540875434875488],[125966.0,"Garfield's Halloween Adventure (1985)",0.0,4.536008834838867],[72360.0,"Rocks (Rad, Das) (2003)",0.0,4.527318954467773],[27092.0,"Smashing Pumpkins: Vieuphoria (1994)",0.0,4.524746894836426],[60198.0,"Sandglass, The (Sanatorium pod klepsydra) (1973)",0.0,4.52077579498291],[127021.0,"Rewind This! (2013)",0.0,4.512192726135254],[128914.0,"Tom Segura: Completely Normal (2014)",0.0,4.501983642578125],[109529.0,"Everybody Street (2013)",0.0,4.48161506652832],[93918.0,"Big Night, The (1951)",0.0,4.475687503814697],[121372.0,"Bill Burr: Let It Go (2010)",0.0,4.466324806213379],[90090.0,"Game of Death, The (Le Jeu de la Mort) (2010)",0.0,4.456909656524658],[26813.0,"Calendar (1993)",0.0,4.454493522644043],[91762.0,"Last Lions, The (2011)",0.0,4.434872150421143],[82328.0,"One Fine Spring Day (Bomnaleun ganda) (2001)",0.0,4.433782577514648],[103998.0,"Always Outnumbered (1998)",0.0,4.4233574867248535],[95604.0,"The War (2007)",0.0,4.418887138366699],[126584.0,"Beyond Outrage (2012)",0.0,4.413209438323975],[72032.0,"Forever (2006)",0.0,4.411377906799316],[107643.0,"Here Without Me (Inja bedoone man) (2011)",0.0,4.410117149353027],[88203.0,"Car Bonus (Autobonus) (2001)",0.0,4.400948524475098],[109887.0,"Great Passage, The (Fune wo amu) (2013)",0.0,4.394289016723633],[98328.0,"Chronicle of My Mother (Waga haha no ki) (2011)",0.0,4.394289016723633],[130970.0,"George Carlin: Life Is Worth Losing (2005)",0.0,4.3917059898376465],[106048.0,"Four Days in July (1985)",0.0,4.390335559844971]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"movieId","type":"\"long\""},{"name":"title","type":"\"string\""},{"name":"userId","type":"\"long\""},{"name":"prediction","type":"\"double\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.473126929944E12,"submitTime":1.473126928213E12,"finishTime":1.473126940133E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"97b98193-8be9-4a87-8108-c2f0afff0482"},{"version":"CommandV1","origId":36148146263696,"guid":"11960ff2-5aae-4df7-8cc5-6cd9cba72c6c","subtype":"command","commandType":"auto","position":53.75,"command":"display(movie_names_with_avg_ratings_df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1831.0,7463.0,2.5785207021305103,"Lost in Space (1998)"],[431.0,8946.0,3.695059244355019,"Carlito's Way (1993)"],[631.0,2193.0,2.7273141814865483,"All Dogs Go to Heaven 2 (1996)"],[231.0,32085.0,2.9524700015583605,"Dumb & Dumber (Dumb and Dumber) (1994)"],[32031.0,1777.0,3.270962296004502,"Robots (2005)"],[45431.0,2059.0,3.416221466731423,"Over the Hedge (2006)"],[2231.0,6759.0,3.727400503032993,"Rounders (1998)"],[2431.0,6045.0,3.109677419354839,"Patch Adams (1998)"],[4031.0,1047.0,2.89207258834766,"All the Pretty Horses (2000)"],[31.0,9435.0,3.250344462109168,"Dangerous Minds (1995)"],[1231.0,7902.0,3.9474816502151353,"Right Stuff, The (1983)"],[3831.0,1564.0,3.6620843989769822,"Saving Grace (2000)"],[27831.0,2883.0,3.7835587929240373,"Layer Cake (2004)"],[1031.0,4227.0,3.329548142890939,"Bedknobs and Broomsticks (1971)"],[4231.0,996.0,3.0737951807228914,"Someone Like You (2001)"],[1431.0,2931.0,2.571989082224497,"Beverly Hills Ninja (1997)"],[3031.0,348.0,2.2485632183908044,"Repossessed (1990)"],[6631.0,99.0,2.282828282828283,"Man's Best Friend (1993)"],[8831.0,327.0,2.8700305810397553,"Suspect Zero (2004)"],[2831.0,83.0,2.6686746987951806,"Dog of Flanders, A (1999)"],[4631.0,53.0,2.7452830188679247,"Old Gringo (1989)"],[5431.0,142.0,3.0246478873239435,"Goin' South (1978)"],[39231.0,1097.0,3.1180492251595258,"Elizabethtown (2005)"],[1631.0,480.0,3.44375,"Assignment, The (1997)"],[7831.0,336.0,3.8779761904761907,"Another Thin Man (1939)"],[56631.0,11.0,3.5,"Densha otoko (Train Man) (2005)"],[80831.0,581.0,3.621342512908778,"Let Me In (2010)"],[5231.0,215.0,3.432558139534884,"Road to Morocco (1942)"],[6031.0,307.0,3.688925081433225,"Imitation of Life (1959)"],[46231.0,17.0,2.264705882352941,"Stoned (2005)"],[41831.0,66.0,3.303030303030303,"They Died with Their Boots On (1941)"],[115231.0,131.0,3.5381679389312977,"St. Vincent (2014)"],[93831.0,279.0,3.1792114695340503,"American Reunion (American Pie 4) (2012)"],[2031.0,256.0,2.619140625,"Million Dollar Duck, The (a.k.a. $1,000,000 Duck) (1971)"],[3431.0,474.0,2.4082278481012658,"Death Wish 2 (1982)"],[55031.0,291.0,3.754295532646048,"Evening with Kevin Smith, An (2002)"],[64231.0,263.0,2.76425855513308,"Punisher: War Zone (2008)"],[26631.0,117.0,3.576923076923077,"Alice (Neco z Alenky) (1988)"],[27631.0,13.0,2.923076923076923,"Cremaster 3 (2002)"],[48231.0,104.0,3.4375,"Taxidermia (2006)"],[4831.0,117.0,2.0982905982905984,"Can't Stop the Music (1980)"],[65631.0,77.0,3.292207792207792,"Battle in Seattle (2007)"],[2631.0,36.0,1.6805555555555556,"Frogs for Snakes (1998)"],[5631.0,21.0,2.5,"Between Strangers (2002)"],[31431.0,368.0,2.0652173913043477,"Boogeyman (2005)"],[73431.0,54.0,2.9166666666666665,"Maiden Heist, The (2009)"],[7031.0,136.0,2.5919117647058822,"Real McCoy, The (1993)"],[6231.0,121.0,3.3636363636363638,"Benny Goodman Story, The (1955)"],[6431.0,40.0,3.0,"Battle Cry (1955)"],[5031.0,34.0,3.2794117647058822,"Maria's Lovers (1984)"],[91831.0,54.0,2.2962962962962963,"Devil Inside, The (2012)"],[7231.0,32.0,2.9375,"Where Angels Go, Trouble Follows (1968)"],[831.0,221.0,3.5316742081447963,"Stonewall (1995)"],[3631.0,33.0,3.121212121212121,"It's in the Water (1998)"],[8631.0,79.0,3.329113924050633,"Hard Times (1975)"],[26231.0,132.0,3.746212121212121,"Performance (1970)"],[26831.0,18.0,3.2222222222222223,"Night We Never Met, The (1993)"],[104231.0,27.0,3.4074074074074074,"Drug War (Du zhan) (2012)"],[68831.0,10.0,3.15,"Ghosts of Cité Soleil (2006)"],[74431.0,26.0,3.826923076923077,"Takva: A Man's Fear of God (2006)"],[40831.0,5.0,3.3,"My Mother's Smile (a.k.a. The Religion Hour) (L'ora di religione) (Il sorriso di mia madre) (2002)"],[27031.0,11.0,3.4545454545454546,"Wavelength (1967)"],[4431.0,47.0,3.372340425531915,"Rembrandt (1936)"],[3231.0,18.0,2.888888888888889,"Saphead, The (1920)"],[113831.0,1.0,3.5,"Passenger Side (2009)"],[52831.0,44.0,3.1363636363636362,"Maniac Cop (1988)"],[70831.0,9.0,3.5,"Krakatoa: The Last Days (2006)"],[27431.0,11.0,3.5,"Adversary, The (L'adversaire) (2002)"],[81031.0,12.0,3.5,"Worlds Apart (To verdener) (2008)"],[121231.0,15.0,3.7333333333333334,"It Follows (2014)"],[25831.0,16.0,3.5625,"These Three (1936)"],[102231.0,19.0,3.6052631578947367,"Dragon (Wu Xia) (2011)"],[69231.0,8.0,3.1875,"Snug as a Bug (U Pana Boga za piecem) (1998)"],[73831.0,7.0,3.0,"Mall Girls (Galerianki) (2009)"],[110431.0,2.0,2.25,"Girl from the Naked Eye, The (2012)"],[104631.0,35.0,3.085714285714286,"Adore (2013)"],[98631.0,4.0,3.25,"Day He Arrives, The (Book chon bang hyang) (2011)"],[26431.0,48.0,3.6770833333333335,"Opening Night (1977)"],[116231.0,2.0,2.75,"Confessions of an Opium Eater (1962)"],[97031.0,4.0,3.0,"Goke, Body Snatcher from Hell (Kyuketsuki Gokemidoro) (1968)"],[78631.0,6.0,1.75,"Shark in Venice (2008)"],[101431.0,3.0,3.5,"Christine Jorgensen Story, The (1970)"],[104031.0,1.0,3.5,"Fred & Vinnie (2011)"],[5831.0,11.0,2.6818181818181817,"Soul Assassin (2001)"],[75831.0,8.0,2.1875,"Hollywood Revue of 1929, The (1929)"],[85231.0,4.0,3.25,"Twenty-Four Eyes (Nijûshi no hitomi) (1954)"],[92231.0,1.0,3.5,"Blue Bird, The (1918)"],[77231.0,3.0,2.5,"Hell Is Sold Out (1951)"],[81631.0,4.0,2.75,"Trail of the Screaming Forehead (2007)"],[6831.0,11.0,2.227272727272727,"Nobody's Baby (2001)"],[127031.0,1.0,3.0,"Pizzas (2012)"],[116831.0,2.0,3.75,"Give 'em Hell, Malone (2009)"],[121831.0,1.0,3.5,"The Seventh Sin (1957)"],[131031.0,1.0,3.0,"La liga no es cosa de hombres (1972)"],[115631.0,1.0,0.5,"Alone for Christmas (2013)"],[115831.0,1.0,3.5,"Serial Killer Culture (2014)"],[59031.0,7.0,3.357142857142857,"Private Property (Nue propriété) (2006)"],[114631.0,3.0,4.0,"Koumiko Mystery, The (Mystère Koumiko, Le) (1967)"],[104431.0,8.0,2.6875,"Enter Nowhere (2011)"],[121031.0,1.0,0.5,"Santos (2008)"],[127831.0,1.0,3.5,"Tintin and I (2003)"],[87831.0,2.0,2.5,"Marie-Jo and Her 2 Lovers (Marie-Jo et ses 2 amours) (2002)"],[73031.0,2.0,2.25,"Too Shy to Try (Je suis timide... mais je me soigne) (1978)"],[77831.0,2.0,3.5,"Fine, Totally Fine (Zenzen Daijobu) (2008)"],[82631.0,3.0,3.5,"Duelist (Hyeongsa) (2005)"],[34231.0,2.0,4.25,"Fighter in the Wind (2004)"],[120631.0,1.0,3.5,"Out of the Clear Blue Sky (2012)"],[105831.0,1.0,1.5,"Bloody Bloody Bible Camp (2012)"],[106431.0,3.0,3.5,"Chasing Ghosts: Beyond the Arcade (2007) "],[87031.0,5.0,3.1,"Strip Nude for Your Killer (Nude per l'assassino) (1975)"],[61031.0,5.0,3.4,"World's Greatest Lover, The (1977)"],[131231.0,1.0,3.5,"Standby (2014)"],[88031.0,3.0,2.0,"Tiresia (2003)"],[91031.0,5.0,3.3,"Wichita (1955)"],[111031.0,1.0,4.5,"Manufacturing Reality: Slavoj Zizek and the Reality of the Virtual (Slavoj Zizek: The Reality of the Virtual) (2004)"],[60231.0,2.0,3.5,"London After Midnight (1927)"],[43631.0,2.0,3.25,"Green Dolphin Street (1947)"],[81831.0,6.0,3.0833333333333335,"First Beautiful Thing, The (La prima cosa bella) (2010)"],[79031.0,1.0,3.0,"Horror Business (2005)"],[86231.0,3.0,4.0,"Warrendale (1967)"],[99631.0,2.0,3.75,"I Know What I Saw (2009)"],[96631.0,1.0,4.5,"Deathstalker II (1987)"],[114431.0,1.0,3.0,"Monkey's Teeth (Dents du singe, Les) (1960)"],[83831.0,1.0,3.0,"Story of Dr. Wassell, The (1944)"],[94831.0,1.0,3.0,"Leadbelly (1976)"],[103631.0,1.0,4.0,"Abols Upe (1974)"],[119031.0,1.0,3.0,"The Son of the Sheik (1977)"],[91231.0,1.0,3.0,"My Flesh My Blood (Moja krew) (2009)"],[103831.0,1.0,4.0,"Out of Life (Hors la vie) (1991)"],[116431.0,1.0,3.5,"Now! (1967)"],[94431.0,1.0,5.0,"Ella Lola, a la Trilby (1898)"],[120831.0,1.0,2.5,"Dealin' with Idiots (2013)"],[32.0,44980.0,3.8980546909737663,"Twelve Monkeys (a.k.a. 12 Monkeys) (1995)"],[832.0,14347.0,3.4579354568899423,"Ransom (1996)"],[3032.0,1666.0,3.43187274909964,"Omega Man, The (1971)"],[1032.0,7842.0,3.6301326192297885,"Alice in Wonderland (1951)"],[1432.0,1308.0,2.8704128440366974,"Metro (1997)"],[2232.0,6090.0,3.5929392446633828,"Cube (1997)"],[4232.0,3682.0,2.8379956545355784,"Spy Kids (2001)"],[55232.0,1351.0,3.1695040710584754,"Resident Evil: Extinction (2007)"],[60832.0,161.0,2.8819875776397517,"Pathology (2008)"],[432.0,12819.0,2.735470785552695,"City Slickers II: The Legend of Curly's Gold (1994)"],[232.0,6150.0,4.035609756097561,"Eat Drink Man Woman (Yin shi nan nu) (1994)"],[87232.0,3678.0,3.8304785209352907,"X-Men: First Class (2011)"],[1632.0,172.0,2.4011627906976742,"Smile Like Yours, A (1997)"],[5632.0,580.0,3.7663793103448278,"Bloody Sunday (2002)"],[632.0,342.0,3.91812865497076,"Land and Freedom (Tierra y libertad) (1995)"],[1232.0,1663.0,4.021948286229706,"Stalker (1979)"],[2032.0,238.0,2.8676470588235294,"Barefoot Executive, The (1971)"],[6832.0,919.0,3.3460282916213275,"Regarding Henry (1991)"],[64032.0,315.0,2.911111111111111,"Four Christmases (2008)"],[42632.0,1099.0,3.828935395814377,"Lady Vengeance (Sympathy for Lady Vengeance) (Chinjeolhan geumjassi) (2005)"],[2432.0,2026.0,3.2206317867719645,"Stepmom (1998)"],[4632.0,180.0,3.2111111111111112,"Package, The (1989)"],[5232.0,161.0,3.3074534161490683,"Road to Singapore (1940)"],[5432.0,53.0,2.0943396226415096,"Hero and the Terror (1988)"],[6032.0,225.0,3.7711111111111113,"Little Romance, A (1979)"],[96432.0,287.0,3.451219512195122,"Lawless (2012)"],[27032.0,146.0,3.3595890410958904,"Who Am I? (Wo shi shei) (1998)"],[3632.0,369.0,3.734417344173442,"Monsieur Verdoux (1947)"],[4032.0,81.0,3.0123456790123457,"Everlasting Piece, An (2000)"],[7032.0,123.0,2.8089430894308944,"Revenge (1990)"],[27432.0,91.0,3.67032967032967,"Beautiful Country, The (2004)"],[4432.0,789.0,4.076679340937896,"Sweet Smell of Success (1957)"],[58432.0,141.0,2.6560283687943262,"What Just Happened (2008)"],[31032.0,67.0,2.9402985074626864,"Last Horror Movie, The (2003)"],[80432.0,13.0,3.8846153846153846,"Our Relations (1936)"],[95032.0,10.0,2.8,"Vares: The Kiss of Evil (Vares - Pahan suudelma) (2011)"],[3432.0,430.0,2.1732558139534883,"Death Wish 3 (1985)"],[5832.0,129.0,2.294573643410853,"Left Behind II: Tribulation Force (2002)"],[48032.0,118.0,3.656779661016949,"Tiger and the Snow, The (La tigre e la neve) (2005)"],[3232.0,165.0,3.915151515151515,"Seven Chances (1925)"],[3832.0,144.0,3.4479166666666665,"Black Sabbath (Tre volti della paura, I) (1963)"],[7232.0,46.0,3.4347826086956523,"Heat and Dust (1983)"],[6432.0,75.0,3.0533333333333332,"Courtship of Eddie's Father, The (1963)"],[1832.0,48.0,2.625,"Heaven's Burning (1997)"],[32632.0,76.0,3.4342105263157894,"Electra Glide in Blue (1973)"],[6232.0,334.0,3.4221556886227544,"Born Free (1966)"],[128832.0,7.0,2.142857142857143,"The Last Five Years (2014)"],[2632.0,129.0,3.63953488372093,"Saragossa Manuscript, The (Rekopis znaleziony w Saragossie) (1965)"],[70432.0,60.0,3.5166666666666666,"Fail Safe (2000)"],[8832.0,129.0,3.3488372093023258,"Warriors of Heaven and Earth (Tian di ying xiong) (2003)"],[5032.0,32.0,2.34375,"Romantic Comedy (1983)"],[7832.0,216.0,3.865740740740741,"Thin Man Goes Home, The (1945)"],[43832.0,140.0,3.5142857142857142,"Call of Cthulhu, The (2005)"],[8232.0,64.0,3.6953125,"I Love You Again (1940)"],[70032.0,93.0,3.193548387096774,"Visioneers (2008)"],[96832.0,192.0,3.6067708333333335,"Holy Motors (2012)"],[58632.0,18.0,3.5277777777777777,"Terror's Advocate (Avocat de la terreur, L') (2007)"],[4832.0,57.0,2.956140350877193,"Carny (1980)"],[82032.0,6.0,2.9166666666666665,"All These Women (För att inte tala om alla dessa kvinnor) (1964)"],[26432.0,15.0,2.933333333333333,"Quintet (1979)"],[59832.0,48.0,3.59375,"Where the Sidewalk Ends (1950)"],[79832.0,25.0,3.58,"Easy Living (1937)"],[97832.0,40.0,3.5,"Chasing Mavericks (2012)"],[97232.0,35.0,3.0714285714285716,"Good Old Fashioned Orgy, A (2011)"],[93432.0,44.0,3.602272727272727,"Forks Over Knives (2011)"],[2832.0,31.0,2.9838709677419355,"Lost Son, The (1999)"],[27232.0,7.0,2.9285714285714284,"Beautiful Joe (2000)"],[33832.0,59.0,3.23728813559322,"Yes (2004)"],[78832.0,7.0,2.9285714285714284,"Wing and a Prayer (1944)"],[26232.0,2.0,4.25,"Rejs (1970)"],[6632.0,16.0,3.09375,"Of Unknown Origin (1983)"],[73232.0,17.0,3.088235294117647,"Girl in the Park, The (2007)"],[119432.0,4.0,3.5,"A Thousand Times Goodnight (2014)"],[69432.0,15.0,3.2,"Small Town Gay Bar (2006)"],[102432.0,5.0,3.3,"Blueprint for Murder, A (1953)"],[90432.0,4.0,3.375,"Lentsu (1990)"],[99832.0,6.0,3.5,"Hand, The (Ruka) (1966)"],[84232.0,13.0,3.4615384615384617,"Love Nest, The (1923)"],[84832.0,4.0,2.0,"Don Quixote (Don Quijote de Orson Welles) (1992)"],[34032.0,5.0,3.1,"Modigliani (2004)"],[57432.0,14.0,2.75,"Timber Falls (2007)"],[8632.0,15.0,2.3666666666666667,"Secret Society (2002)"],[56432.0,26.0,3.4423076923076925,"Swimming Pool, The (La piscine) (1969)"],[116032.0,2.0,2.0,"Children of the Corn V: Fields of Terror (1998)"],[78032.0,31.0,2.5161290322580645,"Dread (2009)"],[83232.0,4.0,2.875,"White Wedding (Noce blanche) (1989)"],[100032.0,12.0,3.4166666666666665,"Beauty Is Embarrassing (2012)"],[91632.0,13.0,3.3461538461538463,"G.I. Joe: A Real American Hero (G.I. Joe: The MASS Device) (1983)"],[25832.0,10.0,3.6,"Wife vs. Secretary (1936)"],[79232.0,3.0,4.0,"Comrades (1986)"],[51632.0,16.0,2.9375,"Atlantis: Milo's Return (2003) "],[60032.0,25.0,2.64,"Hounddog (2007)"],[90632.0,5.0,2.8,"Answer This! (2010)"],[81432.0,2.0,2.75,"Finances of the Grand Duke, The (Die Finanzen des Großherzogs) (1924)"],[86432.0,15.0,3.433333333333333,"Outside the Law (Hors-la-loi) (2010)"],[107632.0,1.0,3.5,"Carmen (1918)"],[89632.0,4.0,4.25,"Masti (2004)"],[113632.0,3.0,3.8333333333333335,"Other F Word, The (2011)"],[128632.0,7.0,2.0,"Home Sweet Hell (2015)"],[106232.0,1.0,2.0,"Reformer and the Redhead, The (1950)"],[111632.0,1.0,1.5,"Heat's On, The (1943)"],[72632.0,2.0,3.25,"Before I Self Destruct (2009)"],[129032.0,4.0,4.125,"Sense & Sensibility (2008)"],[107032.0,1.0,0.5,"Route 666 (2001)"],[107232.0,1.0,2.5,"Deadly Spawn, The (1983)"],[76032.0,1.0,0.5,"After Last Season (2009)"],[105032.0,2.0,3.75,"Farah Goes Bang (2013)"],[76832.0,2.0,1.75,"Black Waters of Echo's Pond, The (2009)"],[109032.0,1.0,3.0,"Hornets' Nest (1970)"],[100232.0,1.0,3.0,"Not with My Wife, You Don't! (1966)"],[106832.0,2.0,3.0,"7th Cavalry (Seventh Cavalry) (1956)"],[103032.0,3.0,3.8333333333333335,"They Call Us Misfits (Dom kallar oss mods) (1968)"],[117432.0,1.0,2.0,"The Heart Machine (2014)"],[120432.0,1.0,3.0,"A Summer in St. Tropez (1983)"],[92032.0,2.0,2.5,"Don Is Dead, The (1973)"],[125632.0,1.0,4.5,"In Our Garden"],[106032.0,1.0,2.0,"Chastity Bites (2013)"],[72032.0,4.0,4.0,"Forever (2006)"],[124232.0,1.0,3.0,"The Fuller Brush Man (1948)"],[98032.0,2.0,1.0,"Bear with Me (2005)"],[104832.0,2.0,3.5,"Glass Web, The (1953)"],[113232.0,1.0,3.0,"National Lampoon's Pucked (2006)"],[114232.0,1.0,3.5,"Marilena de la P7 (2006)"],[95832.0,2.0,3.0,"Elephant Boy (1937)"],[110032.0,1.0,3.0,"Blondes at Work (1938)"],[127232.0,1.0,4.0,"The Referee (2013)"],[126032.0,1.0,1.5,"Betty Boop's Hallowe'en Party (1933)"],[95232.0,2.0,0.5,"Beauty #2 (1965)"],[119832.0,1.0,1.5,"Screamers (1979)"],[129432.0,1.0,3.0,"Love and Bullets (1979)"],[126432.0,1.0,4.5,"Visitor to a Museum (Posetitel muzeya) (1989)"],[113432.0,1.0,3.5,"So Much So Fast (2006)"],[101632.0,1.0,4.5,"18 Fingers of Death! (2006)"],[3033.0,11536.0,3.4018290568654646,"Spaceballs (1987)"],[2633.0,1717.0,3.349155503785673,"Mummy, The (1932)"],[8633.0,1444.0,3.402354570637119,"Last Starfighter, The (1984)"],[1233.0,13612.0,4.139729650308551,"Boot, Das (Boat, The) (1981)"],[71033.0,1191.0,4.0465994962216625,"Secret in Their Eyes, The (El secreto de sus ojos) (2009)"],[1833.0,2389.0,3.019673503557974,"Mercury Rising (1998)"],[2433.0,3965.0,3.3383354350567465,"Civil Action, A (1998)"],[4033.0,3366.0,3.681966726084373,"Thirteen Days (2000)"],[4233.0,634.0,2.4645110410094637,"Tomcats (2001)"],[233.0,3478.0,3.523720529039678,"Exotica (1994)"],[433.0,1242.0,2.9239130434782608,"Clean Slate (1994)"],[833.0,1427.0,2.725998598458304,"High School High (1996)"],[1633.0,2400.0,3.670625,"Ulee's Gold (1997)"],[3633.0,2688.0,3.4058779761904763,"On Her Majesty's Secret Service (1969)"],[4633.0,217.0,3.1912442396313363,"Parents (1989)"],[4833.0,547.0,3.6023765996343693,"Changeling, The (1980)"],[86833.0,1407.0,3.5277185501066097,"Bridesmaids (2011)"],[8833.0,582.0,3.1872852233676974,"Vanity Fair (2004)"],[1033.0,3982.0,3.4280512305374184,"Fox and the Hound, The (1981)"],[2033.0,1415.0,3.1950530035335687,"Black Cauldron, The (1985)"],[5033.0,380.0,3.223684210526316,"Russia House, The (1990)"],[5433.0,417.0,2.821342925659472,"Silver Bullet (Stephen King's Silver Bullet) (1985)"],[44633.0,381.0,3.909448818897638,"Devil and Daniel Johnston, The (2005)"],[31433.0,548.0,3.153284671532847,"Wedding Date, The (2005)"],[5833.0,969.0,3.3493292053663573,"Dog Soldiers (2002)"],[8033.0,591.0,3.9230118443316413,"How to Steal a Million (1966)"],[5633.0,502.0,3.587649402390438,"Heaven (2002)"],[94833.0,180.0,3.441666666666667,"Pirates! Band of Misfits, The (2012)"],[5233.0,104.0,3.5336538461538463,"Road to Utopia (1946)"],[27833.0,109.0,2.9128440366972477,"Silver City (2004)"],[6233.0,215.0,2.7883720930232556,"Born Yesterday (1993)"],[63033.0,512.0,3.3369140625,"Blindness (2008)"],[3833.0,314.0,2.3662420382165603,"Brain That Wouldn't Die, The (1962)"],[63433.0,379.0,3.7994722955145117,"Farscape: The Peacekeeper Wars (2004)"],[2233.0,53.0,2.8679245283018866,"Digging to China (1998)"],[6433.0,436.0,3.9644495412844036,"Man with the Movie Camera, The (Chelovek s kino-apparatom) (1929)"],[7033.0,561.0,3.0828877005347595,"Secret of My Succe$s, The (a.k.a. The Secret of My Success) (1987)"],[82633.0,28.0,3.5892857142857144,"Kuroneko (Black Cat from the Grove, The) (Yabu no naka no kuroneko) (1968)"],[3433.0,267.0,1.8614232209737829,"Death Wish 4: The Crackdown (1987)"],[48833.0,24.0,3.125,"Jade Warrior (Jadesoturi) (2006)"],[6033.0,69.0,2.8768115942028984,"Mystery Date (1991)"],[102033.0,222.0,3.1103603603603602,"Pain & Gain (2013)"],[91233.0,127.0,3.893700787401575,"Lifted (2006)"],[633.0,336.0,3.3735119047619047,"Denise Calls Up (1995)"],[77833.0,105.0,3.6,"Armadillo (2010)"],[27033.0,184.0,3.9347826086956523,"Kingdom II, The (Riget II) (1997)"],[99633.0,29.0,3.0,"Sweeney, The (2012)"],[4433.0,216.0,3.787037037037037,"Written on the Wind (1956)"],[33.0,65.0,3.0076923076923077,"Wings of Courage (1995)"],[2833.0,166.0,3.253012048192771,"Lucie Aubrac (1997)"],[7833.0,278.0,3.856115107913669,"Shadow of the Thin Man (1941)"],[40033.0,38.0,3.6447368421052633,"Adventures of Prince Achmed, The (Abenteuer des Prinzen Achmed, Die) (1926)"],[1433.0,67.0,2.1940298507462686,"Machine, The (1994)"],[6833.0,12.0,3.2083333333333335,"Debut, The (2000)"],[78633.0,39.0,3.576923076923077,"Casino Jack and the United States of Money (2010)"],[40833.0,16.0,3.625,"Fists in the Pocket (Pugni in tasca, I) (1965)"],[77233.0,66.0,3.8636363636363638,"Union: The Business Behind Getting High, The (2007)"],[54833.0,34.0,3.661764705882353,"Brighton Rock (1947)"],[129233.0,1.0,2.0,"Believe Me (2014)"],[86233.0,28.0,2.8035714285714284,"New Kids Turbo (2010)"],[56633.0,97.0,3.118556701030928,"Butterfly on a Wheel (Shattered) (2007)"],[72833.0,6.0,3.5833333333333335,"Art of Travel, The (2008)"],[25833.0,108.0,3.7546296296296298,"Camille (1936)"],[79633.0,13.0,3.8461538461538463,"Kautokeino Rebellion, The (Kautokeino-opprøret) (2008)"],[87433.0,18.0,3.0555555555555554,"Ghidorah, the Three-Headed Monster (San daikaijû: Chikyû saidai no kessen) (1964)"],[3233.0,12.0,2.9583333333333335,"Smashing Time (1967)"],[77433.0,16.0,3.78125,"Ten Commandments, The (1923)"],[6633.0,10.0,2.6,"Prince of Jutland (a.k.a. Royal Deceit) (1994)"],[103233.0,20.0,3.125,"LEGO Batman: The Movie - DC Heroes Unite (2013)"],[67233.0,5.0,3.2,"Young Thugs: Nostalgia (Kishiwada shônen gurentai: Bôkyô) (1998)"],[114033.0,35.0,2.914285714285714,"Into the Storm (2014)"],[26033.0,8.0,3.5625,"Giants and Toys (Kyojin to gangu) (1958)"],[109633.0,15.0,3.566666666666667,"Garden of Words, The (Koto no ha no niwa) (2013)"],[115633.0,2.0,3.25,"Archangel (2005)"],[80033.0,3.0,2.0,"President's Man, The (2000)"],[81633.0,4.0,3.75,"Dark and Stormy Night (2009)"],[71433.0,8.0,3.625,"Black God, White Devil (Deus e o Diabo na Terra do Sol) (1964)"],[53833.0,11.0,3.9545454545454546,"David Holzman's Diary (1967)"],[69233.0,9.0,3.0555555555555554,"Blind Husbands (1919)"],[70833.0,10.0,3.45,"Queen Kelly (1929)"],[110633.0,3.0,3.0,"Arsène Lupin (1932)"],[51433.0,6.0,2.75,"Changing Times (Les temps qui changent) (2004)"],[92633.0,2.0,3.25,"Castle of Sand, The (Suna no utsuwa) (1974)"],[83833.0,8.0,3.6875,"Street Angel (1928)"],[98633.0,2.0,3.75,"My Lucky Stars (Fuk sing go jiu) (1985)"],[101233.0,3.0,2.3333333333333335,"Glass Menagerie, The (1950)"],[102233.0,1.0,4.0,"Verlorene, Der (Lost One, The) (1951)"],[104033.0,3.0,2.5,"Love, Marilyn (2012)"],[111233.0,2.0,3.25,"Tentacles (Tentacoli) (1977)"],[127033.0,1.0,4.5,"Mother, I Love You (2013)"],[26433.0,6.0,4.25,"Rockers (1978)"],[115233.0,1.0,2.5,"Berlin Babylon (2001)"],[65033.0,6.0,3.0,"Girls Rock! (2007)"],[32433.0,1.0,2.0,"Mixed Blood (1984)"],[104233.0,3.0,3.8333333333333335,"Cat and the Canary, The (1939)"],[114633.0,2.0,3.0,"Junkopia (1981)"],[116833.0,1.0,3.5,"Son of the White Mare (1981)"],[110433.0,3.0,3.0,"Möbius (2013)"],[110233.0,1.0,2.5,"Man at Bath (Homme au bain) (2010)"],[126233.0,1.0,1.5,"Seventh Heaven (1993)"],[86033.0,6.0,2.6666666666666665,"Flodder in Amerika! (1992)"],[65633.0,4.0,3.25,"Fuel (2008)"],[7233.0,4.0,1.625,"My Letter to George (Mesmerized) (1986)"],[101433.0,1.0,1.0,"Moving Out (1983)"],[87033.0,5.0,3.5,"Ballad of the Paper Balloons (a.k.a. Humanity and Paper Balloons) (Ninjô kami fûsen) (1937)"],[80233.0,3.0,2.1666666666666665,"Truth, The (2010) "],[101833.0,2.0,2.75,"About Face: Supermodels Then and Now (2012)"],[105833.0,2.0,1.0,"Bloody New Year (1987)"],[68833.0,3.0,3.1666666666666665,"How to Cook Your Life (2007)"],[116233.0,1.0,3.0,"Confidence Girl (1952)"],[121033.0,1.0,3.0,"A Patriotic Man (2013)"],[43633.0,3.0,3.8333333333333335,"Lt. Robin Crusoe, U.S.N. (1966)"],[109833.0,2.0,3.5,"Blackbeard, the Pirate (1952)"],[88633.0,3.0,2.0,"Adopted (2009)"],[52033.0,6.0,3.3333333333333335,"Tall Target, The (1951)"],[58033.0,1.0,3.0,"Already Dead (2007)"],[113033.0,1.0,3.5,"Rasmus på luffen (1981)"],[100633.0,2.0,3.75,"Scarecrow, The (1972)"],[89833.0,1.0,3.0,"Bad Girl (1931)"],[127433.0,1.0,4.0,"High School Hellcats (1958)"],[94433.0,1.0,3.0,"Guilty Hands (1931)"],[103633.0,1.0,4.5,"Making a Killing: The Untold Story of Psychotropic Drugging (2008)"],[114433.0,1.0,4.0,"Dead Times (Temps morts, Les) (1965)"],[68233.0,1.0,3.0,"Man Behind the Gun, The (1953)"],[104633.0,1.0,3.5,"French Roast (2008)"],[87633.0,1.0,3.5,"Scenic Route, The (1978)"],[116433.0,1.0,1.0,"America's Most Haunted Inns (2004)"],[103433.0,1.0,3.0,"Grandpa for Christmas, A (Bert & Becca) (2007)"],[120833.0,1.0,3.0,"Super Capers (2009)"],[6834.0,46.0,2.6847826086956523,"Wilder Napalm (1993)"],[2034.0,2182.0,2.8285976168652613,"Black Hole, The (1979)"],[434.0,24940.0,3.0573376102646352,"Cliffhanger (1993)"],[4034.0,16379.0,3.8272483057573723,"Traffic (2000)"],[64034.0,1008.0,3.8546626984126986,"Boy in the Striped Pajamas, The (Boy in the Striped Pyjamas, The) (2008)"],[34.0,32255.0,3.6430940939389242,"Babe (1995)"],[7034.0,1747.0,3.8234115626788783,"Show Me Love (Fucking Åmål) (1998)"],[7234.0,905.0,4.035911602209945,"Strada, La (1954)"],[234.0,3269.0,2.679718568369532,"Exit to Eden (1994)"],[1234.0,14926.0,4.173556210639153,"Sting, The (1973)"],[81834.0,3884.0,3.879119464469619,"Harry Potter and the Deathly Hallows: Part 1 (2010)"],[51834.0,603.0,3.5630182421227197,"Becoming Jane (2007)"],[1834.0,4521.0,3.8821057288210574,"Spanish Prisoner, The (1997)"],[3634.0,895.0,4.0206703910614525,"Seven Days in May (1964)"],[3034.0,4525.0,3.6796685082872926,"Robin Hood (1973)"],[4234.0,1534.0,2.9664276401564535,"Tailor of Panama, The (2001)"],[1034.0,1502.0,3.5392809587217045,"Freeway (1996)"],[2634.0,638.0,3.103448275862069,"Mummy, The (1959)"],[2834.0,192.0,3.3098958333333335,"Very Thought of You, The (1998)"],[33834.0,1202.0,3.2429284525790347,"Land of the Dead (2005)"],[62434.0,1880.0,3.359042553191489,"Zack and Miri Make a Porno (2008)"],[1434.0,60.0,3.066666666666667,"Stranger, The (1994)"],[3834.0,520.0,2.8173076923076925,"Bronco Billy (1980)"],[5434.0,386.0,3.7966321243523318,"Sorry, Wrong Number (1948)"],[5034.0,941.0,3.773645058448459,"Truly, Madly, Deeply (1991)"],[7834.0,490.0,3.904081632653061,"After the Thin Man (1936)"],[87234.0,449.0,3.7416481069042318,"Submarine (2010)"],[5634.0,31.0,3.1774193548387095,"Pipe Dream (2002)"],[27434.0,235.0,2.5148936170212766,"Darkness (2002)"],[27834.0,466.0,3.913090128755365,"Return, The (Vozvrashcheniye) (2003)"],[39234.0,622.0,3.5860128617363345,"North Country (2005)"],[5234.0,106.0,3.2358490566037736,"Road to Zanzibar (1941)"],[4634.0,228.0,3.1600877192982457,"Penn & Teller Get Killed (1989)"],[25834.0,142.0,3.73943661971831,"Captains Courageous (1937)"],[78034.0,148.0,3.456081081081081,"Cemetery Junction (2010)"],[59834.0,50.0,2.77,"100 Rifles (1969)"],[634.0,334.0,2.320359281437126,"Theodore Rex (1995)"],[26834.0,47.0,2.606382978723404,"Philadelphia Experiment II (1993)"],[6234.0,156.0,3.451923076923077,"Equus (1977)"],[4834.0,474.0,2.809071729957806,"Cheech & Chong's Next Movie (1980)"],[8634.0,119.0,2.588235294117647,"Tank (1984)"],[3434.0,213.0,1.9061032863849765,"Death Wish 5: The Face of Death (1994)"],[8834.0,36.0,2.25,"Cookout, The (2004)"],[62834.0,117.0,2.952991452991453,"Babylon 5: The Legend of the Rangers: To Live and Die in Starlight (2002)"],[6034.0,19.0,2.473684210526316,"Paradise, Hawaiian Style (1966)"],[6434.0,49.0,3.357142857142857,"Objective, Burma! (1945)"],[834.0,203.0,2.645320197044335,"Phat Beach (1996)"],[92234.0,77.0,2.935064935064935,"Red Tails (2012)"],[42634.0,54.0,3.259259259259259,"Boys Don't Cry (Chlopaki nie placza) (2000)"],[47634.0,124.0,3.5120967741935485,"36 Quai des Orfèvres (Department 36) (2004)"],[2234.0,56.0,2.5714285714285716,"Let's Talk About Sex (1998)"],[58434.0,17.0,2.9411764705882355,"Little Trip to Heaven, A (2005)"],[103834.0,6.0,3.3333333333333335,"Fetching Cody (2005)"],[106234.0,14.0,3.2142857142857144,"Great Expectations (2012)"],[46034.0,24.0,3.3541666666666665,"Mountain Patrol (Kekexili) (2004)"],[46634.0,6.0,3.1666666666666665,"These Girls (2005)"],[4434.0,91.0,3.2472527472527473,"10th Victim, The (La decima vittima) (1965)"],[84234.0,17.0,3.735294117647059,"Simple Simon (I rymden finns inga känslor) (2010)"],[61434.0,9.0,3.5,"Oh! What a Lovely War (1969)"],[5834.0,48.0,3.2604166666666665,"Fingers (1978)"],[32234.0,116.0,3.6810344827586206,"Julia (1977)"],[97834.0,16.0,3.0,"Craigslist Joe (2012)"],[112434.0,3.0,3.3333333333333335,"In Bloom (Grzeli nateli dgeebi) (2013)"],[2434.0,271.0,3.5,"Down in the Delta (1998)"],[75434.0,8.0,3.8125,"Wrestler, The (Painija) (1985)"],[100034.0,17.0,3.1470588235294117,"Girl Model (2011)"],[32834.0,44.0,3.3068181818181817,"Macbeth (1948)"],[96034.0,4.0,3.125,"Hierro (2009) "],[64234.0,47.0,2.4680851063829787,"Guyver, The (1991)"],[73834.0,3.0,2.0,"Pokrajina St.2 (2008)"],[3234.0,3.0,3.3333333333333335,"Train Ride to Hollywood (1975)"],[90634.0,2.0,4.0,"Doll, The (Lalka) (1968)"],[96634.0,14.0,3.107142857142857,"Emergo (Apartment 143) (2011)"],[66234.0,23.0,3.239130434782609,"Jar City (Mýrin) (2006)"],[82834.0,7.0,3.142857142857143,"Elena and Her Men (Paris Does Strange Things) (Elena et les hommes) (1956)"],[83034.0,11.0,3.6363636363636362,"Death of a Salesman (1951)"],[98834.0,4.0,3.75,"Fitzgerald Family Christmas, The (2012)"],[6634.0,11.0,2.3181818181818183,"Rowing with the Wind (Remando al viento) (1988)"],[90434.0,21.0,3.0952380952380953,"Assassination Games (2011)"],[41434.0,7.0,3.642857142857143,"After Innocence (2005)"],[129034.0,1.0,5.0,"Serving Life (2011)"],[27234.0,2.0,3.25,"Underground Comedy Movie, The  (1999)"],[91634.0,15.0,3.1,"G.I. Joe: The Revenge of Cobra (1984)"],[97234.0,12.0,3.7083333333333335,"Inside: 'Dr. Strangelove or How I Learned to Stop Worrying and Love the Bomb' (2000)"],[84834.0,14.0,3.1785714285714284,"Three Kingdoms: Resurrection of the Dragon (Saam gwok dzi gin lung se gap) (2008)"],[78834.0,1.0,3.5,"Tomorrow at Dawn (Demain dès l'aube) (2009)"],[80834.0,20.0,3.65,"Sintel (2010)"],[44234.0,8.0,2.8125,"Illustrated Man, The (1969)"],[71634.0,12.0,3.25,"Story of Louis Pasteur, The (1935)"],[130834.0,1.0,2.5,"Dancers (1987)"],[96834.0,24.0,3.2291666666666665,"Knuckleball! (2012)"],[99434.0,7.0,3.357142857142857,"Snow on Tha Bluff (2011)"],[26034.0,13.0,3.576923076923077,"Last Hurrah, The (1958)"],[117434.0,7.0,3.0714285714285716,"Starry Eyes (2014)"],[74434.0,9.0,3.6666666666666665,"Wounds, The (Rane) (1998)"],[95034.0,14.0,2.5357142857142856,"Few Best Men, A (2011)"],[114834.0,2.0,3.0,"Hellgate (1989)"],[102434.0,2.0,2.75,"Huey P. Newton Story, A (2001)"],[128634.0,1.0,3.5,"Invisible Ghost (1941)"],[95234.0,6.0,3.3333333333333335,"Wings in the Dark (1935)"],[73234.0,2.0,2.5,"Command Performance (2009)"],[109434.0,1.0,2.0,"Psychosis (2010)"],[86434.0,3.0,2.8333333333333335,"Wrong Rosary (Uzak ihtimal) (2009)"],[129834.0,1.0,0.5,"Tom and Jerry: The Lost Dragon (2014)"],[61634.0,10.0,2.3,"Son of Lassie (1945)"],[107634.0,2.0,2.75,"Grand Tour: Disaster in Time (Timescape) (1992)"],[49234.0,7.0,3.2857142857142856,"Red Dust (2004)"],[87834.0,6.0,3.75,"My Life as McDull (Mak dau goo si) (2001)"],[72634.0,2.0,3.5,"Hoop Realities (2007)"],[106834.0,1.0,4.0,"Deeper Shade of Blue, A (2011)"],[116034.0,1.0,3.5,"Children of the Corn: Genesis (2011)"],[52634.0,5.0,3.5,"Smash-Up: The Story of a Woman (1947)"],[98034.0,3.0,1.5,"Children of the Living Dead (2001)"],[128834.0,1.0,4.5,"Naked (2000)"],[106434.0,1.0,0.5,"Chillers (1987)"],[107234.0,1.0,1.5,"Deadly Surveillance (1991)"],[93834.0,4.0,3.125,"Ticked-Off Trannies with Knives (2010)"],[107434.0,1.0,5.0,"Diplomatic Immunity (2009– )"],[105034.0,6.0,3.8333333333333335,"Shadowlands (1985)"],[34234.0,1.0,2.0,"Pornography (Pornografia) (2003)"],[105234.0,2.0,3.5,"Wanda Sykes: Sick and Tired (2006)"],[26634.0,5.0,3.1,"Pascali's Island (1988)"],[55434.0,2.0,3.25,"Between Heaven and Hell (1956)"],[130034.0,1.0,4.5,"Stand by Me Doraemon (2014)"],[125634.0,1.0,4.0,"Giuseppe Makes a Movie (2014)"],[113434.0,2.0,4.25,"What About Dick? (2012)"],[113634.0,2.0,3.5,"Message from Akira Kurosawa: For Beautiful Movies, A (Kurosawa Akira kara no messêji: Utsukushii eiga o) (2000)"],[115834.0,1.0,3.0,"Charlie Chan's Murder Cruise (1940)"],[91834.0,5.0,2.9,"Born to Race (2011)"],[106634.0,2.0,3.0,"Raisin in the Sun, A (2008)"],[113834.0,2.0,3.0,"Piripäiväkirja (2014)"],[113234.0,2.0,3.25,"Thirty-Nine Steps, The (1978)"],[109034.0,2.0,2.25,"Evidence (1995)"],[114234.0,1.0,2.5,"Uncle Marin, the Billionaire (Nea Marin miliardar) (Uncle Martin, the Multimillionaire) (1979)"],[110034.0,1.0,3.5,"Blondie of the Follies (1932)"],[127234.0,1.0,3.5,"Reality (2012)"],[126034.0,1.0,1.5,"Halloween (1931)"],[76034.0,1.0,4.0,"Cross: The Arthur Blessitt Story, The (2009)"],[127634.0,1.0,2.0,"Sebastian (1968)"],[79234.0,1.0,3.5,"Snake-Crane Secret (She hao dan xin zhen jiu zhou) (1976)"],[126434.0,1.0,3.0,"The Hyperboloid of Engineer Garin (Giperboloid inzhenera Garina) (1965)"],[101634.0,1.0,0.5,"Get2Gether, A (2005)"],[235.0,16419.0,3.6636518667397526,"Ed Wood (1994)"],[1035.0,14049.0,3.8044344793223717,"Sound of Music, The (1965)"],[3235.0,453.0,3.1490066225165565,"Where the Buffalo Roam (1980)"],[4235.0,5511.0,4.0168753402286335,"Amores Perros (Love's a Bitch) (2000)"],[435.0,13911.0,2.5935590539860542,"Coneheads (1993)"],[1835.0,4823.0,3.2564793696869168,"City of Angels (1998)"],[7235.0,1007.0,3.4697120158887786,"Ichi the Killer (Koroshiya 1) (2001)"],[39435.0,889.0,3.079865016872891,"Legend of Zorro, The (2005)"],[1635.0,5570.0,3.8045780969479353,"Ice Storm, The (1997)"],[3635.0,4179.0,3.541517109356305,"Spy Who Loved Me, The (1977)"],[3435.0,4909.0,4.224281931146873,"Double Indemnity (1944)"],[4435.0,49.0,3.3979591836734695,"Colonel Redl (Oberst Redl) (1985)"],[4835.0,1172.0,3.650170648464164,"Coal Miner's Daughter (1980)"],[3035.0,2522.0,4.052339413164155,"Mister Roberts (1955)"],[1235.0,8066.0,3.999814034217704,"Harold and Maude (1971)"],[88235.0,436.0,3.697247706422018,"Guard, The (2011)"],[2835.0,461.0,2.319956616052061,"Chill Factor (1999)"],[8835.0,189.0,2.687830687830688,"Paparazzi (2004)"],[35.0,1493.0,3.5016744809109177,"Carrington (1995)"],[635.0,1100.0,3.6454545454545455,"Family Thing, A (1996)"],[2435.0,667.0,2.95952023988006,"Hurlyburly (1998)"],[2235.0,32.0,2.4375,"One Man's Hero (1999)"],[3835.0,869.0,2.609896432681243,"Crush, The (1993)"],[4035.0,326.0,3.2423312883435584,"Claim, The (2000)"],[4635.0,402.0,2.3333333333333335,"Pink Cadillac (1989)"],[5235.0,148.0,2.989864864864865,"Split Second (1992)"],[5435.0,244.0,3.622950819672131,"Hombre (1967)"],[86835.0,340.0,2.875,"Priest (2011)"],[6235.0,909.0,3.9697469746974696,"Europa Europa (Hitlerjunge Salomon) (1990)"],[52435.0,1501.0,3.798134576948701,"How the Grinch Stole Christmas! (1966)"],[2035.0,324.0,3.103395061728395,"Blackbeard's Ghost (1968)"],[835.0,947.0,3.1768743400211195,"Foxfire (1996)"],[31435.0,247.0,3.840080971659919,"Rory O'Shea Was Here (Inside I'm Dancing) (2004)"],[5635.0,194.0,3.304123711340206,"Man from Elysian Fields, The (2001)"],[8235.0,319.0,3.9357366771159876,"Safety Last! (1923)"],[88835.0,39.0,2.576923076923077,"Glee: The 3D Concert Movie (2011)"],[45635.0,232.0,3.1810344827586206,"Notorious Bettie Page, The (2005)"],[53435.0,468.0,2.661324786324786,"Hostel: Part II (2007)"],[7035.0,175.0,2.9285714285714284,"Streets of Fire (1984)"],[2635.0,176.0,3.0511363636363638,"Mummy's Curse, The (1944)"],[72035.0,16.0,3.6875,"Dimensions of Dialogue (Moznosti dialogu) (1982)"],[31035.0,186.0,3.7204301075268815,"Testament (1983)"],[43635.0,63.0,3.134920634920635,"Bye Bye Birdie (1963)"],[6435.0,32.0,3.15625,"Operation Pacific (1951)"],[87435.0,14.0,2.25,"Sergeant Körmy and the South Pacific (Vääpeli Körmy ja etelän hetelmät) (1992)"],[114635.0,8.0,4.0,"Look of Silence, The (2014)"],[120635.0,94.0,2.824468085106383,"Taken 3 (2015)"],[8035.0,83.0,2.86144578313253,"Stendhal Syndrome, The (Sindrome di Stendhal, La) (1996)"],[6035.0,163.0,3.726993865030675,"Pépé le Moko (1937)"],[5035.0,116.0,3.1982758620689653,"Wuthering Heights (1970)"],[103235.0,135.0,3.8666666666666667,"Best Offer, The (Migliore offerta, La) (2013)"],[6835.0,36.0,2.5277777777777777,"Alien Contamination (1980)"],[105835.0,90.0,3.4277777777777776,"Double, The (2013)"],[25835.0,89.0,3.4831460674157304,"Dead End (1937)"],[68835.0,57.0,3.692982456140351,"Were the World Mine (2008)"],[7835.0,169.0,3.7366863905325443,"Song of the Thin Man (1947)"],[65435.0,102.0,2.6323529411764706,"Open Season 2 (2008)"],[96435.0,3.0,3.3333333333333335,"Chameleon (Kaméleon) (2008)"],[111235.0,87.0,3.8793103448275863,"Jodorowsky's Dune (2013)"],[65235.0,24.0,3.5,"Grocer's Son, The (Fils de l'épicier, Le) (2007)"],[62235.0,136.0,3.4963235294117645,"Red (2008)"],[91035.0,34.0,3.0588235294117645,"Wuthering Heights (2011)"],[80235.0,6.0,3.4166666666666665,"Wedding Song, The (2008) "],[6635.0,62.0,3.0080645161290325,"Rachel Papers, The (1989)"],[48035.0,29.0,3.2586206896551726,"Pretty Poison (1968)"],[82635.0,5.0,3.1,"Glue (2006)"],[53835.0,41.0,3.6951219512195124,"Journey to Italy (Viaggio in Italia) (Voyage to Italy) (Voyage in Italy) (1954)"],[86635.0,2.0,2.25,"Vice (2008)"],[49035.0,14.0,3.2857142857142856,"Daddy Long Legs (1955)"],[129235.0,1.0,3.5,"Les Invisibles (2012)"],[5835.0,20.0,3.175,"Good Evening, Mr. Wallenberg (God afton, Herr Wallenberg) (1990)"],[34435.0,52.0,3.7884615384615383,"Sholay (1975)"],[8635.0,28.0,2.642857142857143,"Jungle Holocaust (Ultimo mondo cannibale) (1977)"],[78635.0,10.0,3.05,"Under the North Star (Täällä Pohjantähden alla) (2009)"],[26435.0,11.0,2.8636363636363638,"Starting Over (1979)"],[26835.0,6.0,3.5833333333333335,"Positively True Adventures of the Alleged Texas Cheerleader-Murdering Mom, The (1993)"],[27835.0,12.0,3.4583333333333335,"Agronomist, The (2003)"],[33435.0,22.0,3.7954545454545454,"Los Angeles Plays Itself (2003)"],[78235.0,18.0,3.9444444444444446,"Betrayal (1983)"],[94835.0,1.0,3.5,"Vie meilleure, Une (Better Life, A) (2011)"],[83435.0,3.0,3.5,"Hatful of Rain, A (1957)"],[49435.0,25.0,2.58,"Reeker (2005)"],[83835.0,9.0,3.2777777777777777,"Frozen North, The (1922)"],[121235.0,6.0,2.25,"The Anomaly (2014)"],[121035.0,9.0,3.4444444444444446,"Houdini (2014)"],[56835.0,6.0,0.75,"Pledge This! (2006)"],[61035.0,19.0,2.763157894736842,"W Delta Z (a.k.a. The Killing Gene) (2007)"],[95835.0,12.0,2.25,"Forger, The (2012)"],[77835.0,6.0,2.5833333333333335,"Stage Door Canteen (1943)"],[38435.0,5.0,3.0,"Forty Shades of Blue (2005)"],[82035.0,17.0,3.3823529411764706,"Cocaine Cowboys II: Hustlin' With the Godmother (2008)"],[70235.0,15.0,2.933333333333333,"Dallas 362 (2003)"],[92635.0,2.0,3.0,"At Home by Myself... with You (2009)"],[103635.0,2.0,3.5,"Pax Americana and the Weaponization of Space (2009)"],[59435.0,19.0,3.3157894736842106,"Numb (2007)"],[97035.0,4.0,2.5,"Living Skeleton, The (Kyûketsu dokuro-sen) (1968)"],[102235.0,4.0,3.125,"Manhunt (2013)"],[79035.0,9.0,3.7222222222222223,"Hold Back the Dawn (1941)"],[81435.0,3.0,2.8333333333333335,"Haunted Castle, The (Schloß Vogeloed) (1921)"],[101235.0,11.0,3.3636363636363638,"Great Gatsby, The (1949)"],[33235.0,6.0,3.75,"Isadora (1968)"],[120835.0,7.0,2.5,"Fight for Your Right Revisited (2011)"],[127035.0,1.0,3.0,"Dream Team 1935 (2012)"],[129435.0,1.0,3.0,"Piggy (2012)"],[114035.0,13.0,3.5,"Calling, The (2014)"],[104035.0,3.0,2.3333333333333335,"Beneath (2013)"],[113035.0,3.0,2.5,"Bachelor Weekend, The (2013)"],[115235.0,8.0,2.1875,"Young Ones (2014)"],[26035.0,2.0,3.0,"Machine Gun Kelly (1958)"],[79835.0,4.0,2.125,"Like It Is (1998)"],[102035.0,1.0,2.0,"Holding, The (2011)"],[126235.0,1.0,3.0,"La Belle équipe (1936)"],[101835.0,1.0,3.5,"According to Spencer (2001)"],[48235.0,1.0,4.5,"Flight from Death: The Quest for Immortality (2003)"],[104835.0,1.0,1.5,"Incredible Melting Man, The (1977)"],[110235.0,4.0,3.0,"Our Paradise (Notre paradis) (2011)"],[27235.0,1.0,4.0,"Shrink Is In, The (2001)"],[89635.0,1.0,3.5,"Story of Me, The (O contador de histórias) (2009)"],[110635.0,1.0,3.5,"Beauty and the Beast (1962)"],[90235.0,2.0,3.0,"Happiest Girl in the World, The (Cea mai fericita fata din lume) (2009)"],[109635.0,6.0,3.5833333333333335,"Pandora's Promise (2013)"],[26235.0,5.0,3.3,"Long Live Death (Viva la muerte) (1971)"],[105435.0,1.0,2.0,"Narrien illat (1970) "],[72235.0,1.0,5.0,"Between the Devil and the Deep Blue Sea (1995)"],[77435.0,1.0,2.5,"This Is the Army (1943)"],[82235.0,1.0,2.5,"Story of Three Loves, The (1953)"],[93035.0,2.0,2.75,"Great Sinner, The (1949)"],[103435.0,1.0,3.0,"Ah, Wilderness! (1935)"],[119035.0,1.0,3.5,"Swindle (1977)"],[124235.0,1.0,3.0,"Precious Find (1996)"],[92435.0,1.0,3.0,"Dancing Hawk, The (Tanczacy jastrzab) (1978)"],[116435.0,1.0,3.5,"Building the Inferno: Nobuo Nakagawa and the Making of 'Jigoku' (2006)"],[91235.0,1.0,3.0,"Living Will... (2010)"],[109235.0,1.0,2.5,"Beyond Tomorrow (Beyond Christmas) (1940)"],[1036.0,30399.0,3.9338465081088194,"Die Hard (1988)"],[8636.0,15712.0,3.551107433808554,"Spider-Man 2 (2004)"],[2236.0,1817.0,3.4507429829389102,"Simon Birch (1998)"],[236.0,12215.0,3.3153499795333605,"French Kiss (1995)"],[35836.0,9588.0,3.554182311222361,"40-Year-Old Virgin, The (2005)"],[36.0,20809.0,3.9427170935652844,"Dead Man Walking (1995)"],[3836.0,2151.0,3.800092980009298,"Kelly's Heroes (1970)"],[2836.0,1235.0,3.25748987854251,"Outside Providence (1999)"],[836.0,4860.0,2.907716049382716,"Chain Reaction (1996)"],[4436.0,162.0,3.419753086419753,"Obsession (1976)"],[1236.0,942.0,4.042993630573249,"Trust (1990)"],[1636.0,78.0,2.4935897435897436,"Stag (1997)"],[2436.0,1311.0,3.400839054157132,"Tea with Mussolini (1999)"],[61236.0,1013.0,3.9284304047384007,"Waltz with Bashir (Vals im Bashir) (2008)"],[4036.0,2389.0,3.4416073670992047,"Shadow of the Vampire (2000)"],[2036.0,1074.0,2.339851024208566,"Blank Check (1994)"],[4636.0,608.0,2.34375,"Punisher, The (1989)"],[7036.0,1091.0,2.7937671860678277,"Teen Wolf (1985)"],[69436.0,605.0,2.5322314049586776,"Year One (2009)"],[1836.0,1533.0,3.2961513372472275,"Last Days of Disco, The (1998)"],[3036.0,1124.0,3.261120996441281,"Quest for Fire (Guerre du feu, La) (1981)"],[436.0,1239.0,2.6073446327683616,"Color of Night (1994)"],[2636.0,74.0,2.6013513513513513,"Mummy's Ghost, The (1944)"],[3236.0,23.0,2.782608695652174,"Zachariah (1971)"],[5036.0,223.0,3.1121076233183858,"California Suite (1978)"],[6636.0,893.0,3.604703247480403,"Sure Thing, The (1985)"],[7836.0,1017.0,3.887905604719764,"Woodstock (1970)"],[100436.0,58.0,3.8275862068965516,"Gatekeepers, The (2012)"],[33836.0,1381.0,2.610065170166546,"Bewitched (2005)"],[78836.0,347.0,3.670028818443804,"Enter the Void (2009)"],[1436.0,68.0,2.9705882352941178,"Falling in Love Again (1980)"],[6436.0,752.0,3.5997340425531914,"This Boy's Life (1993)"],[8836.0,524.0,3.2786259541984735,"Wicker Park (2004)"],[33036.0,179.0,3.2430167597765363,"Eiger Sanction, The (1975)"],[43836.0,785.0,2.6305732484076434,"Pink Panther, The (2006)"],[7636.0,201.0,2.853233830845771,"Raising Cain (1992)"],[27636.0,88.0,3.4545454545454546,"Herr Lehmann (2003)"],[5636.0,264.0,3.0568181818181817,"Welcome to Collinwood (2002)"],[63436.0,615.0,2.7178861788617885,"Saw V (2008)"],[7236.0,464.0,3.4008620689655173,"Boy and His Dog, A (1975)"],[4836.0,181.0,3.425414364640884,"Competition, The (1980)"],[3436.0,772.0,2.773316062176166,"Dying Young (1991)"],[5436.0,99.0,3.474747474747475,"Horse's Mouth, The (1958)"],[5836.0,269.0,3.3884758364312266,"Houseboat (1958)"],[27036.0,166.0,3.4096385542168677,"Merlin (1998)"],[62836.0,103.0,3.2184466019417477,"Babylon 5: The Lost Tales - Voices in the Dark (2007)"],[75436.0,17.0,2.823529411764706,"Skin, Skin (Käpy selän alla) (1966)"],[4236.0,127.0,3.4173228346456694,"Keep the River on Your Right: A Modern Cannibal Tale (2000)"],[97836.0,109.0,3.1376146788990824,"Here Comes the Boom (2012)"],[55036.0,8.0,2.4375,"Gotti (1996)"],[98836.0,59.0,3.093220338983051,"Hyde Park on Hudson (2012)"],[3636.0,53.0,2.9056603773584904,"Those Who Love Me Can Take the Train (Ceux qui m'aiment prendront le train) (1998)"],[63836.0,24.0,3.0,"Manson Family, The (2003)"],[6236.0,59.0,3.4661016949152543,"Fear Strikes Out (1957)"],[92236.0,38.0,3.6578947368421053,"In Darkness (2011)"],[5236.0,68.0,3.610294117647059,"Tale of Springtime, A (Conte de Printemps) (1990)"],[38036.0,10.0,3.7,"Medea (1988)"],[636.0,35.0,2.9,"Frisk (1995)"],[27236.0,8.0,2.8125,"Charisma (Karisuma) (1999)"],[6036.0,107.0,3.1121495327102804,"Secret Admirer (1985)"],[47836.0,50.0,3.45,"Sketches of Frank Gehry (2005)"],[40436.0,10.0,3.2,"Stratton Story, The (1949)"],[118236.0,1.0,4.5,"Bleak Night (2010)"],[84236.0,26.0,3.7115384615384617,"White Stripes Under Great White Northern Lights, The (2009)"],[107436.0,23.0,3.282608695652174,"Haunter (2013)"],[92836.0,10.0,3.6,"Knuckle (2011) "],[36436.0,13.0,3.4615384615384617,"Holy Girl, The (Niña santa, La) (2004)"],[111436.0,19.0,3.8684210526315788,"Jim Gaffigan: Obsessed (2014)"],[35636.0,34.0,2.8088235294117645,"Teen Witch (1989)"],[74436.0,30.0,2.966666666666667,"Body Bags (1993)"],[106236.0,13.0,3.3846153846153846,"Somm (2012)"],[26436.0,3.0,2.3333333333333335,"Barnens ö (1980)"],[45036.0,4.0,3.625,"Chess Players, The (Shatranj Ke Khilari) (1977)"],[6836.0,23.0,2.5217391304347827,"Amazing Transparent Man, The (1960)"],[8236.0,39.0,3.423076923076923,"While the City Sleeps (1956)"],[87636.0,4.0,3.5,"Run, Man, Run! (Corri uomo corri) (1968)"],[60436.0,14.0,3.142857142857143,"Honeydripper (2007)"],[27436.0,12.0,2.875,"Mockingbird Don't Sing (2001)"],[64236.0,39.0,3.2435897435897436,"Flashbacks of a Fool (2008)"],[87036.0,6.0,3.0833333333333335,"Comedy of Innocence (Comédie de l'innocence) (2000)"],[79236.0,2.0,4.0,"Yumeji (1991)"],[99636.0,12.0,3.7083333333333335,"English Vinglish (2012)"],[103836.0,2.0,2.75,"Black & White & Sex (2012)"],[26236.0,12.0,3.9166666666666665,"White Sun of the Desert, The (Beloe solntse pustyni) (1970)"],[129036.0,1.0,5.0,"People of the Wind (1976)"],[31636.0,20.0,2.8,"Bunker, The (2001)"],[116036.0,3.0,3.0,"Children of the Corn: Revelation (2001)"],[112436.0,11.0,3.5454545454545454,"Very Good Girls (2014)"],[32836.0,7.0,3.5,"Garage Olimpo (1999)"],[84836.0,2.0,1.75,"Spiders, Part 2: The Diamond Ship, The (Die Spinnen, 2. Teil - Das Brillantenschiff) (1920)"],[80836.0,13.0,2.6538461538461537,"Big Buck Bunny (2008)"],[104636.0,15.0,4.233333333333333,"TT3D: Closer to the Edge (2011)"],[79636.0,2.0,3.25,"Inner Life of Martin Frost, The (2007)"],[42636.0,3.0,2.0,"Superproduction (Superprodukcja) (2003)"],[57236.0,8.0,3.1875,"LOL (2006)"],[86436.0,4.0,3.125,"Crimson Kimono, The (1959)"],[66036.0,1.0,3.0,"Wrestling with Alligators (1998)"],[114836.0,2.0,3.25,"Sleeping Car, The (1990)"],[114436.0,3.0,2.6666666666666665,"World of Kanako, The (Kawaki.) (2014)"],[119836.0,2.0,2.0,"The Great Alligator (1979)"],[98036.0,7.0,3.4285714285714284,"Lady, The (2011)"],[121436.0,1.0,1.0,"The Squeeze (1987)"],[130836.0,1.0,1.0,"Fifty/Fifty (1992)"],[84436.0,1.0,2.5,"Less is More (Menos es más) (2000)"],[105236.0,1.0,2.5,"Sorceress (1982)"],[130036.0,3.0,3.5,"Saints and Soldiers: The Void (2014)"],[109436.0,2.0,3.5,"Almost Man, The (Mer eller mindre mann) (2012)"],[96836.0,6.0,3.75,"Either Way (Á annan veg) (2011)"],[111036.0,1.0,2.0,"Attack from Space (1965)"],[113836.0,1.0,2.0,"Among Us (Onder Ons) (2011)"],[100836.0,3.0,2.6666666666666665,"Empty Nest (El nido vacío) (2008)"],[103036.0,1.0,4.0,"No and Me (No et moi) (2010)"],[107636.0,1.0,4.0,"Springsteen & I (2013)"],[82836.0,7.0,3.9285714285714284,"Life of Reilly, The (2006)"],[128836.0,1.0,4.0,"The Ghosts in Our Machine (2013)"],[107836.0,1.0,4.0,"Annie Get Your Gun (1967)"],[104236.0,1.0,3.0,"Criminal Justice (1990)"],[100036.0,10.0,3.05,"Crossfire Hurricane (2012)"],[112236.0,1.0,3.0,"Broadway Idiot (2013)"],[106436.0,1.0,2.5,"For Those in Peril (2013)"],[76836.0,3.0,2.8333333333333335,"Most Beautiful, The (Ichiban utsukushiku) (1944)"],[95036.0,2.0,2.75,"Late Bloomers (2011)"],[59836.0,4.0,2.875,"Blood Alley (1955)"],[102436.0,2.0,2.0,"Affair of the Heart, An (2012)"],[107236.0,1.0,3.0,"Those Daring Young Men in Their Jaunty Jalopies (1969)"],[73236.0,2.0,2.5,"Direct Contact (2009)"],[104436.0,1.0,4.0,"Viagem a Portugal (2011)"],[114236.0,1.0,3.5,"Obama Deception: The Mask Comes Off, The (2009)"],[127236.0,1.0,2.5,"Amnèsia (2002)"],[126036.0,1.0,1.0,"Barbie: A Fashion Fairytale (2010)"],[127636.0,1.0,2.5,"The Strange Affair (1968)"],[97236.0,2.0,3.5,"Shadowing the Third Man (2004)"],[113636.0,1.0,4.0,"Out of Balance: ExxonMobil's Impact on Climate Change (2006)"],[125636.0,1.0,4.5,"Youth of the Son (1952)"],[126436.0,1.0,3.0,"Cosmic Journey (1935)"],[101636.0,1.0,1.0,"Man Called Gannon, A (1968)"],[3037.0,4033.0,3.980287627076618,"Little Big Man (1970)"],[1037.0,7006.0,2.734656009135027,"Lawnmower Man, The (1992)"],[60037.0,1212.0,2.4917491749174916,"Happening, The (2008)"],[65037.0,141.0,3.5390070921985815,"Ben X (2007)"],[78637.0,676.0,3.2758875739644973,"Shrek Forever After (a.k.a. Shrek: The Final Chapter) (2010)"],[637.0,5791.0,2.8384562251769987,"Sgt. Bilko (1996)"],[437.0,1835.0,2.616076294277929,"Cops and Robbersons (1994)"],[237.0,6422.0,3.22454064154469,"Forget Paris (1995)"],[34437.0,2922.0,3.6153319644079396,"Broken Flowers (2005)"],[837.0,5294.0,3.430676237249717,"Matilda (1996)"],[1237.0,4142.0,4.102848865282472,"Seventh Seal, The (Sjunde inseglet, Det) (1957)"],[4037.0,1970.0,3.967766497461929,"House of Games (1987)"],[59037.0,501.0,3.1087824351297404,"Speed Racer (2008)"],[5237.0,749.0,3.4679572763684914,"Taps (1981)"],[27837.0,684.0,2.961988304093567,"Flight of the Phoenix (2004)"],[68237.0,4867.0,4.021060201356072,"Moon (2009)"],[2237.0,400.0,3.6575,"Without Limits (1998)"],[33437.0,1380.0,3.5170289855072463,"Unleashed (Danny the Dog) (2005)"],[2037.0,425.0,3.3188235294117647,"Candleshoe (1977)"],[3837.0,402.0,2.7587064676616917,"Phantasm II (1988)"],[4837.0,194.0,2.8376288659793816,"Cruising (1980)"],[5437.0,358.0,3.2304469273743015,"Manhattan Project, The (1986)"],[77837.0,243.0,3.6419753086419755,"You Don't Know Jack (2010)"],[84637.0,218.0,2.8440366972477062,"Gnomeo & Juliet (2011)"],[6237.0,315.0,3.6714285714285713,"Glenn Miller Story, The (1953)"],[4237.0,244.0,3.69672131147541,"Gleaners & I, The (Les glaneurs et la glaneuse) (2000)"],[99437.0,138.0,3.322463768115942,"John Dies at the End (2012)"],[7037.0,197.0,3.616751269035533,"High Heels (Tacones lejanos) (1991)"],[82037.0,142.0,3.6232394366197185,"Tillman Story, The (2010)"],[31437.0,458.0,3.9366812227074237,"Nobody Knows (Dare mo shiranai) (2004)"],[105037.0,79.0,3.0443037974683542,"To Do List, The (2013)"],[4637.0,188.0,2.132978723404255,"Red Scorpion (1989)"],[88237.0,33.0,3.3484848484848486,"Griff the Invisible (2011)"],[5637.0,471.0,3.7802547770700636,"Flirting (1991)"],[6437.0,78.0,3.4871794871794872,"13 Rue Madeleine (1947)"],[1437.0,317.0,3.673501577287066,"Cement Garden, The (1993)"],[1837.0,488.0,2.6147540983606556,"Odd Couple II, The (1998)"],[51037.0,239.0,3.3619246861924688,"Unknown (2006)"],[62437.0,519.0,3.1917148362235066,"W. (2008)"],[37.0,85.0,3.0176470588235293,"Across the Sea of Time (1995)"],[4437.0,910.0,3.6142857142857143,"Suspiria (1977)"],[2837.0,192.0,3.3125,"Bedrooms & Hallways (1998)"],[64037.0,88.0,3.096590909090909,"Surveillance (2008)"],[3437.0,139.0,1.6654676258992807,"Cool as Ice (1991)"],[86237.0,29.0,3.7758620689655173,"Connections (1978)"],[92637.0,15.0,3.5,"Pitfall (Otoshiana) (1962)"],[2637.0,169.0,2.7071005917159763,"Mummy's Hand, The (1940)"],[88837.0,33.0,3.6515151515151514,"Trotsky, The (2009)"],[2437.0,778.0,3.552056555269923,"Wilde (1997)"],[7237.0,63.0,3.007936507936508,"Last Tycoon, The (1976)"],[57637.0,117.0,3.0811965811965814,"Signal, The (2007)"],[26237.0,82.0,3.518292682926829,"Zabriskie Point (1970)"],[7637.0,128.0,3.3046875,"Irma Vep (1996)"],[6037.0,110.0,2.8227272727272728,"Summer Lovers (1982)"],[7437.0,192.0,3.1145833333333335,"Connie and Carla (2004)"],[6837.0,102.0,3.6372549019607843,"Love Affair (1939)"],[3637.0,158.0,3.7658227848101267,"Vagabond (Sans toit ni loi) (1985)"],[56837.0,29.0,3.0689655172413794,"As You Like It (2006)"],[5837.0,21.0,1.6904761904761905,"Legion of the Dead (2001)"],[5037.0,50.0,3.34,"Long Gray Line, The (1955)"],[8837.0,21.0,2.7857142857142856,"Triggermen (2002)"],[61037.0,47.0,3.5531914893617023,"Silent Light (Stellet licht) (2007)"],[7837.0,40.0,2.9875,"36 fillette (1988)"],[89837.0,89.0,3.230337078651685,"Kill List (2011)"],[52037.0,59.0,3.457627118644068,"Avenue Montaigne (Fauteuils d'orchestre) (2006)"],[8037.0,12.0,3.125,"Non-Stop (1996)"],[90237.0,5.0,4.0,"Examined Life (2008)"],[63237.0,29.0,2.6724137931034484,"Happily Ever After (1993)"],[115437.0,6.0,3.5833333333333335,"Blind (2014)"],[95237.0,38.0,3.236842105263158,"Detention (2012)"],[86837.0,10.0,2.75,"19th Wife, The (2010)"],[91037.0,5.0,3.8,"From Beyond the Grave (Creatures) (1974)"],[6637.0,36.0,3.111111111111111,"Thrashin' (1986)"],[45837.0,54.0,3.4722222222222223,"Let It Be (1970)"],[33237.0,60.0,3.575,"San Francisco (1936)"],[70637.0,35.0,3.6714285714285713,"I Can't Think Straight (2007)"],[49037.0,17.0,3.5294117647058822,"Hi Tessa (Czesc Tereska) (2001)"],[53837.0,13.0,3.4615384615384617,"Swoon (1992)"],[8237.0,7.0,3.2857142857142856,"Way Ahead, The (a.k.a. The Immortal Battalion) (1944)"],[8637.0,13.0,2.6538461538461537,"America's Heart and Soul (2004)"],[37837.0,21.0,3.261904761904762,"Côte d'Azur (Crustacés et coquillages) (2005)"],[92437.0,21.0,3.4523809523809526,"Toast (2010)"],[105837.0,5.0,3.3,"Godzilla vs. SpaceGodzilla (Gojira VS Supesugojira) (1994)"],[83437.0,7.0,3.2142857142857144,"Young in Heart, The (1938)"],[86637.0,2.0,2.25,"1612: Khroniki smutnogo vremeni (2007)"],[52237.0,19.0,3.6315789473684212,"Tarnished Angels, The (1958)"],[83837.0,11.0,3.5454545454545454,"Electric House, The (1922)"],[78037.0,6.0,2.8333333333333335,"Hell's Highway: The True Story of Highway Safety Films (2003)"],[70237.0,5.0,3.1,"Moonshot (2009)"],[103237.0,5.0,3.8,"Sassy Pants (2012)"],[116837.0,2.0,3.25,"The Little Fox (1981)"],[72637.0,2.0,3.0,"Printed Rainbow (2006)"],[93037.0,2.0,3.5,"Her Highness and the Bellboy (1945)"],[98237.0,10.0,3.2,"Price Check (2012)"],[58437.0,6.0,3.0,"Prince of Pennsylvania, The (1988)"],[94837.0,28.0,2.9285714285714284,"Hemingway & Gellhorn (2012)"],[122037.0,1.0,1.0,"The Bone Snatcher (2003)"],[95837.0,3.0,4.666666666666667,"Child's Christmas in Wales, A (1987)"],[72037.0,13.0,3.769230769230769,"Darkness/Light/Darkness (Tma/Svetlo/Tma) (1989)"],[113037.0,2.0,3.5,"Finding Bliss (2009)"],[47237.0,2.0,4.0,"Black Gold (2006)"],[60237.0,4.0,2.75,"Dog Day (Canicule) (1984)"],[120637.0,13.0,3.3461538461538463,"Blackhat (2015)"],[25837.0,7.0,3.5,"Double Wedding (1937)"],[129437.0,1.0,4.5,"Ugly (2013)"],[104837.0,1.0,3.0,"Rage of Honor (1987)"],[110437.0,2.0,2.5,"Forgetting the Girl (2012)"],[3237.0,8.0,2.5625,"Kestrel's Eye (Falkens öga) (1998)"],[102037.0,4.0,2.125,"Breaking Wind (2011)"],[108237.0,2.0,2.75,"HOUBA! On the Trail of the Marsupilami (Sur la piste du Marsupilami) (2012)"],[81637.0,7.0,2.5,"Turtle's Tale: Sammy's Adventures, A (2010)"],[71237.0,1.0,3.5,"Hillsborough (1996)"],[111237.0,1.0,2.0,"Unlawful Killing (2011)"],[62237.0,2.0,3.0,"Part of the Weekend Never Dies (2008)"],[103437.0,5.0,3.1,"Crossfire Trail (Louis L'Amour's 'Crossfire Trail') (2001)"],[103637.0,1.0,3.0,"Arizona Raiders (1965)"],[109237.0,2.0,2.75,"Bhowani Junction (1956)"],[120837.0,2.0,3.25,"Busting (1974)"],[125237.0,1.0,3.5,"The Learning Tree (1969)"],[110637.0,2.0,2.0,"Beauty and the Beast (Beauty and the Beasts: A Dark Tale) (2009)"],[126237.0,1.0,2.5,"Stop Train 349 (1963)"],[66437.0,2.0,3.5,"Man in the Chair (2007)"],[127837.0,1.0,3.0,"Paz! (2002)"],[112637.0,1.0,2.0,"Ultimate Warrior, The (1975)"],[119037.0,1.0,3.0,"Little Italy (1978)"],[93437.0,1.0,2.5,"Deserter (Dezertir) (1933)"],[97037.0,1.0,3.0,"Madonna of the Seven Moons (1945)"],[131237.0,1.0,3.0,"What Men Talk About (2010)"],[3438.0,4951.0,2.813371036154312,"Teenage Mutant Ninja Turtles (1990)"],[7438.0,18684.0,3.869085848854635,"Kill Bill: Vol. 2 (2004)"],[4638.0,6668.0,2.645620875824835,"Jurassic Park III (2001)"],[838.0,7938.0,3.7961073318216174,"Emma (1996)"],[38038.0,4436.0,3.787195671776375,"Wallace & Gromit in The Curse of the Were-Rabbit (2005)"],[2238.0,594.0,3.8585858585858586,"Seven Beauties (Pasqualino Settebellezze) (1976)"],[8638.0,3449.0,3.9375181211945494,"Before Sunset (2004)"],[1438.0,5933.0,2.8168717343670995,"Dante's Peak (1997)"],[3638.0,4680.0,3.1476495726495726,"Moonraker (1979)"],[4238.0,2795.0,3.244186046511628,"Along Came a Spider (2001)"],[1238.0,3194.0,3.96665623043206,"Local Hero (1983)"],[4838.0,83.0,3.1144578313253013,"D.O.A. (1980)"],[3238.0,1254.0,2.3361244019138754,"Eye of the Beholder (1999)"],[5038.0,193.0,3.7072538860103625,"Flight of Dragons, The (1982)"],[3038.0,608.0,4.048519736842105,"Face in the Crowd, A (1957)"],[638.0,581.0,3.284853700516351,"Jack and Sarah (1995)"],[38.0,552.0,2.857789855072464,"It Takes Two (1995)"],[438.0,1054.0,2.7120493358633775,"Cowboy Way, The (1994)"],[1038.0,233.0,3.227467811158798,"Unhook the Stars (1996)"],[2038.0,1230.0,2.8853658536585365,"Cat from Outer Space, The (1978)"],[3838.0,210.0,2.45,"Phantasm III: Lord of the Dead (1994)"],[4038.0,119.0,3.19327731092437,"Kill Me Again (1989)"],[5438.0,761.0,2.657687253613666,"Men at Work (1990)"],[5638.0,439.0,2.907744874715262,"Godzilla vs. Mothra (Mosura tai Gojira) (1964)"],[238.0,834.0,3.1690647482014387,"Far From Home: The Adventures of Yellow Dog (1995)"],[5838.0,103.0,3.2135922330097086,"Madame Bovary (1991)"],[6238.0,1260.0,2.971031746031746,"Green Card (1990)"],[26838.0,208.0,3.641826923076923,"Snapper, The (1993)"],[68838.0,61.0,3.6147540983606556,"Every Little Step (2008)"],[106438.0,418.0,3.860047846889952,"Philomena (2013)"],[27838.0,690.0,3.5768115942028986,"Mean Creek (2004)"],[8838.0,559.0,3.6887298747763864,"Alice Doesn't Live Here Anymore (1974)"],[53038.0,58.0,3.5948275862068964,"Red Dust (1932)"],[71838.0,893.0,3.616461366181411,"Law Abiding Citizen (2009)"],[75438.0,35.0,2.7857142857142856,"Nine Dead (2010)"],[5238.0,236.0,3.694915254237288,"Return of the Secaucus 7 (1980)"],[8238.0,47.0,3.382978723404255,"Little Murders (1971)"],[33838.0,174.0,3.5344827586206895,"Rize (2005)"],[51638.0,76.0,3.3092105263157894,"Westerner, The (1940)"],[6038.0,64.0,3.21875,"Tune in Tomorrow... (1990)"],[104638.0,5.0,1.9,"Planet of the Future, The (2010)"],[2638.0,178.0,2.7275280898876404,"Mummy's Tomb, The (1942)"],[93838.0,464.0,3.6508620689655173,"The Raid: Redemption (2011)"],[26638.0,12.0,2.4166666666666665,"Prison (1988)"],[27238.0,28.0,3.017857142857143,"Guest House Paradiso (1999)"],[85438.0,396.0,3.7512626262626263,"Jane Eyre (2011)"],[6438.0,42.0,3.2738095238095237,"633 Squadron (1964)"],[52838.0,107.0,2.8598130841121496,"Year of the Dog (2007)"],[7238.0,252.0,3.8551587301587302,"Ashes and Diamonds (Popiól i diament) (1958)"],[6638.0,417.0,3.274580335731415,"Valley Girl (1983)"],[43838.0,46.0,2.5543478260869565,"Troll (1986)"],[7038.0,184.0,3.421195652173913,"Things You Can Tell Just by Looking at Her (2000)"],[59838.0,13.0,2.9615384615384617,"Chato's Land (1972)"],[4438.0,399.0,3.710526315789474,"Fist of Fury (Chinese Connection, The) (Jing wu men) (1972)"],[44238.0,69.0,1.9782608695652173,"Leprechaun 2 (1994)"],[7638.0,50.0,3.18,"Buck Privates (1941)"],[26038.0,64.0,3.5390625,"Teacher's Pet (1958)"],[78838.0,17.0,2.764705882352941,"Cry of the Owl, The (2009)"],[89638.0,23.0,3.630434782608696,"Nothing Personal (2009)"],[74438.0,25.0,3.02,"Legend of the Red Dragon (a.k.a. New Legend of Shaolin, The) (Hong Xi Guan: Zhi Shao Lin wu zu) (1994)"],[99638.0,8.0,3.625,"Fish Story (Fisshu sutôrî) (2009)"],[34238.0,23.0,3.5652173913043477,"Symmetry (Symetria) (2003)"],[78438.0,9.0,3.388888888888889,"Edge of the City (1957)"],[71438.0,80.0,3.7,"Still Walking (Aruitemo aruitemo) (2008)"],[98838.0,17.0,2.2941176470588234,"Lay the Favorite (2012)"],[31038.0,43.0,2.9069767441860463,"Smooth Talk (1985)"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"movieId","type":"\"integer\""},{"name":"count","type":"\"long\""},{"name":"average","type":"\"double\""},{"name":"title","type":"\"string\""}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.473127453117E12,"submitTime":1.473127451376E12,"finishTime":1.47312745477E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e7b62a1f-a906-47ca-90dd-2207db8927d0"},{"version":"CommandV1","origId":36148146263697,"guid":"0da9cae8-b5a5-45bb-b328-9ea4496d7487","subtype":"command","commandType":"auto","position":54.0,"command":"%md\n### (3f) Predict Your Ratings\n\nWe have our predicted ratings. Now we can print out the 25 movies with the highest predicted ratings.\n\nThe steps you should perform are:\n* Join your `predicted_ratings_df` DataFrame with the `movie_names_with_avg_ratings_df` DataFrame to obtain the ratings counts for each movie.\n* Sort the resulting DataFrame (`predicted_with_counts_df`) by predicted rating (highest ratings first), and remove any ratings with a count of 75 or less.\n* Print the top 25 movies that remain.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.473120738997E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0de551d9-ea39-4e5f-b1b5-c4739974f533"},{"version":"CommandV1","origId":36148146263698,"guid":"02531c36-5be0-471d-b4e1-9ae523f59a94","subtype":"command","commandType":"auto","position":55.0,"command":"predicted_with_counts_df = (predicted_ratings_df\n                            .join(movie_names_with_avg_ratings_df, predicted_ratings_df.movieId == movie_names_with_avg_ratings_df.movieId)\n                            .select('userId', 'average', movie_names_with_avg_ratings_df.movieId, \n                                    'count', movie_names_with_avg_ratings_df.title, 'prediction'))\n\npredicted_highest_rated_movies_df = predicted_with_counts_df.filter(F.col('count')>75).sort('prediction', ascending=False)\n\nprint ('My 25 highest rated movies as predicted (for movies with more than 75 reviews):')\npredicted_highest_rated_movies_df.take(25)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">My 25 highest rated movies as predicted (for movies with more than 75 reviews):\n<span class=\"ansired\">Out[</span><span class=\"ansired\">51</span><span class=\"ansired\">]: </span>\n[Row(userId=0, average=4.174231169217055, movieId=296, count=67310, title=u&apos;Pulp Fiction (1994)&apos;, prediction=4.358623504638672),\n Row(userId=0, average=4.263182346109176, movieId=7502, count=4305, title=u&apos;Band of Brothers (2001)&apos;, prediction=4.298755168914795),\n Row(userId=0, average=4.183632507763387, movieId=1213, count=26406, title=u&apos;Goodfellas (1990)&apos;, prediction=4.207019805908203),\n Row(userId=0, average=4.227123123722136, movieId=2959, count=40106, title=u&apos;Fight Club (1999)&apos;, prediction=4.1661810874938965),\n Row(userId=0, average=4.2206196581196584, movieId=77658, count=936, title=u&apos;Cosmos (1980)&apos;, prediction=4.160219192504883),\n Row(userId=0, average=4.155933936470536, movieId=2858, count=44987, title=u&apos;American Beauty (1999)&apos;, prediction=4.1542277336120605),\n Row(userId=0, average=4.06441659929938, movieId=2028, count=37110, title=u&apos;Saving Private Ryan (1998)&apos;, prediction=4.148105621337891),\n Row(userId=0, average=4.24807897901911, movieId=1193, count=29932, title=u&quot;One Flew Over the Cuckoo&apos;s Nest (1975)&quot;, prediction=4.143458366394043),\n Row(userId=0, average=3.90990990990991, movieId=42351, count=111, title=u&apos;Threads (1984)&apos;, prediction=4.134153842926025),\n Row(userId=0, average=4.053492566302111, movieId=47, count=43249, title=u&apos;Seven (a.k.a. Se7en) (1995)&apos;, prediction=4.120154857635498),\n Row(userId=0, average=4.1785467923660615, movieId=4226, count=30443, title=u&apos;Memento (2000)&apos;, prediction=4.114013671875),\n Row(userId=0, average=4.187185880702848, movieId=2571, count=51334, title=u&apos;Matrix, The (1999)&apos;, prediction=4.107445240020752),\n Row(userId=0, average=4.151207688017504, movieId=2329, count=23309, title=u&apos;American History X (1998)&apos;, prediction=4.101598739624023),\n Row(userId=0, average=4.089361317170255, movieId=1089, count=27635, title=u&apos;Reservoir Dogs (1992)&apos;, prediction=4.0905632972717285),\n Row(userId=0, average=4.219009123455364, movieId=1198, count=43295, title=u&apos;Raiders of the Lost Ark (Indiana Jones and the Raiders of the Lost Ark) (1981)&apos;, prediction=4.08677864074707),\n Row(userId=0, average=4.042533802004873, movieId=110, count=53769, title=u&apos;Braveheart (1995)&apos;, prediction=4.086220741271973),\n Row(userId=0, average=4.112359031244223, movieId=608, count=43272, title=u&apos;Fargo (1996)&apos;, prediction=4.051021575927734),\n Row(userId=0, average=4.123240894039735, movieId=1201, count=14496, title=u&apos;Good, the Bad and the Ugly, The (Buono, il brutto, il cattivo, Il) (1966)&apos;, prediction=4.050737380981445),\n Row(userId=0, average=4.188202061218635, movieId=1196, count=45313, title=u&apos;Star Wars: Episode V - The Empire Strikes Back (1980)&apos;, prediction=4.049292087554932),\n Row(userId=0, average=4.109930812775176, movieId=48516, count=14309, title=u&apos;Departed, The (2006)&apos;, prediction=4.047826766967773),\n Row(userId=0, average=4.108899956691208, movieId=1208, count=23090, title=u&apos;Apocalypse Now (1979)&apos;, prediction=4.04739236831665),\n Row(userId=0, average=4.224137931034483, movieId=1203, count=12934, title=u&apos;12 Angry Men (1957)&apos;, prediction=4.02315616607666),\n Row(userId=0, average=4.110575548384461, movieId=111, count=24481, title=u&apos;Taxi Driver (1976)&apos;, prediction=4.020371913909912),\n Row(userId=0, average=4.139729650308551, movieId=1233, count=13612, title=u&apos;Boot, Das (Boat, The) (1981)&apos;, prediction=4.008762359619141),\n Row(userId=0, average=4.083376807273812, movieId=1617, count=26836, title=u&apos;L.A. Confidential (1997)&apos;, prediction=4.006565570831299)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.473127667711E12,"submitTime":1.473127665974E12,"finishTime":1.473127680418E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6a4c751c-cd0c-4578-bb5b-d6d160d6e680"}],"dashboards":[],"guid":"f4f46569-a020-4fdf-b583-78de16f37261","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
