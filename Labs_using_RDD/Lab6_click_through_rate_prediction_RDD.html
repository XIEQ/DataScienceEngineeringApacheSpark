<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Lab6_click_through_rate_prediction_RDD - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html","displayName":"Databricks Guide","icon":"question"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/sample_applications/index.html","displayName":"Application Examples","icon":"code"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/courses/index.html","displayName":"Training","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","maxCustomTags":5,"enableInstanceProfilesUIInJobs":false,"nodeInfo":{"node_types":[{"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"memory_mb":6144,"category":"Community Edition","num_cores":0.88,"support_ebs_volumes":false}],"default_node_type_id":"dev-tier-node"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"enableTableHandler":true,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":false,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"clusters":true,"allowRunOnPendingClusters":true,"applications":false,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-35f30dcf90b59210c3f253a98dbb4d255fa4a1773385163b3cec143c1271e065","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-876320751f9b6e4318a1235c9d5f862196d02008ff478f483e2820c48c59d1fe","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"class-node":1,"r3.8xlarge":8,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":8,"memory-optimized":1,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"c3.4xlarge":2,"g2.2xlarge":2,"c4.8xlarge":4,"r3.xlarge":1,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":false,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.30","accountsLimit":3,"enableX509Authentication":false,"enableNotebookGitBranching":true,"local":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"disableLegacyDashboards":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"defaultSparkVersion":{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":true,"enableMountAclsConfig":false,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableClusterAclsByTier":false,"disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"useFixedStaticNotebookVersionForDevelopment":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAclService":true,"docsDomain":"https://docs.cloud.databricks.com/","enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"cf91ba6cb552f29d2f374bda4b46622075c9146a-dirty","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"showDevTierBetaVersion":true,"enableDebugUI":false,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSparkPackages":true,"dynamicSparkVersions":true,"enableNotebookHistoryUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/A%20Gentle%20Introduction%20to%20Apache%20Spark%20on%20Databricks.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/Quick%20Start%20DataFrames.html","displayName":"Quick Start DataFrames","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/GSW%20Passing%20Analysis%20(new).html","displayName":"GSW Passing Analysis (new)","icon":"img/home/Python_icon.svg"}],"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"enableTerminal":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"accounts":true,"useFramedStaticNotebooks":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showSqlProxyUI":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":48516603025473,"name":"Lab6_click_through_rate_prediction_RDD","language":"python","commands":[{"version":"CommandV1","origId":48516603025475,"guid":"2bfc5637-d88b-45a3-84fe-e6a16d1358ca","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n<a rel=\"license\" href=\"http://creativecommons.org/licenses/by-nc-nd/4.0/\"><img alt=\"Creative Commons License\" style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png\" /></a><br />This work is licensed under a <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-nc-nd/4.0/\">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.\n\nHackOnData Workshops","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335442222E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b26ddc47-1400-4946-a877-0dba5e3fe248"},{"version":"CommandV1","origId":48516603025476,"guid":"f881ddc1-49de-4cd4-af47-2205c813a250","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n![ML Logo](http://spark-mooc.github.io/web-assets/images/CS190.1x_Banner_300.png)\n# **Click-Through Rate Prediction Lab**\nThis lab covers the steps for creating a click-through rate (CTR) prediction pipeline.  You will work with the [Criteo Labs](http://labs.criteo.com/) dataset that was used for a recent [Kaggle competition](https://www.kaggle.com/c/criteo-display-ad-challenge).\n \n** This lab will cover: **\n \n* *Part 1:* Featurize categorical data using one-hot-encoding (OHE)\n \n* *Part 2:* Construct an OHE dictionary\n \n* *Part 3:* Parse CTR data and generate OHE features\n * *Visualization 1:* Feature frequency\n \n* *Part 4:* CTR prediction and logloss evaluation\n * *Visualization 2:* ROC curve\n \n* *Part 5:* Reduce feature dimension via feature hashing\n * *Visualization 3:* Hyperparameter heat map\n \n> Note that, for reference, you can look up the details of:\n> * the relevant Spark methods in [Spark's Python API](https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD)\n> * the relevant NumPy methods in the [NumPy Reference](http://docs.scipy.org/doc/numpy/reference/index.html)","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335442229E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"815e8b24-9998-4b4a-a189-a295d79dcf81"},{"version":"CommandV1","origId":48516603025478,"guid":"b57b62be-b5fe-4ff5-8617-877999b4bb08","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n#### ** Part 1: Featurize categorical data using one-hot-encoding **","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335442263E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"142038ea-8058-4a83-8aab-6a3f76076151"},{"version":"CommandV1","origId":48516603025479,"guid":"0600bccb-cf59-4bea-8189-00952b1af93d","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n** (1a) One-hot-encoding **\nWe would like to develop code to convert categorical features to numerical ones, and to build intuition, we will work with a sample unlabeled dataset with three data points, with each data point representing an animal. The first feature indicates the type of animal (bear, cat, mouse); the second feature describes the animal's color (black, tabby); and the third (optional) feature describes what the animal eats (mouse, salmon).\n \nIn a one-hot-encoding (OHE) scheme, we want to represent each tuple of `(featureID, category)` via its own binary feature.  We can do this in Python by creating a dictionary that maps each tuple to a distinct integer, where the integer corresponds to a binary feature. To start, manually enter the entries in the OHE dictionary associated with the sample dataset by mapping the tuples to consecutive integers starting from zero,  ordering the tuples first by featureID and next by category.\n \nLater in this lab, we'll use OHE dictionaries to transform data points into compact lists of features that can be used in machine learning algorithms.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335442282E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e8f1481e-9c7b-41fa-a1a6-5160dd57e04d"},{"version":"CommandV1","origId":48516603025480,"guid":"afc8c308-eead-4588-9997-afa3aca93a8c","subtype":"command","commandType":"auto","position":7.0,"command":"# Data for manual OHE\n# Note: the first data point does not include any value for the optional third feature\nsampleOne = [(0, 'mouse'), (1, 'black')]\nsampleTwo = [(0, 'cat'), (1, 'tabby'), (2, 'mouse')]\nsampleThree =  [(0, 'bear'), (1, 'black'), (2, 'salmon')]\nsampleDataRDD = sc.parallelize([sampleOne, sampleTwo, sampleThree])","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335442421E12,"submitTime":1.472335442306E12,"finishTime":1.47233544246E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"660bd163-0bee-4ea8-a141-5b8e0df90f26"},{"version":"CommandV1","origId":48516603025481,"guid":"b44437cb-4860-42f1-bcce-50b284272853","subtype":"command","commandType":"auto","position":8.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nsampleOHEDictManual = {}\nsampleOHEDictManual[(0,'bear')] = 0\nsampleOHEDictManual[(0,'cat')] = 1\nsampleOHEDictManual[(0,'mouse')] = 2\nsampleOHEDictManual[(1, 'black')] = 3\nsampleOHEDictManual[(1,'tabby')] = 4\nsampleOHEDictManual[(2, 'mouse')] = 5\nsampleOHEDictManual[(2, 'salmon')] = 6","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335442464E12,"submitTime":1.472335442623E12,"finishTime":1.472335442487E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"41bc75a3-e47b-4d5d-8034-7c278049c3b2"},{"version":"CommandV1","origId":48516603025482,"guid":"aef58b6e-4bb6-4ec1-84b0-8bd939d58bdc","subtype":"command","commandType":"auto","position":8.5,"command":"%md **WARNING:** If *test_helper*, required in the cell below, is not installed, follow the instructions [here](https://databricks-staging-cloudfront.staging.cloud.databricks.com/public/c65da9a2fa40e45a2028cddebe45b54c/8637560089690848/4187311313936645/6977722904629137/05f3c2ecc3.html).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335442635E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e8231ece-e502-4df4-ada1-06e8ea2e6908"},{"version":"CommandV1","origId":48516603025483,"guid":"5d8bc21c-2acc-4057-b4e4-88561b2102f7","subtype":"command","commandType":"auto","position":9.0,"command":"# TEST One-hot-encoding (1a)\nfrom test_helper import Test\n\nTest.assertEqualsHashed(sampleOHEDictManual[(0,'bear')],\n                        'b6589fc6ab0dc82cf12099d1c2d40ab994e8410c',\n                        \"incorrect value for sampleOHEDictManual[(0,'bear')]\")\nTest.assertEqualsHashed(sampleOHEDictManual[(0,'cat')],\n                        '356a192b7913b04c54574d18c28d46e6395428ab',\n                        \"incorrect value for sampleOHEDictManual[(0,'cat')]\")\nTest.assertEqualsHashed(sampleOHEDictManual[(0,'mouse')],\n                        'da4b9237bacccdf19c0760cab7aec4a8359010b0',\n                        \"incorrect value for sampleOHEDictManual[(0,'mouse')]\")\nTest.assertEqualsHashed(sampleOHEDictManual[(1,'black')],\n                        '77de68daecd823babbb58edb1c8e14d7106e83bb',\n                        \"incorrect value for sampleOHEDictManual[(1,'black')]\")\nTest.assertEqualsHashed(sampleOHEDictManual[(1,'tabby')],\n                        '1b6453892473a467d07372d45eb05abc2031647a',\n                        \"incorrect value for sampleOHEDictManual[(1,'tabby')]\")\nTest.assertEqualsHashed(sampleOHEDictManual[(2,'mouse')],\n                        'ac3478d69a3c81fa62e60f5c3696165a4e5e6ac4',\n                        \"incorrect value for sampleOHEDictManual[(2,'mouse')]\")\nTest.assertEqualsHashed(sampleOHEDictManual[(2,'salmon')],\n                        'c1dfd96eea8cc2b62785275bca38ac261256e278',\n                        \"incorrect value for sampleOHEDictManual[(2,'salmon')]\")\nTest.assertEquals(len(sampleOHEDictManual.keys()), 7,\n                  'incorrect number of keys in sampleOHEDictManual')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;sampleOHEDictManual&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-1-b54806191f17&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansigreen\">from</span> test_helper <span class=\"ansigreen\">import</span> Test<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 4</span><span class=\"ansiyellow\"> Test.assertEqualsHashed(sampleOHEDictManual[(0,&apos;bear&apos;)],\n</span><span class=\"ansigreen\">      5</span>                         <span class=\"ansiblue\">&apos;b6589fc6ab0dc82cf12099d1c2d40ab994e8410c&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      6</span>                         &quot;incorrect value for sampleOHEDictManual[(0,&apos;bear&apos;)]&quot;)\n\n<span class=\"ansired\">NameError</span>: name &apos;sampleOHEDictManual&apos; is not defined\n</div>","workflows":[],"startTime":1.47233544249E12,"submitTime":1.472335442656E12,"finishTime":1.472335442521E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"46d01630-4d11-4a1d-8b5a-72c792f29995"},{"version":"CommandV1","origId":48516603025484,"guid":"c04d4594-c439-41a1-86df-b815720ecd12","subtype":"command","commandType":"auto","position":10.0,"command":"%md\n** (1b) Sparse vectors **\n \nData points can typically be represented with a small number of non-zero OHE features relative to the total number of features that occur in the dataset.  By leveraging this sparsity and using sparse vector representations of OHE data, we can reduce storage and computational burdens.  Below are a few sample vectors represented as dense numpy arrays.  Use [SparseVector](https://spark.apache.org/docs/latest/api/python/pyspark.mllib.html#pyspark.mllib.linalg.SparseVector) to represent them in a sparse fashion, and verify that both the sparse and dense representations yield the same results when computing [dot products](http://en.wikipedia.org/wiki/Dot_product) (we will later use MLlib to train classifiers via gradient descent, and MLlib will need to compute dot products between SparseVectors and dense parameter vectors).\n \nUse `SparseVector(size, *args)` to create a new sparse vector where size is the length of the vector and args is either a dictionary, a list of (index, value) pairs, or two separate arrays of indices and values (sorted by index).  You'll need to create a sparse vector representation of each dense vector `aDense` and `bDense`.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335442669E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"03342032-1631-4e39-91e0-398c6765e750"},{"version":"CommandV1","origId":48516603025485,"guid":"99a3a6f4-eaec-4cec-8a62-08a3022f0863","subtype":"command","commandType":"auto","position":11.0,"command":"import numpy as np\nfrom pyspark.mllib.linalg import SparseVector","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335442524E12,"submitTime":1.472335442696E12,"finishTime":1.472335442563E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9ce7dff9-f125-4c4b-86cc-6dfdbc4d16e4"},{"version":"CommandV1","origId":48516603025486,"guid":"e5f29e8d-0951-4296-8f92-ed8b192d70a2","subtype":"command","commandType":"auto","position":12.0,"command":"# TODO: Replace <FILL IN> with appropriate code\naDense = np.array([0., 3., 0., 4.])\naSparse = SparseVector(4, [1, 3], [3.0, 4.0])\n# or aSparse = SparseVector(4, [(1, 3.0), (3, 4.0)])\n\nbDense = np.array([0., 0., 0., 1.])\nbSparse = SparseVector(4, [3], [1.0])\n# or bSparse = SparseVector(4, [(3, 1.0)])\n\nw = np.array([0.4, 3.1, -1.4, -.5])\nprint aDense.dot(w)\nprint aSparse.dot(w)\nprint bDense.dot(w)\nprint bSparse.dot(w)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">7.3\n7.3\n-0.5\n-0.5\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335442566E12,"submitTime":1.472335442708E12,"finishTime":1.472335442606E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d5e3eb1d-f381-40f5-a1ff-39d8eedacb56"},{"version":"CommandV1","origId":48516603025487,"guid":"60e3936d-436f-44d8-b480-a40236d65c74","subtype":"command","commandType":"auto","position":13.0,"command":"# TEST Sparse Vectors (1b)\nTest.assertTrue(isinstance(aSparse, SparseVector), 'aSparse needs to be an instance of SparseVector')\nTest.assertTrue(isinstance(bSparse, SparseVector), 'aSparse needs to be an instance of SparseVector')\nTest.assertTrue(aDense.dot(w) == aSparse.dot(w),\n                'dot product of aDense and w should equal dot product of aSparse and w')\nTest.assertTrue(bDense.dot(w) == bSparse.dot(w),\n                'dot product of bDense and w should equal dot product of bSparse and w')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335442609E12,"submitTime":1.47233544272E12,"finishTime":1.472335442632E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cc70169f-9758-4cb8-9c92-aae7f9b653b9"},{"version":"CommandV1","origId":48516603025488,"guid":"4c0bf808-136a-4b9a-a2de-8446dba8a790","subtype":"command","commandType":"auto","position":14.0,"command":"%md\n**(1c) OHE features as sparse vectors **\n \nNow let's see how we can represent the OHE features for points in our sample dataset.  Using the mapping defined by the OHE dictionary from Part (1a), manually define OHE features for the three sample data points using SparseVector format.  Any feature that occurs in a point should have the value 1.0.  For example, the `DenseVector` for a point with features 2 and 4 would be `[0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0]`.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335442732E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"87b36f85-59a4-4b4d-8ef7-c69dfa057edd"},{"version":"CommandV1","origId":48516603025489,"guid":"27c0bef4-3bc3-4a51-8a33-8d45f345ab3d","subtype":"command","commandType":"auto","position":15.0,"command":"# Reminder of the sample features\n# sampleOne = [(0, 'mouse'), (1, 'black')]\n# sampleTwo = [(0, 'cat'), (1, 'tabby'), (2, 'mouse')]\n# sampleThree =  [(0, 'bear'), (1, 'black'), (2, 'salmon')]","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335442635E12,"submitTime":1.472335442751E12,"finishTime":1.472335442657E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"64ec297d-c8f1-47da-876b-a5691d0d28a6"},{"version":"CommandV1","origId":48516603025490,"guid":"116c8b63-72de-4a86-94c4-d215fe2d8610","subtype":"command","commandType":"auto","position":16.0,"command":"# TODO: Replace <FILL IN> with appropriate code\n# sampleOneOHEFeatManual = [1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]\nsampleOneOHEFeatManual = SparseVector(7, [2, 3], [1.0, 1.0])\n#sampleTwoOHEFeatManual = [0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0]\nsampleTwoOHEFeatManual = SparseVector(7, [1, 4, 5], [1.0, 1.0, 1.0])\n#sampleThreeOHEFeatManual = [0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0]\nsampleThreeOHEFeatManual = SparseVector(7, [0, 3, 6], [1.0, 1.0, 1.0])","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47233544266E12,"submitTime":1.472335442764E12,"finishTime":1.472335442699E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"056dcaea-ee5c-4c99-b904-a26ba1693331"},{"version":"CommandV1","origId":48516603025491,"guid":"a6f04f1b-e92c-41d4-b93e-b37812b1402a","subtype":"command","commandType":"auto","position":17.0,"command":"# TEST OHE Features as sparse vectors (1c)\nTest.assertTrue(isinstance(sampleOneOHEFeatManual, SparseVector),\n                'sampleOneOHEFeatManual needs to be a SparseVector')\nTest.assertTrue(isinstance(sampleTwoOHEFeatManual, SparseVector),\n                'sampleTwoOHEFeatManual needs to be a SparseVector')\nTest.assertTrue(isinstance(sampleThreeOHEFeatManual, SparseVector),\n                'sampleThreeOHEFeatManual needs to be a SparseVector')\nTest.assertEqualsHashed(sampleOneOHEFeatManual,\n                        'ecc00223d141b7bd0913d52377cee2cf5783abd6',\n                        'incorrect value for sampleOneOHEFeatManual')\nTest.assertEqualsHashed(sampleTwoOHEFeatManual,\n                        '26b023f4109e3b8ab32241938e2e9b9e9d62720a',\n                        'incorrect value for sampleTwoOHEFeatManual')\nTest.assertEqualsHashed(sampleThreeOHEFeatManual,\n                        'c04134fd603ae115395b29dcabe9d0c66fbdc8a7',\n                        'incorrect value for sampleThreeOHEFeatManual')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335442701E12,"submitTime":1.472335442776E12,"finishTime":1.472335442729E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5996450b-6050-4e29-ac5d-76c560205cfc"},{"version":"CommandV1","origId":48516603025492,"guid":"0b0314ec-f1ba-4b00-9b9e-1cdbae432857","subtype":"command","commandType":"auto","position":18.0,"command":"%md\n**(1d) Define a OHE function **\n \nNext we will use the OHE dictionary from Part (1a) to programatically generate OHE features from the original categorical data.  First write a function called `oneHotEncoding` that creates OHE feature vectors in `SparseVector` format.  Then use this function to create OHE features for the first sample data point and verify that the result matches the result from Part (1c).","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335442842E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6e9bbe80-94d9-4a8d-bb4c-7569a96c2982"},{"version":"CommandV1","origId":48516603025493,"guid":"5fada56f-68da-4b0b-862a-2a069257f7b5","subtype":"command","commandType":"auto","position":19.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef oneHotEncoding(rawFeats, OHEDict, numOHEFeats):\n    \"\"\"Produce a one-hot-encoding from a list of features and an OHE dictionary.\n\n    Note:\n        You should ensure that the indices used to create a SparseVector are sorted.\n\n    Args:\n        rawFeats (list of (int, str)): The features corresponding to a single observation.  Each\n            feature consists of a tuple of featureID and the feature's value. (e.g. sampleOne)\n        OHEDict (dict): A mapping of (featureID, value) to unique integer.\n        numOHEFeats (int): The total number of unique OHE features (combinations of featureID and\n            value).\n\n    Returns:\n        SparseVector: A SparseVector of length numOHEFeats with indices equal to the unique\n            identifiers for the (featureID, value) combinations that occur in the observation and\n            with values equal to 1.0.\n    \"\"\"\n    indices = []\n    for key in rawFeats:      \n      indices.append(OHEDict[key])\n    indices.sort()\n    vector = np.ones(len(indices))\n    return SparseVector(numOHEFeats, indices, vector)\n\n  # Calculate the number of features in sampleOHEDictManual\nnumSampleOHEFeats = len(sampleOneOHEFeatManual)\n\n# Run oneHotEnoding on sampleOne\nsampleOneOHEFeat = oneHotEncoding(sampleOne, sampleOHEDictManual, numSampleOHEFeats )\n\nprint sampleOneOHEFeat","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(7,[2,3],[1.0,1.0])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335442731E12,"submitTime":1.472335442861E12,"finishTime":1.472335442755E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f1a6309e-bbb2-4cbd-8e50-7a6e4fb36f5c"},{"version":"CommandV1","origId":48516603025494,"guid":"55fdf92f-1333-4bd9-8090-132bc40fe446","subtype":"command","commandType":"auto","position":20.0,"command":"# TEST Define an OHE Function (1d)\nTest.assertTrue(sampleOneOHEFeat == sampleOneOHEFeatManual,\n                'sampleOneOHEFeat should equal sampleOneOHEFeatManual')\nTest.assertEquals(sampleOneOHEFeat, SparseVector(7, [2,3], [1.0,1.0]),\n                  'incorrect value for sampleOneOHEFeat')\nTest.assertEquals(oneHotEncoding([(1, 'black'), (0, 'mouse')], sampleOHEDictManual,\n                                 numSampleOHEFeats), SparseVector(7, [2,3], [1.0,1.0]),\n                  'incorrect definition for oneHotEncoding')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335442758E12,"submitTime":1.472335442873E12,"finishTime":1.472335442782E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d3add646-7adf-4848-bf0a-f78c2bef5043"},{"version":"CommandV1","origId":48516603025495,"guid":"99909d0d-7751-48f5-98da-e7b4733cdaf2","subtype":"command","commandType":"auto","position":21.0,"command":"%md\n**(1e) Apply OHE to a dataset **\n \nFinally, use the function from Part (1d) to create OHE features for all 3 data points in the sample dataset.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335442885E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6f8f8f9b-2c0b-406b-9e83-f447d6578e79"},{"version":"CommandV1","origId":48516603025565,"guid":"725ce4e0-4108-4f5a-98e9-a6d64792e5fa","subtype":"command","commandType":"auto","position":21.5,"command":"# reminder of sampleDataRDD\nsampleDataRDD.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">13</span><span class=\"ansired\">]: </span>\n[[(0, &apos;mouse&apos;), (1, &apos;black&apos;)],\n [(0, &apos;cat&apos;), (1, &apos;tabby&apos;), (2, &apos;mouse&apos;)],\n [(0, &apos;bear&apos;), (1, &apos;black&apos;), (2, &apos;salmon&apos;)]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335442785E12,"submitTime":1.472335442905E12,"finishTime":1.472335442957E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5a30c6b1-d9be-49f9-b443-20500180e8d7"},{"version":"CommandV1","origId":48516603025496,"guid":"7a78b3c6-a694-45f5-9c3d-444afec28a10","subtype":"command","commandType":"auto","position":22.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nsampleOHEData = sampleDataRDD.map(lambda x: oneHotEncoding(x, sampleOHEDictManual, numSampleOHEFeats))\nprint sampleOHEData.collect()","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[SparseVector(7, {2: 1.0, 3: 1.0}), SparseVector(7, {1: 1.0, 4: 1.0, 5: 1.0}), SparseVector(7, {0: 1.0, 3: 1.0, 6: 1.0})]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335442961E12,"submitTime":1.472335442918E12,"finishTime":1.472335443083E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f9ed7dca-7a27-495c-ba65-cac96060458d"},{"version":"CommandV1","origId":48516603025497,"guid":"dc11b4f1-f5db-4c74-bdca-aded258d6067","subtype":"command","commandType":"auto","position":23.0,"command":"# TEST Apply OHE to a dataset (1e)\nsampleOHEDataValues = sampleOHEData.collect()\nTest.assertTrue(len(sampleOHEDataValues) == 3, 'sampleOHEData should have three elements')\nTest.assertEquals(sampleOHEDataValues[0], SparseVector(7, {2: 1.0, 3: 1.0}),\n                  'incorrect OHE for first sample')\nTest.assertEquals(sampleOHEDataValues[1], SparseVector(7, {1: 1.0, 4: 1.0, 5: 1.0}),\n                  'incorrect OHE for second sample')\nTest.assertEquals(sampleOHEDataValues[2], SparseVector(7, {0: 1.0, 3: 1.0, 6: 1.0}),\n                  'incorrect OHE for third sample')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335443087E12,"submitTime":1.472335442929E12,"finishTime":1.47233544321E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"57ddfc56-c143-416c-b1fb-5deaec880629"},{"version":"CommandV1","origId":48516603025498,"guid":"476164e6-47c9-4b88-879c-0b5078e69184","subtype":"command","commandType":"auto","position":24.0,"command":"%md\n#### ** Part 2: Construct an OHE dictionary **","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.47233544294E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ea7487c9-6a99-41db-b829-00db17c5a858"},{"version":"CommandV1","origId":48516603025499,"guid":"89e099a9-820e-4a02-b742-8756f953b0e0","subtype":"command","commandType":"auto","position":25.0,"command":"%md\n**(2a) Pair RDD of `(featureID, category)` **\n \nTo start, create an RDD of distinct `(featureID, category)` tuples. In our sample dataset, the 7 items in the resulting RDD are `(0, 'bear')`, `(0, 'cat')`, `(0, 'mouse')`, `(1, 'black')`, `(1, 'tabby')`, `(2, 'mouse')`, `(2, 'salmon')`. Notably `'black'` appears twice in the dataset but only contributes one item to the RDD: `(1, 'black')`, while `'mouse'` also appears twice and contributes two items: `(0, 'mouse')` and `(2, 'mouse')`.  Use [flatMap](https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.flatMap) and [distinct](https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.distinct).","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.47233544297E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c5219369-d3d6-4b47-a319-3480b947011b"},{"version":"CommandV1","origId":48516603025500,"guid":"10d17ad6-ff7c-4f76-852b-8e1a43820e74","subtype":"command","commandType":"auto","position":26.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nsampleDistinctFeats = (sampleDataRDD\n                       .flatMap(lambda x: x)\n                       .distinct())","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335443214E12,"submitTime":1.47233544299E12,"finishTime":1.472335443285E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c1e784a7-1ddc-40a3-91ba-8fd85052c6f7"},{"version":"CommandV1","origId":48516603025501,"guid":"18a4ad29-f62a-4a3d-91cd-f5c33ffa253d","subtype":"command","commandType":"auto","position":27.0,"command":"# TEST Pair RDD of (featureID, category) (2a)\nTest.assertEquals(sorted(sampleDistinctFeats.collect()),\n                  [(0, 'bear'), (0, 'cat'), (0, 'mouse'), (1, 'black'),\n                   (1, 'tabby'), (2, 'mouse'), (2, 'salmon')],\n                  'incorrect value for sampleDistinctFeats')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335443289E12,"submitTime":1.472335443001E12,"finishTime":1.472335443562E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"17ef6ec7-87a3-4f5e-a483-0fd1837b3b80"},{"version":"CommandV1","origId":48516603025502,"guid":"646237c9-708f-4a79-b532-cd2bb2c517c7","subtype":"command","commandType":"auto","position":28.0,"command":"%md\n** (2b) OHE Dictionary from distinct features **\n \nNext, create an `RDD` of key-value tuples, where each `(featureID, category)` tuple in `sampleDistinctFeats` is a key and the values are distinct integers ranging from 0 to (number of keys - 1).  Then convert this `RDD` into a dictionary, which can be done using the `collectAsMap` action.  Note that there is no unique mapping from keys to values, as all we require is that each `(featureID, category)` key be mapped to a unique integer between 0 and the number of keys.  In this exercise, any valid mapping is acceptable.  Use [zipWithIndex](https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.zipWithIndex) followed by [collectAsMap](https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.collectAsMap).\n \nIn our sample dataset, one valid list of key-value tuples is: `[((0, 'bear'), 0), ((2, 'salmon'), 1), ((1, 'tabby'), 2), ((2, 'mouse'), 3), ((0, 'mouse'), 4), ((0, 'cat'), 5), ((1, 'black'), 6)]`. The dictionary defined in Part (1a) illustrates another valid mapping between keys and integers.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443012E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3c15725b-f0b2-4c31-8423-e90b01489f15"},{"version":"CommandV1","origId":48516603025503,"guid":"5e5bb808-5eee-4195-a9c2-05ed1d47d15a","subtype":"command","commandType":"auto","position":29.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nsampleOHEDict = (sampleDistinctFeats\n                           .zipWithIndex()\n                           .collectAsMap())\nprint sampleOHEDict","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">{(2, &apos;mouse&apos;): 2, (0, &apos;cat&apos;): 5, (0, &apos;bear&apos;): 0, (2, &apos;salmon&apos;): 3, (1, &apos;tabby&apos;): 1, (1, &apos;black&apos;): 6, (0, &apos;mouse&apos;): 4}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335443566E12,"submitTime":1.472335443033E12,"finishTime":1.472335443789E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4a37040e-707e-4df6-96e7-0805af756b68"},{"version":"CommandV1","origId":48516603025504,"guid":"476cf833-1da4-499c-961a-0cf89f710697","subtype":"command","commandType":"auto","position":30.0,"command":"# TEST OHE Dictionary from distinct features (2b)\nTest.assertEquals(sorted(sampleOHEDict.keys()),\n                  [(0, 'bear'), (0, 'cat'), (0, 'mouse'), (1, 'black'),\n                   (1, 'tabby'), (2, 'mouse'), (2, 'salmon')],\n                  'sampleOHEDict has unexpected keys')\nTest.assertEquals(sorted(sampleOHEDict.values()), range(7), 'sampleOHEDict has unexpected values')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335443793E12,"submitTime":1.472335443045E12,"finishTime":1.472335443818E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ef959027-a71b-4574-922d-c12cc86af75d"},{"version":"CommandV1","origId":48516603025505,"guid":"537bd375-7348-4c52-be68-97f5010d9618","subtype":"command","commandType":"auto","position":31.0,"command":"%md\n**(2c) Automated creation of an OHE dictionary **\n \nNow use the code from Parts (2a) and (2b) to write a function that takes an input dataset and outputs an OHE dictionary.  Then use this function to create an OHE dictionary for the sample dataset, and verify that it matches the dictionary from Part (2b).","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443055E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3f0578fe-690d-47ce-953d-c09a7ad93b32"},{"version":"CommandV1","origId":48516603025506,"guid":"03499917-4c9c-4c40-9259-75d5326510c2","subtype":"command","commandType":"auto","position":32.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef createOneHotDict(inputData):\n    \"\"\"Creates a one-hot-encoder dictionary based on the input data.\n\n    Args:\n        inputData (RDD of lists of (int, str)): An RDD of observations where each observation is\n            made up of a list of (featureID, value) tuples.\n\n    Returns:\n        dict: A dictionary where the keys are (featureID, value) tuples and map to values that are\n            unique integers.\n    \"\"\"\n    return (inputData\n            .flatMap(lambda x: x)\n            .distinct()\n            .zipWithIndex()\n            .collectAsMap())\n\nsampleOHEDictAuto = createOneHotDict(sampleDataRDD)\nprint sampleOHEDictAuto","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">{(2, &apos;mouse&apos;): 2, (0, &apos;cat&apos;): 5, (0, &apos;bear&apos;): 0, (2, &apos;salmon&apos;): 3, (1, &apos;tabby&apos;): 1, (1, &apos;black&apos;): 6, (0, &apos;mouse&apos;): 4}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;RDD&apos; object has no attribute &apos;flatmap&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-21-b16fd64ae348&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     17</span>             .collectAsMap())\n<span class=\"ansigreen\">     18</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 19</span><span class=\"ansiyellow\"> </span>sampleOHEDictAuto <span class=\"ansiyellow\">=</span> createOneHotDict<span class=\"ansiyellow\">(</span>sampleDataRDD<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     20</span> <span class=\"ansigreen\">print</span> sampleOHEDictAuto<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;ipython-input-21-b16fd64ae348&gt;</span> in <span class=\"ansicyan\">createOneHotDict</span><span class=\"ansiblue\">(inputData)</span>\n<span class=\"ansigreen\">     11</span>             unique integers<span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     12</span>     &quot;&quot;&quot;\n<span class=\"ansigreen\">---&gt; 13</span><span class=\"ansiyellow\">     return (inputData\n</span><span class=\"ansigreen\">     14</span>             <span class=\"ansiyellow\">.</span>flatmap<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">:</span> x<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     15</span>             <span class=\"ansiyellow\">.</span>distinct<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;RDD&apos; object has no attribute &apos;flatmap&apos;\n</div>","workflows":[],"startTime":1.472335443821E12,"submitTime":1.472335443077E12,"finishTime":1.472335444146E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1946a7af-0850-4f16-a022-36cd4a84357f"},{"version":"CommandV1","origId":48516603025507,"guid":"4042ec17-bc3a-422b-81c9-f263a163aa9c","subtype":"command","commandType":"auto","position":33.0,"command":"# TEST Automated creation of an OHE dictionary (2c)\nTest.assertEquals(sorted(sampleOHEDictAuto.keys()),\n                  [(0, 'bear'), (0, 'cat'), (0, 'mouse'), (1, 'black'),\n                   (1, 'tabby'), (2, 'mouse'), (2, 'salmon')],\n                  'sampleOHEDictAuto has unexpected keys')\nTest.assertEquals(sorted(sampleOHEDictAuto.values()), range(7),\n                  'sampleOHEDictAuto has unexpected values')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335444151E12,"submitTime":1.472335443088E12,"finishTime":1.472335444174E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7b3f0511-ecae-493d-841b-bd7367c227b5"},{"version":"CommandV1","origId":48516603025508,"guid":"5ba52450-c410-4dde-9348-464713476bcb","subtype":"command","commandType":"auto","position":34.0,"command":"%md\n#### **Part 3: Parse CTR data and generate OHE features**","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443099E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"975d04b2-f4be-427f-80b9-9b04de6f36b3"},{"version":"CommandV1","origId":48516603025509,"guid":"7ebb28a1-aa1d-4e83-bba0-0c349196479e","subtype":"command","commandType":"auto","position":35.0,"command":"%md\nBefore we can proceed, you'll first need to obtain the data from Criteo.  Here is the link to Criteo's data sharing agreement:[http://labs.criteo.com/downloads/2014-kaggle-display-advertising-challenge-dataset/](http://labs.criteo.com/downloads/2014-kaggle-display-advertising-challenge-dataset/).  After you accept the agreement, you can obtain the download URL by right-clicking on the \"Download Sample\". \n\nDownload the .gz file to your computer and extract the downloaded file. Finally upload the `dac_sample.txt` to your s3 bucket.\n\nNote that the download should complete within 30 seconds.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443118E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ebe6bd31-1b0f-4f0d-83e9-15489db69470"},{"version":"CommandV1","origId":48516603025662,"guid":"af0b24e0-883c-477f-b73d-7c3fd9b860b7","subtype":"command","commandType":"auto","position":35.5,"command":"# Nothing to edit here. Just run this cell.\n\ndef cleanup_old_downloads():\n  from fnmatch import fnmatch\n\n  # Clean up old downloaded files from dbfs:/tmp to prevent QUOTA_EXCEEDED errors.\n  for f in dbutils.fs.ls('/tmp'):\n    name = str(f.name)\n    if fnmatch(name, 'criteo_*'):\n      dbutils.fs.rm(str(f.path), recurse=True)\n\ndef download_criteo(url):\n  from io import BytesIO\n  import urllib2\n  import tarfile\n  import uuid\n  import tempfile\n  import random\n  import string\n  import os\n\n  if not url.endswith('dac_sample.tar.gz'):\n    raise Exception('Check your download URL. Are you downloading the sample dataset?')\n\n  cleanup_old_downloads()\n\n  # Create a random ID for the directory containing the downloaded file, to avoid any name clashes\n  # with any other clusters. (Might not be necessary, but, safety first...)\n  rng = random.SystemRandom()\n  tlds = ('.org', '.net', '.com', '.info', '.biz')\n  random_domain_name = (\n    ''.join(rng.choice(string.letters + string.digits) for i in range(64)) +\n    rng.choice(tlds)\n  )\n  random_id = str(uuid.uuid3(uuid.NAMESPACE_DNS, random_domain_name)).replace('-', '_')\n  unique_id = str(uuid.uuid3(uuid.NAMESPACE_DNS, random_id)).replace('-', '_')\n  dbfs_dir  = 'dbfs:/tmp/criteo_{0}'.format(unique_id)\n  dbfs_path = '{0}/data.txt'.format(dbfs_dir)\n  dbutils.fs.mkdirs(dbfs_dir)\n\n  # Download the tarball and unpack it.\n  tmp = BytesIO()\n  req = urllib2.Request(url, headers={'User-Agent': 'Databricks'})\n  url_handle = urllib2.urlopen(req)\n  tmp.write(url_handle.read())\n  tmp.seek(0)\n  tf = tarfile.open(fileobj=tmp)\n  dac_sample = tf.extractfile('dac_sample.txt')\n  dac_sample = '\\n'.join([unicode(x.replace('\\n', '').replace('\\t', ',')) for x in dac_sample])\n\n  # Write the downloaded data to to dbfs:/tmp.\n  with tempfile.NamedTemporaryFile(mode='wb', delete=False, prefix='dac', suffix='.txt') as t:\n    t.write(dac_sample)\n    t.close()\n    dbutils.fs.cp('file://{0}'.format(t.name), dbfs_path)\n    os.unlink(t.name)\n\n  return dbfs_path","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335444179E12,"submitTime":1.472335443135E12,"finishTime":1.472335444265E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"08b5b94c-edb8-4192-a601-32ddb0c954a6"},{"version":"CommandV1","origId":48516603025663,"guid":"de358aec-2db5-45da-b151-a42414e8368f","subtype":"command","commandType":"auto","position":35.75,"command":"# TODO: Replace <FILL IN> with the appropriate URL. Then, run the following cell\n# to download the data.\ncriteo_url = 'http://criteolabs.wpengine.com/wp-content/uploads/2015/04/dac_sample.tar.gz'","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47233544427E12,"submitTime":1.472335443147E12,"finishTime":1.472335444293E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6c1fca6a-4bac-41ab-8409-f884ab473cde"},{"version":"CommandV1","origId":48516603025664,"guid":"5c6562ec-f788-4807-bc4f-5b7bccff866e","subtype":"command","commandType":"auto","position":35.875,"command":"# Run this cell after you have filled in criteo_url.\n\nif ('downloaded_data_file' not in locals()) or (downloaded_data_file is None):\n  downloaded_data_file = download_criteo(criteo_url)\n\nif ('raw_df' in locals()) and (raw_df is not None):\n  print \"raw_df is already loaded. Nothing to do. (Set raw_df=None to reload it, then re-run this cell.)\"\nelse:\n  #raw_df = sqlContext.read.text(downloaded_data_file).withColumnRenamed(\"value\", \"text\")\n  rawData = (sc\n             .textFile(downloaded_data_file, 2))\nprint rawData.take(1)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[u&apos;0,1,1,5,0,1382,4,15,2,181,1,2,,2,68fd1e64,80e26c9b,fb936136,7b4723c4,25c83c98,7e0ccccf,de7995b8,1f89b562,a73ee510,a8cd5504,b2cb9c98,37c9c164,2824a5f6,1adce6ef,8ba8b39a,891b62e7,e5ba7672,f54016b9,21ddcdc9,b1252a9d,07b5194c,,3a171ecb,c5c50484,e8b83407,9727dd16&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-26-cda321491367&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">12</span>\n<span class=\"ansiyellow\">    print rawData.take(1)</span>\n<span class=\"ansigrey\">        ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n\n</div>","workflows":[],"startTime":1.472335444297E12,"submitTime":1.472335443158E12,"finishTime":1.472335452646E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9cfcdaf0-5aa0-4b3b-913a-d04ace8fa09d"},{"version":"CommandV1","origId":48516603025510,"guid":"43ebf08a-917a-47fe-b10f-cb0188bb2c30","subtype":"command","commandType":"auto","position":36.0,"command":"#fileName = 'path to the dac_sample.txt in your s3 bucket mount'\n# example: fileName = '/mnt/HackOnData/lab7/dac_sample.txt'\n\n#rawData = (sc\n#           .textFile(fileName, 2)\n#           .map(lambda x: x.replace('\\t', ',')))  # work with either ',' or '\\t' separated data\n#print rawData.take(1)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335452649E12,"submitTime":1.472335443168E12,"finishTime":1.472335452721E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"beb12725-ca5e-43d6-80fe-3eea8b9fe51c"},{"version":"CommandV1","origId":48516603025511,"guid":"20b188f0-bfe0-42f7-994f-b79bb3ab870d","subtype":"command","commandType":"auto","position":38.0,"command":"%md\n**(3a) Loading and splitting the data **\n \nWe are now ready to start working with the actual CTR data, and our first task involves splitting it into training, validation, and test sets.  Use the [randomSplit method](https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.randomSplit) with the specified weights and seed to create RDDs storing each of these datasets, and then [cache](https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.cache) each of these RDDs, as we will be accessing them multiple times in the remainder of this lab. Finally, compute the size of each dataset.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443179E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"22c60b6d-6d4c-4db1-86b9-6beb651ea243"},{"version":"CommandV1","origId":48516603025512,"guid":"7b842f3e-a2cf-486c-93fc-e8bbc466739a","subtype":"command","commandType":"auto","position":39.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nweights = [.8, .1, .1]\nseed = 42\n# Use randomSplit with weights and seed\nrawTrainData, rawValidationData, rawTestData = rawData.randomSplit(weights, seed)\n# Cache the data\nrawTrainData.cache()\nrawValidationData.cache()\nrawTestData.cache()\n\nnTrain = rawTrainData.count()\nnVal = rawValidationData.count()\nnTest = rawTestData.count()\nprint nTrain, nVal, nTest, nTrain + nVal + nTest\nprint rawData.take(1)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">79911 10075 10014 100000\n[u&apos;0,1,1,5,0,1382,4,15,2,181,1,2,,2,68fd1e64,80e26c9b,fb936136,7b4723c4,25c83c98,7e0ccccf,de7995b8,1f89b562,a73ee510,a8cd5504,b2cb9c98,37c9c164,2824a5f6,1adce6ef,8ba8b39a,891b62e7,e5ba7672,f54016b9,21ddcdc9,b1252a9d,07b5194c,,3a171ecb,c5c50484,e8b83407,9727dd16&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335452725E12,"submitTime":1.4723354432E12,"finishTime":1.472335454437E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9802b9b9-6f45-4b41-b98a-f16e5ab8ac13"},{"version":"CommandV1","origId":48516603025513,"guid":"13691e4f-0627-4029-8863-02c519b1dda2","subtype":"command","commandType":"auto","position":40.0,"command":"# TEST Loading and splitting the data (3a)\nTest.assertTrue(all([rawTrainData.is_cached, rawValidationData.is_cached, rawTestData.is_cached]),\n                'you must cache the split data')\nTest.assertEquals(nTrain, 79911, 'incorrect value for nTrain')\nTest.assertEquals(nVal, 10075, 'incorrect value for nVal')\nTest.assertEquals(nTest, 10014, 'incorrect value for nTest')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47233545444E12,"submitTime":1.47233544321E12,"finishTime":1.47233545448E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"37fe7672-6e82-4f6a-b615-d5f75512c5c8"},{"version":"CommandV1","origId":48516603025514,"guid":"195b6965-3fe0-45d4-b904-b95c004fbe19","subtype":"command","commandType":"auto","position":41.0,"command":"%md\n** (3b) Extract features **\n \nWe will now parse the raw training data to create an RDD that we can subsequently use to create an OHE dictionary. Note from the `take()` command in Part (3a) that each raw data point is a string containing several fields separated by some delimiter.  For now, we will ignore the first field (which is the 0-1 label), and parse the remaining fields (or raw features).  To do this, complete the implemention of the `parsePoint` function.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443221E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7b5967ef-61e3-4f83-956b-e9000e163f70"},{"version":"CommandV1","origId":48516603025515,"guid":"d6d311ca-6189-4942-ab93-99bc93909d2c","subtype":"command","commandType":"auto","position":42.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef parsePoint(point):\n    \"\"\"Converts a comma separated string into a list of (featureID, value) tuples.\n\n    Note:\n        featureIDs should start at 0 and increase to the number of features - 1.\n\n    Args:\n        point (str): A comma separated string where the first value is the label and the rest\n            are features.\n\n    Returns:\n        list: A list of (featureID, value) tuples.\n    \"\"\"\n    features = point.split(',')[1:]\n    return [(featureID, value) for featureID, value in enumerate(features)]\n\nparsedTrainFeat = rawTrainData.map(parsePoint)\n\nnumCategories = (parsedTrainFeat\n                 .flatMap(lambda x: x)\n                 .distinct()\n                 .map(lambda x: (x[0], 1))\n                 .reduceByKey(lambda x, y: x + y)\n                 .sortByKey()\n                 .collect())\n\nprint numCategories[2][1]","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">855\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335454484E12,"submitTime":1.47233544324E12,"finishTime":1.472335457404E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a9a80b17-ffa2-4f19-9503-16c2684ec301"},{"version":"CommandV1","origId":48516603025516,"guid":"ad800093-2909-4e1d-95a3-108ba6983926","subtype":"command","commandType":"auto","position":43.0,"command":"# TEST Extract features (3b)\nTest.assertEquals(numCategories[2][1], 855, 'incorrect implementation of parsePoint')\nTest.assertEquals(numCategories[32][1], 4, 'incorrect implementation of parsePoint')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335457408E12,"submitTime":1.47233544325E12,"finishTime":1.472335457447E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"27a2cccc-dc0c-4ace-942e-0b41ca7ceda8"},{"version":"CommandV1","origId":48516603025517,"guid":"e81e9485-26c8-4b98-b8f6-6d2c48a05a8b","subtype":"command","commandType":"auto","position":44.0,"command":"%md\n**(3c) Create an OHE dictionary from the dataset **\n \nNote that parsePoint returns a data point as a list of `(featureID, category)` tuples, which is the same format as the sample dataset studied in Parts 1 and 2 of this lab.  Using this observation, create an OHE dictionary using the function implemented in Part (2c). Note that we will assume for simplicity that all features in our CTR dataset are categorical.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.47233544326E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"40c009fc-ca24-4372-a0d0-e771e2a7bd72"},{"version":"CommandV1","origId":48516603025518,"guid":"714a51e1-d17e-4997-bcf4-b26a9afdbe5b","subtype":"command","commandType":"auto","position":45.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nctrOHEDict = createOneHotDict(parsedTrainFeat)\nnumCtrOHEFeats = len(ctrOHEDict.keys())\nprint numCtrOHEFeats\nprint ctrOHEDict[(0, '')]","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">233286\n36164\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47233545745E12,"submitTime":1.472335443287E12,"finishTime":1.472335460713E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bb080443-4429-4f0a-b9e2-73088e0be5b0"},{"version":"CommandV1","origId":48516603025519,"guid":"a579e7b9-e883-41e1-884f-8363c1df3666","subtype":"command","commandType":"auto","position":46.0,"command":"# TEST Create an OHE dictionary from the dataset (3c)\nTest.assertEquals(numCtrOHEFeats, 233286, 'incorrect number of features in ctrOHEDict')\nTest.assertTrue((0, '') in ctrOHEDict, 'incorrect features in ctrOHEDict')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335460717E12,"submitTime":1.472335443297E12,"finishTime":1.472335460741E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0f5194a5-5d06-4a18-90e5-116a53c074de"},{"version":"CommandV1","origId":48516603025520,"guid":"134392cb-d33c-46e8-bb6d-5206b9e8a549","subtype":"command","commandType":"auto","position":47.0,"command":"%md\n** (3d) Apply OHE to the dataset **\n \nNow let's use this OHE dictionary by starting with the raw training data and creating an RDD of [LabeledPoint](http://spark.apache.org/docs/1.3.1/api/python/pyspark.mllib.html#pyspark.mllib.regression.LabeledPoint) objects using OHE features.  To do this, complete the implementation of the `parseOHEPoint` function. Hint: `parseOHEPoint` is an extension of the `parsePoint` function from Part (3b) and it uses the `oneHotEncoding` function from Part (1d).","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443307E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"563a1d48-859b-4173-a138-6ec8246a1236"},{"version":"CommandV1","origId":48516603025674,"guid":"4091dbbb-49e3-4d07-8b0f-079007c17438","subtype":"command","commandType":"auto","position":47.5,"command":"help(oneHotEncoding)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Help on function oneHotEncoding in module __main__:\n\noneHotEncoding(rawFeats, OHEDict, numOHEFeats)\n    Produce a one-hot-encoding from a list of features and an OHE dictionary.\n    \n    Note:\n        You should ensure that the indices used to create a SparseVector are sorted.\n    \n    Args:\n        rawFeats (list of (int, str)): The features corresponding to a single observation.  Each\n            feature consists of a tuple of featureID and the feature&apos;s value. (e.g. sampleOne)\n        OHEDict (dict): A mapping of (featureID, value) to unique integer.\n        numOHEFeats (int): The total number of unique OHE features (combinations of featureID and\n            value).\n    \n    Returns:\n        SparseVector: A SparseVector of length numOHEFeats with indices equal to the unique\n            identifiers for the (featureID, value) combinations that occur in the observation and\n            with values equal to 1.0.\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335460746E12,"submitTime":1.472335443325E12,"finishTime":1.472335460786E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b1874835-b652-444c-9853-8dbda2167ce8"},{"version":"CommandV1","origId":48516603025521,"guid":"9c122320-514a-4bb2-9385-fcb8c5625371","subtype":"command","commandType":"auto","position":48.0,"command":"from pyspark.mllib.regression import LabeledPoint","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47233546079E12,"submitTime":1.472335443335E12,"finishTime":1.472335460814E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9256bb76-1cd9-4809-806a-c36352131c77"},{"version":"CommandV1","origId":48516603025522,"guid":"be28aec5-7b65-4d39-a720-410cd112a80d","subtype":"command","commandType":"auto","position":49.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef parseOHEPoint(point, OHEDict, numOHEFeats):\n    \"\"\"Obtain the label and feature vector for this raw observation.\n\n    Note:\n        You must use the function `oneHotEncoding` in this implementation or later portions\n        of this lab may not function as expected.\n\n    Args:\n        point (str): A comma separated string where the first value is the label and the rest\n            are features.\n        OHEDict (dict of (int, str) to int): Mapping of (featureID, value) to unique integer.\n        numOHEFeats (int): The number of unique features in the training dataset.\n\n    Returns:\n        LabeledPoint: Contains the label for the observation and the one-hot-encoding of the\n            raw features based on the provided OHE dictionary.\n    \"\"\"\n    label = point.split(',')[0]\n    featureID_value_pair = parsePoint(point)\n    features = oneHotEncoding(featureID_value_pair, OHEDict, numOHEFeats)\n    return LabeledPoint(label,features)\n\nOHETrainData = rawTrainData.map(lambda point: parseOHEPoint(point, ctrOHEDict, numCtrOHEFeats))\nOHETrainData.cache()\nprint OHETrainData.take(1)\n\n# Check that oneHotEncoding function was used in parseOHEPoint\nbackupOneHot = oneHotEncoding\noneHotEncoding = None\nwithOneHot = False\ntry: parseOHEPoint(rawTrainData.take(1)[0], ctrOHEDict, numCtrOHEFeats)\nexcept TypeError: withOneHot = True\noneHotEncoding = backupOneHot","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[LabeledPoint(0.0, (233286,[386,3077,6799,8264,8862,11800,12802,16125,17551,18566,29331,33132,39525,55794,61786,81396,82659,93573,96929,100677,109699,110646,112132,120260,128596,132397,132803,140620,160675,185498,190370,191146,195925,202664,204273,206055,222737,225958,229942],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]))]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335460817E12,"submitTime":1.472335443345E12,"finishTime":1.472335467886E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"98980be7-63d3-4711-9d1f-e7ab9bf037b8"},{"version":"CommandV1","origId":48516603025523,"guid":"df5d4ddb-4f67-4ae9-a57a-dfc9190ce43e","subtype":"command","commandType":"auto","position":50.0,"command":"# TEST Apply OHE to the dataset (3d)\nnumNZ = sum(parsedTrainFeat.map(lambda x: len(x)).take(5))\nnumNZAlt = sum(OHETrainData.map(lambda lp: len(lp.features.indices)).take(5))\nTest.assertEquals(numNZ, numNZAlt, 'incorrect implementation of parseOHEPoint')\nTest.assertTrue(withOneHot, 'oneHotEncoding not present in parseOHEPoint')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47233546789E12,"submitTime":1.472335443355E12,"finishTime":1.472335468013E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"462e1d5d-a78c-46bf-9fa5-c2e159c6458a"},{"version":"CommandV1","origId":48516603025524,"guid":"cdab041d-0ebe-44b7-bb36-de4ef7372032","subtype":"command","commandType":"auto","position":51.0,"command":"%md\n**Visualization 1: Feature frequency **\n \nWe will now visualize the number of times each of the 233,286 OHE features appears in the training data. We first compute the number of times each feature appears, then bucket the features by these counts.  The buckets are sized by powers of 2, so the first bucket corresponds to features that appear exactly once ( \\\\( \\scriptsize 2^0 \\\\) ), the second to features that appear twice ( \\\\( \\scriptsize 2^1 \\\\) ), the third to features that occur between three and four ( \\\\( \\scriptsize 2^2 \\\\) ) times, the fifth bucket is five to eight ( \\\\( \\scriptsize 2^3 \\\\) ) times and so on. The scatter plot below shows the logarithm of the bucket thresholds versus the logarithm of the number of features that have counts that fall in the buckets.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443364E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"69d15fbd-b820-47fb-9234-b383c76abb4e"},{"version":"CommandV1","origId":48516603025525,"guid":"5c6bd115-ce99-482e-95ec-15eca33196e0","subtype":"command","commandType":"auto","position":52.0,"command":"def bucketFeatByCount(featCount):\n    \"\"\"Bucket the counts by powers of two.\"\"\"\n    for i in range(11):\n        size = 2 ** i\n        if featCount <= size:\n            return size\n    return -1\n\nfeatCounts = (OHETrainData\n              .flatMap(lambda lp: lp.features.indices)\n              .map(lambda x: (x, 1))\n              .reduceByKey(lambda x, y: x + y))\nfeatCountsBuckets = (featCounts\n                     .map(lambda x: (bucketFeatByCount(x[1]), 1))\n                     .filter(lambda (k, v): k != -1)\n                     .reduceByKey(lambda x, y: x + y)\n                     .collect())\nprint featCountsBuckets","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[(256, 748), (1024, 255), (2, 24076), (4, 16639), (32, 4755), (8, 11440), (64, 2627), (128, 1476), (16, 7752), (512, 414), (1, 162813)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335468017E12,"submitTime":1.47233544338E12,"finishTime":1.47233547465E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f157496f-a4a4-4285-9530-ef1815d4c0f9"},{"version":"CommandV1","origId":48516603025526,"guid":"5c72e086-33ca-403c-b812-9bb3ac5bd66d","subtype":"command","commandType":"auto","position":53.0,"command":"import matplotlib.pyplot as plt\n\nx, y = zip(*featCountsBuckets)\nx, y = np.log(x), np.log(y)\n\ndef preparePlot(xticks, yticks, figsize=(10.5, 6), hideLabels=False, gridColor='#999999',\n                gridWidth=1.0):\n    \"\"\"Template for generating the plot layout.\"\"\"\n    plt.close()\n    fig, ax = plt.subplots(figsize=figsize, facecolor='white', edgecolor='white')\n    ax.axes.tick_params(labelcolor='#999999', labelsize='10')\n    for axis, ticks in [(ax.get_xaxis(), xticks), (ax.get_yaxis(), yticks)]:\n        axis.set_ticks_position('none')\n        axis.set_ticks(ticks)\n        axis.label.set_color('#999999')\n        if hideLabels: axis.set_ticklabels([])\n    plt.grid(color=gridColor, linewidth=gridWidth, linestyle='-')\n    map(lambda position: ax.spines[position].set_visible(False), ['bottom', 'top', 'left', 'right'])\n    return fig, ax\n\n# generate layout and plot data\nfig, ax = preparePlot(np.arange(0, 10, 1), np.arange(4, 14, 2))\nax.set_xlabel(r'$\\log_e(bucketSize)$'), ax.set_ylabel(r'$\\log_e(countInBucket)$')\nplt.scatter(x, y, s=14**2, c='#d6ebf2', edgecolors='#8cbfd0', alpha=0.75)\ndisplay(fig) \npass","commandVersion":1,"state":"finished","results":{"type":"image","data":"data:image/png;base64,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","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335474654E12,"submitTime":1.47233544339E12,"finishTime":1.472335475914E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cfa2824f-f37c-47a6-b779-b599025c5338"},{"version":"CommandV1","origId":48516603025527,"guid":"84bf306a-d5ee-4ff2-a0d0-3cfa628c8924","subtype":"command","commandType":"auto","position":54.0,"command":"%md\n**(3e) Handling unseen features **\n \nWe naturally would like to repeat the process from Part (3d), e.g., to compute OHE features for the validation and test datasets.  However, we must be careful, as some categorical values will likely appear in new data that did not exist in the training data. To deal with this situation, update the `oneHotEncoding()` function from Part (1d) to ignore previously unseen categories, and then compute OHE features for the validation data.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443399E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1a3f898f-a97a-4d28-a216-90e0cdb908a2"},{"version":"CommandV1","origId":48516603025528,"guid":"78d120a2-3c53-4b12-b06e-87c16ae26a41","subtype":"command","commandType":"auto","position":55.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef oneHotEncoding(rawFeats, OHEDict, numOHEFeats):\n    \"\"\"Produce a one-hot-encoding from a list of features and an OHE dictionary.\n\n    Note:\n        If a (featureID, value) tuple doesn't have a corresponding key in OHEDict it should be\n        ignored.\n\n    Args:\n        rawFeats (list of (int, str)): The features corresponding to a single observation.  Each\n            feature consists of a tuple of featureID and the feature's value. (e.g. sampleOne)\n        OHEDict (dict): A mapping of (featureID, value) to unique integer.\n        numOHEFeats (int): The total number of unique OHE features (combinations of featureID and\n            value).\n\n    Returns:\n        SparseVector: A SparseVector of length numOHEFeats with indices equal to the unique\n            identifiers for the (featureID, value) combinations that occur in the observation and\n            with values equal to 1.0.\n    \"\"\"\n    indices = [OHEDict[key] for key in rawFeats if key in OHEDict]\n    indices.sort()\n    vector = np.ones(len(indices))\n    return SparseVector(numOHEFeats, indices, vector)\n    \n\nOHEValidationData = rawValidationData.map(lambda point: parseOHEPoint(point, ctrOHEDict, numCtrOHEFeats))\nOHEValidationData.cache()\nprint OHEValidationData.take(1)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[LabeledPoint(0.0, (233286,[7576,9187,15510,21585,31213,36164,39525,49198,61786,66603,67218,68211,68311,73035,76672,81329,81396,91981,96929,98450,109699,110946,117015,121552,141711,146496,147649,171128,184132,184687,185498,194763,198537,201039,210717,213588,222162,222626,227709],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]))]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 39.0 failed 1 times, most recent failure: Lost task 0.0 in stage 39.0 (TID 114, localhost): org.apache.spark.api.python.PythonException: Traceback (most recent call last):","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-35-496bbba4dfc1&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     27</span> OHEValidationData <span class=\"ansiyellow\">=</span> rawValidationData<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> point<span class=\"ansiyellow\">:</span> parseOHEPoint<span class=\"ansiyellow\">(</span>point<span class=\"ansiyellow\">,</span> ctrOHEDict<span class=\"ansiyellow\">,</span> numCtrOHEFeats<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     28</span> OHEValidationData<span class=\"ansiyellow\">.</span>cache<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 29</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">print</span> OHEValidationData<span class=\"ansiyellow\">.</span>take<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/rdd.py</span> in <span class=\"ansicyan\">take</span><span class=\"ansiblue\">(self, num)</span>\n<span class=\"ansigreen\">   1295</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1296</span>             p <span class=\"ansiyellow\">=</span> range<span class=\"ansiyellow\">(</span>partsScanned<span class=\"ansiyellow\">,</span> min<span class=\"ansiyellow\">(</span>partsScanned <span class=\"ansiyellow\">+</span> numPartsToTry<span class=\"ansiyellow\">,</span> totalParts<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1297</span><span class=\"ansiyellow\">             </span>res <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>context<span class=\"ansiyellow\">.</span>runJob<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> takeUpToNumLeft<span class=\"ansiyellow\">,</span> p<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1298</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1299</span>             items <span class=\"ansiyellow\">+=</span> res<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/context.py</span> in <span class=\"ansicyan\">runJob</span><span class=\"ansiblue\">(self, rdd, partitionFunc, partitions, allowLocal)</span>\n<span class=\"ansigreen\">    937</span>         <span class=\"ansired\"># SparkContext#runJob.</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    938</span>         mappedRDD <span class=\"ansiyellow\">=</span> rdd<span class=\"ansiyellow\">.</span>mapPartitions<span class=\"ansiyellow\">(</span>partitionFunc<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 939</span><span class=\"ansiyellow\">         </span>port <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>PythonRDD<span class=\"ansiyellow\">.</span>runJob<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jsc<span class=\"ansiyellow\">.</span>sc<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> mappedRDD<span class=\"ansiyellow\">.</span>_jrdd<span class=\"ansiyellow\">,</span> partitions<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    940</span>         <span class=\"ansigreen\">return</span> list<span class=\"ansiyellow\">(</span>_load_from_socket<span class=\"ansiyellow\">(</span>port<span class=\"ansiyellow\">,</span> mappedRDD<span class=\"ansiyellow\">.</span>_jrdd_deserializer<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    941</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    811</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    812</span>         return_value = get_return_value(\n<span class=\"ansigreen\">--&gt; 813</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">    814</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    815</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     43</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     44</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 45</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     46</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     47</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    306</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    307</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 308</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    309</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    310</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 39.0 failed 1 times, most recent failure: Lost task 0.0 in stage 39.0 (TID 114, localhost): org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 111, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 106, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/serializers.py&quot;, line 263, in dump_stream\n    vs = list(itertools.islice(iterator, batch))\n  File &quot;&lt;ipython-input-35-496bbba4dfc1&gt;&quot;, line 27, in &lt;lambda&gt;\n  File &quot;&lt;ipython-input-32-8ac270735b63&gt;&quot;, line 21, in parseOHEPoint\n  File &quot;&lt;ipython-input-35-496bbba4dfc1&gt;&quot;, line 22, in oneHotEncoding\nAttributeError: &apos;NoneType&apos; object has no attribute &apos;sort&apos;\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:166)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:207)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:125)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:70)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:306)\n\tat org.apache.spark.CacheManager.getOrCompute(CacheManager.scala:69)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:268)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:70)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:306)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:270)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:72)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:96)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:222)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1431)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1419)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1418)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1418)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:799)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:799)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:799)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1640)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1599)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1588)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:620)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1837)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1850)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1863)\n\tat org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:393)\n\tat org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:497)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:231)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:381)\n\tat py4j.Gateway.invoke(Gateway.java:259)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:133)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:209)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 111, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 106, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/serializers.py&quot;, line 263, in dump_stream\n    vs = list(itertools.islice(iterator, batch))\n  File &quot;&lt;ipython-input-35-496bbba4dfc1&gt;&quot;, line 27, in &lt;lambda&gt;\n  File &quot;&lt;ipython-input-32-8ac270735b63&gt;&quot;, line 21, in parseOHEPoint\n  File &quot;&lt;ipython-input-35-496bbba4dfc1&gt;&quot;, line 22, in oneHotEncoding\nAttributeError: &apos;NoneType&apos; object has no attribute &apos;sort&apos;\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:166)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:207)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:125)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:70)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:306)\n\tat org.apache.spark.CacheManager.getOrCompute(CacheManager.scala:69)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:268)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:70)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:306)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:270)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:72)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:96)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:222)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n\n</div>","workflows":[],"startTime":1.472335475917E12,"submitTime":1.472335443423E12,"finishTime":1.472335480249E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9523ddb5-fb25-4f52-8727-708ed0214cec"},{"version":"CommandV1","origId":48516603025529,"guid":"ea4bd348-b2cd-4c75-ae21-e12e3de3a3dd","subtype":"command","commandType":"auto","position":56.0,"command":"# TEST Handling unseen features (3e)\nnumNZVal = (OHEValidationData\n            .map(lambda lp: len(lp.features.indices))\n            .sum())\nTest.assertEquals(numNZVal, 372080, 'incorrect number of features')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335480253E12,"submitTime":1.472335443434E12,"finishTime":1.472335480927E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3a25841d-0fe7-462d-b1af-3e531fc66283"},{"version":"CommandV1","origId":48516603025530,"guid":"f8b0d026-f990-4895-ba00-1eff86f68dd8","subtype":"command","commandType":"auto","position":57.0,"command":"%md\n#### ** Part 4: CTR prediction and logloss evaluation **","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443443E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e44b60c6-1bbf-4528-b54d-b92e87e7a574"},{"version":"CommandV1","origId":48516603025531,"guid":"f577ff14-d5e6-4557-b6f6-e1e871e329b0","subtype":"command","commandType":"auto","position":58.0,"command":"%md\n** (4a) Logistic regression **\n \nWe are now ready to train our first CTR classifier.  A natural classifier to use in this setting is logistic regression, since it models the probability of a click-through event rather than returning a binary response, and when working with rare events, probabilistic predictions are useful.\n \nFirst use [LogisticRegressionWithSGD](https://spark.apache.org/docs/latest/api/python/pyspark.mllib.html#pyspark.mllib.classification.LogisticRegressionWithSGD) to train a model using `OHETrainData` with the given hyperparameter configuration.  `LogisticRegressionWithSGD` returns a [LogisticRegressionModel](https://spark.apache.org/docs/latest/api/python/pyspark.mllib.html#pyspark.mllib.regression.LogisticRegressionModel).  Next, use the `LogisticRegressionModel.weights` and `LogisticRegressionModel.intercept` attributes to print out the model's parameters.  Note that these are the names of the object's attributes and should be called using a syntax like `model.weights` for a given `model`.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443461E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d0cb8f39-8f28-45e9-a326-2ee72ed7a08d"},{"version":"CommandV1","origId":48516603025532,"guid":"e284a6ca-f185-47d0-80a6-1509043a7052","subtype":"command","commandType":"auto","position":59.0,"command":"from pyspark.mllib.classification import LogisticRegressionWithSGD\n\n# fixed hyperparameters\nnumIters = 50\nstepSize = 10.\nregParam = 1e-6\nregType = 'l2'\nincludeIntercept = True","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47233548093E12,"submitTime":1.472335443484E12,"finishTime":1.472335480969E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1e191479-7a04-4414-99d8-b3d22218b77b"},{"version":"CommandV1","origId":2680063632472868,"guid":"9bb08f32-fdd7-45f2-8b24-23699392e971","subtype":"command","commandType":"auto","position":59.5,"command":"%md\nhttps://spark.apache.org/docs/latest/api/python/pyspark.mllib.html#pyspark.mllib.classification.LogisticRegressionWithSGD.train\n\nclassmethod train(data, iterations=100, step=1.0, miniBatchFraction=1.0, initialWeights=None, regParam=0.01, regType='l2', intercept=False, validateData=True, convergenceTol=0.001)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443492E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"98f97671-7ba0-4813-a3c4-17eb0d182d4f"},{"version":"CommandV1","origId":48516603025533,"guid":"a1ca345b-5389-45bc-92bd-40e1a8046fea","subtype":"command","commandType":"auto","position":60.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nmodel0 = LogisticRegressionWithSGD.train(OHETrainData,iterations=numIters, step=stepSize, regParam=regParam, regType=regType, intercept=includeIntercept)\nsortedWeights = sorted(model0.weights)\nprint sortedWeights[:5], model0.intercept","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[-0.45899236853575609, -0.37973707648623956, -0.36996558266753304, -0.36934962879928263, -0.32697945415010637] 0.56455084025\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: train() takes at least 2 arguments (6 given)","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-39-c3cf7908bffb&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\"># TODO: Replace &lt;FILL IN&gt; with appropriate code</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>model0 <span class=\"ansiyellow\">=</span> LogisticRegressionWithSGD<span class=\"ansiyellow\">.</span>train<span class=\"ansiyellow\">(</span>iterations<span class=\"ansiyellow\">=</span>numIters<span class=\"ansiyellow\">,</span> step<span class=\"ansiyellow\">=</span>stepSize<span class=\"ansiyellow\">,</span> regParam<span class=\"ansiyellow\">=</span>regParam<span class=\"ansiyellow\">,</span> regType<span class=\"ansiyellow\">=</span>regType<span class=\"ansiyellow\">,</span> intercept<span class=\"ansiyellow\">=</span>includeIntercept<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> sortedWeights <span class=\"ansiyellow\">=</span> sorted<span class=\"ansiyellow\">(</span>model0<span class=\"ansiyellow\">.</span>weights<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansigreen\">print</span> sortedWeights<span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">:</span><span class=\"ansicyan\">5</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> model0<span class=\"ansiyellow\">.</span>intercept<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: train() takes at least 2 arguments (6 given)\n</div>","workflows":[],"startTime":1.472335480971E12,"submitTime":1.472335443509E12,"finishTime":1.472335493503E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e41aad78-0a92-44ee-8234-074d5d639a5b"},{"version":"CommandV1","origId":48516603025534,"guid":"eec78b6f-d973-45a7-ba65-513efa8c2ec3","subtype":"command","commandType":"auto","position":61.0,"command":"# TEST Logistic regression (4a)\nTest.assertTrue(np.allclose(model0.intercept,  0.56455084025), 'incorrect value for model0.intercept')\nTest.assertTrue(np.allclose(sortedWeights[0:5],\n                [-0.45899236853575609, -0.37973707648623956, -0.36996558266753304,\n                 -0.36934962879928263, -0.32697945415010637]), 'incorrect value for model0.weights')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335493507E12,"submitTime":1.472335443519E12,"finishTime":1.472335493531E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"35b3752d-9be1-4cdc-8e13-da96fbd36c5a"},{"version":"CommandV1","origId":48516603025535,"guid":"3e748f7d-99a6-4be5-8b55-8fd4aaf02d8a","subtype":"command","commandType":"auto","position":62.0,"command":"%md\n** (4b) Log loss **\nThroughout this lab, we will use log loss to evaluate the quality of models.  Log loss is defined as: \\\\[ \\scriptsize \\ell_{log}(p, y) = \\begin{cases} -\\log (p) & \\text{if } y = 1 \\\\\\ -\\log(1-p) & \\text{if } y = 0 \\end{cases} \\\\] where \\\\( \\scriptsize p\\\\) is a probability between 0 and 1 and \\\\( \\scriptsize y\\\\) is a label of either 0 or 1. Log loss is a standard evaluation criterion when predicting rare-events such as click-through rate prediction (it is also the criterion used in the [Criteo Kaggle competition](https://www.kaggle.com/c/criteo-display-ad-challenge)).\n \nWrite a function to compute log loss, and evaluate it on some sample inputs.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443527E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5a5569fc-4164-4407-99cf-e136e3f59e40"},{"version":"CommandV1","origId":48516603025536,"guid":"35f34640-7417-4449-9b0d-0eb40021f16c","subtype":"command","commandType":"auto","position":63.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nfrom math import log\n\ndef computeLogLoss(p, y):\n    \"\"\"Calculates the value of log loss for a given probabilty and label.\n\n    Note:\n        log(0) is undefined, so when p is 0 we need to add a small value (epsilon) to it\n        and when p is 1 we need to subtract a small value (epsilon) from it.\n\n    Args:\n        p (float): A probabilty between 0 and 1.\n        y (int): A label.  Takes on the values 0 and 1.\n\n    Returns:\n        float: The log loss value.\n    \"\"\"\n    epsilon = 10e-12\n    if p==0 : p+=epsilon\n    if p==1 : p-=epsilon\n    if y ==1:\n      return -log(p)\n    else:\n      return -log(1-p)\n\nprint computeLogLoss(.5, 1)\nprint computeLogLoss(.5, 0)\nprint computeLogLoss(.99, 1)\nprint computeLogLoss(.99, 0)\nprint computeLogLoss(.01, 1)\nprint computeLogLoss(.01, 0)\nprint computeLogLoss(0, 1)\nprint computeLogLoss(1, 1)\nprint computeLogLoss(1, 0)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">0.69314718056\n0.69314718056\n0.0100503358535\n4.60517018599\n4.60517018599\n0.0100503358535\n25.3284360229\n1.00000008275e-11\n25.3284359402\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: global name &apos;lop&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-42-a59e2cca2fa0&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     24</span>       <span class=\"ansigreen\">return</span> <span class=\"ansiyellow\">-</span>lop<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">-</span>p<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     25</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 26</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">print</span> computeLogLoss<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">.5</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     27</span> <span class=\"ansigreen\">print</span> computeLogLoss<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">.5</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">0</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     28</span> <span class=\"ansigreen\">print</span> computeLogLoss<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">.99</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;ipython-input-42-a59e2cca2fa0&gt;</span> in <span class=\"ansicyan\">computeLogLoss</span><span class=\"ansiblue\">(p, y)</span>\n<span class=\"ansigreen\">     20</span>     <span class=\"ansigreen\">if</span> p<span class=\"ansiyellow\">==</span><span class=\"ansicyan\">1</span> <span class=\"ansiyellow\">:</span> p<span class=\"ansiyellow\">-=</span>epsilon<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     21</span>     <span class=\"ansigreen\">if</span> y <span class=\"ansiyellow\">==</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 22</span><span class=\"ansiyellow\">       </span><span class=\"ansigreen\">return</span> <span class=\"ansiyellow\">-</span>lop<span class=\"ansiyellow\">(</span>p<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     23</span>     <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     24</span>       <span class=\"ansigreen\">return</span> <span class=\"ansiyellow\">-</span>lop<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">-</span>p<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: global name &apos;lop&apos; is not defined\n</div>","workflows":[],"startTime":1.472335493534E12,"submitTime":1.472335443541E12,"finishTime":1.472335493609E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8e70fd69-bfa9-4167-b38f-e7480ca5603c"},{"version":"CommandV1","origId":48516603025537,"guid":"424b76fd-98f6-40d5-ba47-c1f2ad8d9ca8","subtype":"command","commandType":"auto","position":64.0,"command":"# TEST Log loss (4b)\nTest.assertTrue(np.allclose([computeLogLoss(.5, 1), computeLogLoss(.01, 0), computeLogLoss(.01, 1)],\n                            [0.69314718056, 0.0100503358535, 4.60517018599]),\n                'computeLogLoss is not correct')\nTest.assertTrue(np.allclose([computeLogLoss(0, 1), computeLogLoss(1, 1), computeLogLoss(1, 0)],\n                            [25.3284360229, 1.00000008275e-11, 25.3284360229]),\n                'computeLogLoss needs to bound p away from 0 and 1 by epsilon')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.472335493613E12,"submitTime":1.472335443549E12,"finishTime":1.472335493688E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"112ace53-f958-49d2-beeb-571733b0759b"},{"version":"CommandV1","origId":48516603025538,"guid":"3625e9a4-1726-407a-b10a-eff0bf2a08bf","subtype":"command","commandType":"auto","position":65.0,"command":"%md\n** (4c)  Baseline log loss **\n \nNext we will use the function we wrote in Part (4b) to compute the baseline log loss on the training data. A very simple yet natural baseline model is one where we always make the same prediction independent of the given datapoint, setting the predicted value equal to the fraction of training points that correspond to click-through events (i.e., where the label is one). Compute this value (which is simply the mean of the training labels), and then use it to compute the training log loss for the baseline model.  The log loss for multiple observations is the mean of the individual log loss values.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443557E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0e630c31-a5fd-4113-a85e-44af9e92442a"},{"version":"CommandV1","origId":48516603025539,"guid":"8c6a1ddf-15e0-4c08-b976-db0b0e9acf04","subtype":"command","commandType":"auto","position":66.0,"command":"# TODO: Replace <FILL IN> with appropriate code\n# Note that our dataset has a very high click-through rate by design\n# In practice click-through rate can be one to two orders of magnitude lower\nclassOneFracTrain = (OHETrainData.map(lambda x: x.label).reduce(lambda a, b : a+b))/nTrain\nprint classOneFracTrain\n\nlogLossTrBase = OHETrainData.map(lambda x: computeLogLoss(classOneFracTrain, x.label)).mean()\nprint 'Baseline Train Logloss = {0:.3f}\\n'.format(logLossTrBase)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">0.22717773523\nBaseline Train Logloss = 0.536\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 98.0 failed 1 times, most recent failure: Lost task 0.0 in stage 98.0 (TID 227, localhost): org.apache.spark.api.python.PythonException: Traceback (most recent call last):","error":"<div class=\"ansiout\">0.22717773523\n<span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-45-97d4f77901df&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      5</span> <span class=\"ansigreen\">print</span> classOneFracTrain<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      6</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 7</span><span class=\"ansiyellow\"> </span>logLossTrBase <span class=\"ansiyellow\">=</span> OHETrainData<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">:</span> computeLogLoss<span class=\"ansiyellow\">(</span>classeOneFracTrain<span class=\"ansiyellow\">,</span> x<span class=\"ansiyellow\">.</span>label<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>mean<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      8</span> <span class=\"ansigreen\">print</span> <span class=\"ansiblue\">&apos;Baseline Train Logloss = {0:.3f}\\n&apos;</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>logLossTrBase<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/rdd.py</span> in <span class=\"ansicyan\">mean</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">   1149</span>         <span class=\"ansicyan\">2.0</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1150</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">-&gt; 1151</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>stats<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>mean<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1152</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1153</span>     <span class=\"ansigreen\">def</span> variance<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/rdd.py</span> in <span class=\"ansicyan\">stats</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">   1012</span>             <span class=\"ansigreen\">return</span> left_counter<span class=\"ansiyellow\">.</span>mergeStats<span class=\"ansiyellow\">(</span>right_counter<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1013</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1014</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>mapPartitions<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> i<span class=\"ansiyellow\">:</span> <span class=\"ansiyellow\">[</span>StatCounter<span class=\"ansiyellow\">(</span>i<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>reduce<span class=\"ansiyellow\">(</span>redFunc<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1015</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1016</span>     <span class=\"ansigreen\">def</span> histogram<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> buckets<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/rdd.py</span> in <span class=\"ansicyan\">reduce</span><span class=\"ansiblue\">(self, f)</span>\n<span class=\"ansigreen\">    795</span>             <span class=\"ansigreen\">yield</span> reduce<span class=\"ansiyellow\">(</span>f<span class=\"ansiyellow\">,</span> iterator<span class=\"ansiyellow\">,</span> initial<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    796</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 797</span><span class=\"ansiyellow\">         </span>vals <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>mapPartitions<span class=\"ansiyellow\">(</span>func<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    798</span>         <span class=\"ansigreen\">if</span> vals<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    799</span>             <span class=\"ansigreen\">return</span> reduce<span class=\"ansiyellow\">(</span>f<span class=\"ansiyellow\">,</span> vals<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/rdd.py</span> in <span class=\"ansicyan\">collect</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">    769</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    770</span>         <span class=\"ansigreen\">with</span> SCCallSiteSync<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>context<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">as</span> css<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 771</span><span class=\"ansiyellow\">             </span>port <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>ctx<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>PythonRDD<span class=\"ansiyellow\">.</span>collectAndServe<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jrdd<span class=\"ansiyellow\">.</span>rdd<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    772</span>         <span class=\"ansigreen\">return</span> list<span class=\"ansiyellow\">(</span>_load_from_socket<span class=\"ansiyellow\">(</span>port<span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>_jrdd_deserializer<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    773</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    811</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    812</span>         return_value = get_return_value(\n<span class=\"ansigreen\">--&gt; 813</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">    814</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    815</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     43</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     44</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 45</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     46</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     47</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    306</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    307</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 308</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    309</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    310</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.collectAndServe.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 98.0 failed 1 times, most recent failure: Lost task 0.0 in stage 98.0 (TID 227, localhost): org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 111, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 106, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 2346, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 2346, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 317, in func\n    return f(iterator)\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 1014, in &lt;lambda&gt;\n    return self.mapPartitions(lambda i: [StatCounter(i)]).reduce(redFunc)\n  File &quot;/databricks/spark/python/pyspark/statcounter.py&quot;, line 42, in __init__\n    for v in values:\n  File &quot;&lt;ipython-input-45-97d4f77901df&gt;&quot;, line 7, in &lt;lambda&gt;\nNameError: global name &apos;classeOneFracTrain&apos; is not defined\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:166)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:207)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:125)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:70)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:306)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:270)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:72)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:96)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:222)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1431)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1419)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1418)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1418)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:799)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:799)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:799)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1640)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1599)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1588)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:620)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1837)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1850)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1863)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1934)\n\tat org.apache.spark.rdd.RDD$$anonfun$collect$1.apply(RDD.scala:927)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:150)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:111)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:316)\n\tat org.apache.spark.rdd.RDD.collect(RDD.scala:926)\n\tat org.apache.spark.api.python.PythonRDD$.collectAndServe(PythonRDD.scala:405)\n\tat org.apache.spark.api.python.PythonRDD.collectAndServe(PythonRDD.scala)\n\tat sun.reflect.GeneratedMethodAccessor99.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:497)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:231)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:381)\n\tat py4j.Gateway.invoke(Gateway.java:259)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:133)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:209)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 111, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 106, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 2346, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 2346, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 317, in func\n    return f(iterator)\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 1014, in &lt;lambda&gt;\n    return self.mapPartitions(lambda i: [StatCounter(i)]).reduce(redFunc)\n  File &quot;/databricks/spark/python/pyspark/statcounter.py&quot;, line 42, in __init__\n    for v in values:\n  File &quot;&lt;ipython-input-45-97d4f77901df&gt;&quot;, line 7, in &lt;lambda&gt;\nNameError: global name &apos;classeOneFracTrain&apos; is not defined\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:166)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:207)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:125)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:70)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:306)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:270)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:72)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:96)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:222)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n\n</div>","workflows":[],"startTime":1.472335493691E12,"submitTime":1.472335443573E12,"finishTime":1.472335495806E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a2294c2c-a760-40be-bc77-067a182fb4fc"},{"version":"CommandV1","origId":48516603025540,"guid":"774b3dda-575a-464d-949e-ce1dfa9407bb","subtype":"command","commandType":"auto","position":67.0,"command":"# TEST Baseline log loss (4c)\nTest.assertTrue(np.allclose(classOneFracTrain, 0.22717773523), 'incorrect value for classOneFracTrain')\nTest.assertTrue(np.allclose(logLossTrBase, 0.535844), 'incorrect value for logLossTrBase')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.47233549581E12,"submitTime":1.472335443583E12,"finishTime":1.472335495834E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8db254c4-b431-49c0-8173-3b4f56e0fefe"},{"version":"CommandV1","origId":48516603025541,"guid":"248ca64f-a975-4016-ba63-be5518f72fd0","subtype":"command","commandType":"auto","position":68.0,"command":"%md\n** (4d) Predicted probability **\n \nIn order to compute the log loss for the model we trained in Part (4a), we need to write code to generate predictions from this model. Write a function that computes the raw linear prediction from this logistic regression model and then passes it through a [sigmoid function](http://en.wikipedia.org/wiki/Sigmoid_function) \\\\( \\scriptsize \\sigma(t) = (1+ e^{-t})^{-1} \\\\) to return the model's probabilistic prediction. Then compute probabilistic predictions on the training data.\n \nNote that when incorporating an intercept into our predictions, we simply add the intercept to the value of the prediction obtained from the weights and features.  Alternatively, if the intercept was included as the first weight, we would need to add a corresponding feature to our data where the feature has the value one.  This is not the case here.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443591E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cc266efd-7b51-4c72-a46e-8f401c36da02"},{"version":"CommandV1","origId":48516603025542,"guid":"203e0101-5fca-4f0d-907e-7dac744fb118","subtype":"command","commandType":"auto","position":69.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nfrom math import exp #  exp(-t) = e^-t\n\ndef getP(x, w, intercept):\n    \"\"\"Calculate the probability for an observation given a set of weights and intercept.\n\n    Note:\n        We'll bound our raw prediction between 20 and -20 for numerical purposes.\n\n    Args:\n        x (SparseVector): A vector with values of 1.0 for features that exist in this\n            observation and 0.0 otherwise.\n        w (DenseVector): A vector of weights (betas) for the model.\n        intercept (float): The model's intercept.\n\n    Returns:\n        float: A probability between 0 and 1.\n    \"\"\"\n    rawPrediction = intercept + x.dot(w) \n\n    # Bound the raw prediction value\n    rawPrediction = min(rawPrediction, 20)\n    rawPrediction = max(rawPrediction, -20)\n    return 1.0/(1+exp(-rawPrediction))\n\ntrainingPredictions = OHETrainData.map(lambda x: getP(x.features, model0.weights, model0.intercept) )\n\nprint trainingPredictions.take(5)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[0.3026288202391113, 0.10362661997434088, 0.283634247838756, 0.17846102057880123, 0.5389775379218854]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-48-4eb79f9dbbb3&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">26</span>\n<span class=\"ansiyellow\">    trainingPredictions = OHETrainData.map(lambda )</span>\n<span class=\"ansigrey\">                                                  ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n\n</div>","workflows":[],"startTime":1.47233594649E12,"submitTime":1.472335947982E12,"finishTime":1.472335946614E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"57aa8293-42eb-4e06-8ff2-a32c36514b13"},{"version":"CommandV1","origId":48516603025543,"guid":"b7267cf4-3a2c-40aa-b5f1-c283530dbfa5","subtype":"command","commandType":"auto","position":70.0,"command":"# TEST Predicted probability (4d)\nTest.assertTrue(np.allclose(trainingPredictions.sum(), 18135.4834348),\n                'incorrect value for trainingPredictions')","commandVersion":1,"state":"error","results":null,"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.472335443613E12,"submitTime":1.472335443613E12,"finishTime":1.4723354974E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"78d92a64-28c0-400a-9924-e5928848330a"},{"version":"CommandV1","origId":48516603025544,"guid":"529f75dc-89ad-40db-afe9-351abf51c48a","subtype":"command","commandType":"auto","position":71.0,"command":"%md\n** (4e) Evaluate the model **\n \nWe are now ready to evaluate the quality of the model we trained in Part (4a). To do this, first write a general function that takes as input a model and data, and outputs the log loss.  Then run this function on the OHE training data, and compare the result with the baseline log loss.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443621E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"16a9c830-5b51-4490-b997-ffbff21e0aca"},{"version":"CommandV1","origId":48516603025545,"guid":"0300bd35-cd94-42a8-8783-14f91658c2ee","subtype":"command","commandType":"auto","position":72.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef evaluateResults(model, data):\n    \"\"\"Calculates the log loss for the data given the model.\n\n    Args:\n        model (LogisticRegressionModel): A trained logistic regression model.\n        data (RDD of LabeledPoint): Labels and features for each observation.\n\n    Returns:\n        float: Log loss for the data.\n    \"\"\"\n    return data.map(lambda x: computeLogLoss(getP(x.features, model.weights, model.intercept), x.label)).sum()/data.count()\n\nlogLossTrLR0 = evaluateResults(model0, OHETrainData)\nprint ('OHE Features Train Logloss:\\n\\tBaseline = {0:.3f}\\n\\tLogReg = {1:.3f}'\n       .format(logLossTrBase, logLossTrLR0))","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">OHE Features Train Logloss:\n\tBaseline = 0.536\n\tLogReg = 0.457\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.47233608628E12,"submitTime":1.472336087775E12,"finishTime":1.472336089924E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f85053ec-41b5-4944-85ad-7b3f68af14f8"},{"version":"CommandV1","origId":48516603025546,"guid":"ee582174-3718-453f-9ef5-98568cf14eef","subtype":"command","commandType":"auto","position":73.0,"command":"# TEST Evaluate the model (4e)\nTest.assertTrue(np.allclose(logLossTrLR0, 0.456903), 'incorrect value for logLossTrLR0')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.47233609342E12,"submitTime":1.472336094916E12,"finishTime":1.472336093492E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c0da84f4-78b5-41c7-ba85-1edd14bc6e8e"},{"version":"CommandV1","origId":48516603025547,"guid":"6766a9c7-d92e-415c-bd47-918eaf65c8d6","subtype":"command","commandType":"auto","position":74.0,"command":"%md\n** (4f) Validation log loss **\n \nNext, following the same logic as in Parts (4c) and 4(e), compute the validation log loss for both the baseline and logistic regression models. Notably, the baseline model for the validation data should still be based on the label fraction from the training dataset.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443652E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fb7cce8a-42d0-4fe5-bdb7-b0c8a5d085fc"},{"version":"CommandV1","origId":48516603025548,"guid":"17d2fc8f-7146-4aa9-b37c-712f66a1e387","subtype":"command","commandType":"auto","position":75.0,"command":"# TODO: Replace <FILL IN> with appropriate code\nlogLossValBase = OHEValidationData.map(lambda x: computeLogLoss(classOneFracTrain,x.label)).mean()\n\nlogLossValLR0 = evaluateResults(model0, OHEValidationData)\nprint ('OHE Features Validation Logloss:\\n\\tBaseline = {0:.3f}\\n\\tLogReg = {1:.3f}'\n       .format(logLossValBase, logLossValLR0))","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">OHE Features Validation Logloss:\n\tBaseline = 0.528\n\tLogReg = 0.457\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.47233612305E12,"submitTime":1.472336124533E12,"finishTime":1.472336123625E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"576a5517-2a63-423f-ae5a-dec227f14fc0"},{"version":"CommandV1","origId":48516603025549,"guid":"66a70740-9508-4d50-b75e-06ae26eb65b9","subtype":"command","commandType":"auto","position":76.0,"command":"# TEST Validation log loss (4f)\nTest.assertTrue(np.allclose(logLossValBase, 0.527603), 'incorrect value for logLossValBase')\nTest.assertTrue(np.allclose(logLossValLR0, 0.456957), 'incorrect value for logLossValLR0')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.472336126395E12,"submitTime":1.47233612788E12,"finishTime":1.472336126435E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fa60b7f9-def0-45d5-841d-b28425e98fa5"},{"version":"CommandV1","origId":48516603025550,"guid":"c1876ac7-f0af-4840-b250-58c4eb4d886b","subtype":"command","commandType":"auto","position":77.0,"command":"%md\n**Visualization 2: ROC curve **\n \nWe will now visualize how well the model predicts our target.  To do this we generate a plot of the ROC curve.  The ROC curve shows us the trade-off between the false positive rate and true positive rate, as we liberalize the threshold required to predict a positive outcome.  A random model is represented by the dashed line.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443684E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a655e1be-7a08-4843-94af-ed94aff38829"},{"version":"CommandV1","origId":48516603025551,"guid":"f646d5b5-6b02-4525-b787-7929aa36cedd","subtype":"command","commandType":"auto","position":78.0,"command":"labelsAndScores = OHEValidationData.map(lambda lp:\n                                            (lp.label, getP(lp.features, model0.weights, model0.intercept)))\nlabelsAndWeights = labelsAndScores.collect()\nlabelsAndWeights.sort(key=lambda (k, v): v, reverse=True)\nlabelsByWeight = np.array([k for (k, v) in labelsAndWeights])\n\nlength = labelsByWeight.size\ntruePositives = labelsByWeight.cumsum()\nnumPositive = truePositives[-1]\nfalsePositives = np.arange(1.0, length + 1, 1.) - truePositives\n\ntruePositiveRate = truePositives / numPositive\nfalsePositiveRate = falsePositives / (length - numPositive)\n\n# Generate layout and plot data\nfig, ax = preparePlot(np.arange(0., 1.1, 0.1), np.arange(0., 1.1, 0.1))\nax.set_xlim(-.05, 1.05), ax.set_ylim(-.05, 1.05)\nax.set_ylabel('True Positive Rate (Sensitivity)')\nax.set_xlabel('False Positive Rate (1 - Specificity)')\nplt.plot(falsePositiveRate, truePositiveRate, color='#8cbfd0', linestyle='-', linewidth=3.)\nplt.plot((0., 1.), (0., 1.), linestyle='--', color='#d6ebf2', linewidth=2.)  # Baseline model\ndisplay(fig) \npass","commandVersion":1,"state":"finished","results":{"type":"image","data":"data:image/png;base64,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","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.472336133356E12,"submitTime":1.472336134839E12,"finishTime":1.472336134573E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8511d86f-6067-4c7c-9474-023c554533df"},{"version":"CommandV1","origId":48516603025552,"guid":"86f2e137-5538-454b-93c8-e5175bfcce02","subtype":"command","commandType":"auto","position":79.0,"command":"%md\n#### **Part 5: Reduce feature dimension via feature hashing**","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443709E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"76b5e191-5e47-4332-bde8-5d1308f97268"},{"version":"CommandV1","origId":48516603025553,"guid":"6f2b9238-835d-42b1-868d-b1561b07d810","subtype":"command","commandType":"auto","position":80.0,"command":"%md\n** (5a) Hash function **\n \nAs we just saw, using a one-hot-encoding featurization can yield a model with good statistical accuracy.  However, the number of distinct categories across all features is quite large -- recall that we observed 233K categories in the training data in Part (3c).  Moreover, the full Kaggle training dataset includes more than 33M distinct categories, and the Kaggle dataset itself is just a small subset of Criteo's labeled data.  Hence, featurizing via a one-hot-encoding representation would lead to a very large feature vector. To reduce the dimensionality of the feature space, we will use feature hashing.\n \nBelow is the hash function that we will use for this part of the lab.  We will first use this hash function with the three sample data points from Part (1a) to gain some intuition.  Specifically, run code to hash the three sample points using two different values for `numBuckets` and observe the resulting hashed feature dictionaries.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443721E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8a8825d3-1cc8-4645-b5e0-a2190fce4171"},{"version":"CommandV1","origId":48516603025554,"guid":"fdc7cfa3-8dcb-448b-8c75-d86f3c5ce990","subtype":"command","commandType":"auto","position":81.0,"command":"from collections import defaultdict\nimport hashlib\n\ndef hashFunction(numBuckets, rawFeats, printMapping=False):\n    \"\"\"Calculate a feature dictionary for an observation's features based on hashing.\n\n    Note:\n        Use printMapping=True for debug purposes and to better understand how the hashing works.\n\n    Args:\n        numBuckets (int): Number of buckets to use as features.\n        rawFeats (list of (int, str)): A list of features for an observation.  Represented as\n            (featureID, value) tuples.\n        printMapping (bool, optional): If true, the mappings of featureString to index will be\n            printed.\n\n    Returns:\n        dict of int to float:  The keys will be integers which represent the buckets that the\n            features have been hashed to.  The value for a given key will contain the count of the\n            (featureID, value) tuples that have hashed to that key.\n    \"\"\"\n    mapping = {}\n    for ind, category in rawFeats:\n        featureString = category + str(ind)\n        mapping[featureString] = int(int(hashlib.md5(featureString).hexdigest(), 16) % numBuckets)\n    if(printMapping): print mapping\n    sparseFeatures = defaultdict(float)\n    for bucket in mapping.values():\n        sparseFeatures[bucket] += 1.0\n    return dict(sparseFeatures)\n\n# Reminder of the sample values:\n# sampleOne = [(0, 'mouse'), (1, 'black')]\n# sampleTwo = [(0, 'cat'), (1, 'tabby'), (2, 'mouse')]\n# sampleThree =  [(0, 'bear'), (1, 'black'), (2, 'salmon')]","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.472336141309E12,"submitTime":1.472336142793E12,"finishTime":1.472336141354E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"720c95cc-4a05-464a-8dfe-e0ab23bf6a7b"},{"version":"CommandV1","origId":48516603025555,"guid":"5874f28a-75d6-4e1d-9ddc-680aea4c92f6","subtype":"command","commandType":"auto","position":82.0,"command":"# TODO: Replace <FILL IN> with appropriate code\n# Use four buckets\nsampOneFourBuckets = hashFunction(4, sampleOne, True)\nsampTwoFourBuckets = hashFunction(4, sampleTwo, True)\nsampThreeFourBuckets = hashFunction(4, sampleThree, True)\n\n# Use one hundred buckets\nsampOneHundredBuckets = hashFunction(100, sampleOne, True)\nsampTwoHundredBuckets = hashFunction(100, sampleTwo, True)\nsampThreeHundredBuckets = hashFunction(100, sampleThree, True)\n\nprint '\\t\\t 4 Buckets \\t\\t\\t 100 Buckets'\nprint 'SampleOne:\\t {0}\\t\\t {1}'.format(sampOneFourBuckets, sampOneHundredBuckets)\nprint 'SampleTwo:\\t {0}\\t\\t {1}'.format(sampTwoFourBuckets, sampTwoHundredBuckets)\nprint 'SampleThree:\\t {0}\\t {1}'.format(sampThreeFourBuckets, sampThreeHundredBuckets)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">{&apos;black1&apos;: 2, &apos;mouse0&apos;: 3}\n{&apos;cat0&apos;: 0, &apos;tabby1&apos;: 0, &apos;mouse2&apos;: 2}\n{&apos;bear0&apos;: 0, &apos;black1&apos;: 2, &apos;salmon2&apos;: 1}\n{&apos;black1&apos;: 14, &apos;mouse0&apos;: 31}\n{&apos;cat0&apos;: 40, &apos;tabby1&apos;: 16, &apos;mouse2&apos;: 62}\n{&apos;bear0&apos;: 72, &apos;black1&apos;: 14, &apos;salmon2&apos;: 5}\n\t\t 4 Buckets \t\t\t 100 Buckets\nSampleOne:\t {2: 1.0, 3: 1.0}\t\t {14: 1.0, 31: 1.0}\nSampleTwo:\t {0: 2.0, 2: 1.0}\t\t {40: 1.0, 16: 1.0, 62: 1.0}\nSampleThree:\t {0: 1.0, 1: 1.0, 2: 1.0}\t {72: 1.0, 5: 1.0, 14: 1.0}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.472336212116E12,"submitTime":1.472336213612E12,"finishTime":1.472336212192E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"543a0bde-00c8-4cc5-8608-1e0cb704b1a8"},{"version":"CommandV1","origId":48516603025556,"guid":"f56116e0-ac5d-45af-9e06-e5f7e6393d99","subtype":"command","commandType":"auto","position":83.0,"command":"# TEST Hash function (5a)\nTest.assertEquals(sampOneFourBuckets, {2: 1.0, 3: 1.0}, 'incorrect value for sampOneFourBuckets')\nTest.assertEquals(sampThreeHundredBuckets, {72: 1.0, 5: 1.0, 14: 1.0},\n                  'incorrect value for sampThreeHundredBuckets')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.472336213602E12,"submitTime":1.472336215087E12,"finishTime":1.472336213677E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"df78a378-8f4d-4722-9ace-43f99a798fb2"},{"version":"CommandV1","origId":48516603025557,"guid":"0b0139f9-f11f-4a6d-8239-71ccef29a66c","subtype":"command","commandType":"auto","position":84.0,"command":"%md\n** (5b) Creating hashed features **\n \nNext we will use this hash function to create hashed features for our CTR datasets. First write a function that uses the hash function from Part (5a) with numBuckets = \\\\( \\scriptsize 2^{15} \\approx 33K \\\\) to create a `LabeledPoint` with hashed features stored as a `SparseVector`.  Then use this function to create new training, validation and test datasets with hashed features. Hint: `parsedHashPoint` is similar to `parseOHEPoint` from Part (3d).","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443765E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"83ae96d6-4f03-4ced-a6bc-0d9e62c0c2c5"},{"version":"CommandV1","origId":48516603025558,"guid":"9e091bc6-7146-4df2-a06f-2c84f82cbb91","subtype":"command","commandType":"auto","position":85.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef parseHashPoint(point, numBuckets):\n    \"\"\"Create a LabeledPoint for this observation using hashing.\n\n    Args:\n        point (str): A comma separated string where the first value is the label and the rest are\n            features.\n        numBuckets: The number of buckets to hash to.\n\n    Returns:\n        LabeledPoint: A LabeledPoint with a label (0.0 or 1.0) and a SparseVector of hashed\n            features.\n    \"\"\"\n    label = point.split(',')[0]\n    features = SparseVector(numBuckets, hashFunction(numBuckets, parsePoint(point), True))\n    return LabeledPoint(label, features)\n\nnumBucketsCTR = 2 ** 15\nhashTrainData = rawTrainData.map(lambda x: parseHashPoint(x , numBucketsCTR))\nhashTrainData.cache()\nhashValidationData = rawValidationData.map(lambda x: parseHashPoint(x , numBucketsCTR))\nhashValidationData.cache()\nhashTestData =  rawTestData.map(lambda x: parseHashPoint(x , numBucketsCTR))\nhashTestData.cache()\n\nprint hashTrainData.take(1)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[LabeledPoint(0.0, (32768,[1305,2883,3807,4814,4866,4913,6952,7117,9985,10316,11512,11722,12365,13893,14735,15816,16198,17761,19274,21604,22256,22563,22785,24855,25202,25533,25721,26487,26656,27668,28211,29152,29402,29873,30039,31484,32493,32708],[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]))]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 211.0 failed 1 times, most recent failure: Lost task 0.0 in stage 211.0 (TID 670, localhost): org.apache.spark.api.python.PythonException: Traceback (most recent call last):","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-60-ba9b9764dba4&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     24</span> hashTestData<span class=\"ansiyellow\">.</span>cache<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     25</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 26</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">print</span> hashTrainData<span class=\"ansiyellow\">.</span>take<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/rdd.pyc</span> in <span class=\"ansicyan\">take</span><span class=\"ansiblue\">(self, num)</span>\n<span class=\"ansigreen\">   1295</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1296</span>             p <span class=\"ansiyellow\">=</span> range<span class=\"ansiyellow\">(</span>partsScanned<span class=\"ansiyellow\">,</span> min<span class=\"ansiyellow\">(</span>partsScanned <span class=\"ansiyellow\">+</span> numPartsToTry<span class=\"ansiyellow\">,</span> totalParts<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1297</span><span class=\"ansiyellow\">             </span>res <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>context<span class=\"ansiyellow\">.</span>runJob<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> takeUpToNumLeft<span class=\"ansiyellow\">,</span> p<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1298</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1299</span>             items <span class=\"ansiyellow\">+=</span> res<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/context.pyc</span> in <span class=\"ansicyan\">runJob</span><span class=\"ansiblue\">(self, rdd, partitionFunc, partitions, allowLocal)</span>\n<span class=\"ansigreen\">    937</span>         <span class=\"ansired\"># SparkContext#runJob.</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    938</span>         mappedRDD <span class=\"ansiyellow\">=</span> rdd<span class=\"ansiyellow\">.</span>mapPartitions<span class=\"ansiyellow\">(</span>partitionFunc<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 939</span><span class=\"ansiyellow\">         </span>port <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>PythonRDD<span class=\"ansiyellow\">.</span>runJob<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jsc<span class=\"ansiyellow\">.</span>sc<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> mappedRDD<span class=\"ansiyellow\">.</span>_jrdd<span class=\"ansiyellow\">,</span> partitions<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    940</span>         <span class=\"ansigreen\">return</span> list<span class=\"ansiyellow\">(</span>_load_from_socket<span class=\"ansiyellow\">(</span>port<span class=\"ansiyellow\">,</span> mappedRDD<span class=\"ansiyellow\">.</span>_jrdd_deserializer<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    941</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    811</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    812</span>         return_value = get_return_value(\n<span class=\"ansigreen\">--&gt; 813</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">    814</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    815</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     43</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     44</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 45</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     46</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     47</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.9-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    306</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    307</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 308</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    309</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    310</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 211.0 failed 1 times, most recent failure: Lost task 0.0 in stage 211.0 (TID 670, localhost): org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 111, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 106, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/serializers.py&quot;, line 263, in dump_stream\n    vs = list(itertools.islice(iterator, batch))\n  File &quot;&lt;ipython-input-60-ba9b9764dba4&gt;&quot;, line 19, in &lt;lambda&gt;\n  File &quot;&lt;ipython-input-60-ba9b9764dba4&gt;&quot;, line 15, in parseHashPoint\nNameError: global name &apos;hasFunction&apos; is not defined\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:166)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:207)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:125)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:70)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:306)\n\tat org.apache.spark.CacheManager.getOrCompute(CacheManager.scala:69)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:268)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:70)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:306)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:270)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:72)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:96)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:222)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1431)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1419)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1418)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1418)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:799)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:799)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:799)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1640)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1599)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1588)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:620)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1837)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1850)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1863)\n\tat org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:393)\n\tat org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)\n\tat sun.reflect.GeneratedMethodAccessor86.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:497)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:231)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:381)\n\tat py4j.Gateway.invoke(Gateway.java:259)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:133)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:209)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 111, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 106, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/serializers.py&quot;, line 263, in dump_stream\n    vs = list(itertools.islice(iterator, batch))\n  File &quot;&lt;ipython-input-60-ba9b9764dba4&gt;&quot;, line 19, in &lt;lambda&gt;\n  File &quot;&lt;ipython-input-60-ba9b9764dba4&gt;&quot;, line 15, in parseHashPoint\nNameError: global name &apos;hasFunction&apos; is not defined\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:166)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:207)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:125)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:70)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:306)\n\tat org.apache.spark.CacheManager.getOrCompute(CacheManager.scala:69)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:268)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:70)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:306)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:270)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:72)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:96)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:222)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n\n</div>","workflows":[],"startTime":1.472336401787E12,"submitTime":1.472336403285E12,"finishTime":1.472336417149E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"93be6f0f-553f-4729-b51e-dd0a3d81fb45"},{"version":"CommandV1","origId":48516603025559,"guid":"d63243de-c4c0-4753-9cef-f2d15edf6fba","subtype":"command","commandType":"auto","position":86.0,"command":"# TEST Creating hashed features (5b)\nhashTrainDataFeatureSum = sum(hashTrainData\n                           .map(lambda lp: len(lp.features.indices))\n                           .take(20))\nhashTrainDataLabelSum = sum(hashTrainData\n                         .map(lambda lp: lp.label)\n                         .take(100))\nhashValidationDataFeatureSum = sum(hashValidationData\n                                .map(lambda lp: len(lp.features.indices))\n                                .take(20))\nhashValidationDataLabelSum = sum(hashValidationData\n                              .map(lambda lp: lp.label)\n                              .take(100))\nhashTestDataFeatureSum = sum(hashTestData\n                          .map(lambda lp: len(lp.features.indices))\n                          .take(20))\nhashTestDataLabelSum = sum(hashTestData\n                        .map(lambda lp: lp.label)\n                        .take(100))\n\nTest.assertEquals(hashTrainDataFeatureSum, 772, 'incorrect number of features in hashTrainData')\nTest.assertEquals(hashTrainDataLabelSum, 24.0, 'incorrect labels in hashTrainData')\nTest.assertEquals(hashValidationDataFeatureSum, 776,\n                  'incorrect number of features in hashValidationData')\nTest.assertEquals(hashValidationDataLabelSum, 16.0, 'incorrect labels in hashValidationData')\nTest.assertEquals(hashTestDataFeatureSum, 774, 'incorrect number of features in hashTestData')\nTest.assertEquals(hashTestDataLabelSum, 23.0, 'incorrect labels in hashTestData')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.472336449804E12,"submitTime":1.472336451302E12,"finishTime":1.472336453726E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8fabfb57-a681-4c41-a0fb-6b5085026615"},{"version":"CommandV1","origId":48516603025560,"guid":"26b63a9f-809e-4097-8b5d-4fb3514b2b30","subtype":"command","commandType":"auto","position":87.0,"command":"%md\n** (5c) Sparsity **\n \nSince we have 33K hashed features versus 233K OHE features, we should expect OHE features to be sparser. Verify this hypothesis by computing the average sparsity of the OHE and the hashed training datasets.\n \nNote that if you have a `SparseVector` named `sparse`, calling `len(sparse)` returns the total number of features, not the number features with entries.  `SparseVector` objects have the attributes `indices` and `values` that contain information about which features are nonzero.  Continuing with our example, these can be accessed using `sparse.indices` and `sparse.values`, respectively.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.472335443795E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fae1ce99-99bc-45ba-91ce-1778af109945"},{"version":"CommandV1","origId":48516603025561,"guid":"157fdd72-2063-4c16-ae77-1b53690cb3cf","subtype":"command","commandType":"auto","position":88.0,"command":"# TODO: Replace <FILL IN> with appropriate code\ndef computeSparsity(data, d, n):\n    \"\"\"Calculates the average sparsity for the features in an RDD of LabeledPoints.\n\n    Args:\n        data (RDD of LabeledPoint): The LabeledPoints to use in the sparsity calculation.\n        d (int): The total number of features.\n        n (int): The number of observations in the RDD.\n\n    Returns:\n        float: The average of the ratio of features in a point to total features.\n    \"\"\"\n    return data.map(lambda x: len(x.features.indices)/float(d)).reduce(lambda a, b: a+b)/float(n)\n\naverageSparsityHash = computeSparsity(hashTrainData, numBucketsCTR, nTrain)\naverageSparsityOHE = computeSparsity(OHETrainData, numCtrOHEFeats, nTrain)\n\nprint 'Average OHE Sparsity: {0:.7e}'.format(averageSparsityOHE)\nprint 'Average Hash Sparsity: {0:.7e}'.format(averageSparsityHash)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Average OHE Sparsity: 1.6717677e-04\nAverage Hash Sparsity: 1.1805561e-03\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.472336800871E12,"submitTime":1.472336802377E12,"finishTime":1.472336818542E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5e09bdeb-8ded-49f6-92bb-f9da02742455"},{"version":"CommandV1","origId":48516603025562,"guid":"9f522fb7-d42e-4845-bfce-39502273d6e5","subtype":"command","commandType":"auto","position":89.0,"command":"# TEST Sparsity (5c)\nTest.assertTrue(np.allclose(averageSparsityOHE, 1.6717677e-04),\n                'incorrect value for averageSparsityOHE')\nTest.assertTrue(np.allclose(averageSparsityHash, 1.1805561e-03),\n                'incorrect value for averageSparsityHash')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1 test passed.\n1 test passed.\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1.472336823222E12,"submitTime":1.472336824716E12,"finishTime":1.472336823293E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"76d34b8c-5b03-47e2-838d-8e9e0a66c0de"}],"dashboards":[],"guid":"e7ed9322-94c1-4de0-8875-f30c2d7b5f22","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
